<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Vente Tickets </title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.20/jspdf.plugin.autotable.min.js"></script>

    <style>
        /* ... (Styles CSS - Pas de modifications ici) ... */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: linear-gradient(135deg,  #424242, #073018, #553a01);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: #fff;
            overflow-x: hidden;
            font-size: 16px;
            line-height: 1.5;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 16px;
        }

        section {
            margin: 16px 0;
            padding: 16px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        section:hover{
            transform: translateY(-5px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: #fdbb2d;
            margin-bottom: 16px;
            font-size: 1.5rem;
            font-weight: 600;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            color: white;
            margin-top: 16px;
            font-size: 0.9rem;
        }

        th, td {
            padding: 12px 8px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        td{
            transition: background-color 0.3s ease;
        }
        tr:hover td{
            background-color: rgba(255, 255, 255, 0.1);
        }

        button {
            background-color: #fdbb2d;
            color: #1a2a6c;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 0.9rem;
            white-space: nowrap;
            touch-action: manipulation;
        }

        button:active {
            transform: scale(0.95);
        }

        .notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: none;
            color: #1a2a6c;
            width: 90%;
            max-width: 400px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .notification h3 {
            margin-bottom: 16px;
            color: #1a2a6c;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .ticket-details {
            margin: 16px 0;
            font-size: 0.95rem;
        }

        .ticket-details p {
            margin: 8px 0;
            word-break: break-word;
        }

        .action-icons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
        }

        .action-icon {
            cursor: pointer;
            padding: 12px;
            border-radius: 50%;
            background-color: rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
        }

        .action-icon:active {
            transform: scale(0.9);
        }

        .icon-share { color: #4CAF50; }
        .icon-copy { color: #2196F3; }
        .icon-pdf { color: #f44336; }

        .buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn-sell {
            background-color: #4CAF50;
            color: white;
            flex: 1;
            min-width: 120px;
        }

        .btn-cancel {
            background-color: #f44336;
            color: white;
            flex: 1;
            min-width: 120px;
        }

        .close-icon {
            position: absolute;
            top: 12px;
            right: 12px;
            cursor: pointer;
            font-size: 24px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: rgba(0, 0, 0, 0.05);
        }

        .tooltip {
            position: fixed;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.85rem;
            display: none;
            z-index: 1001;
            text-align: center;
            max-width: 200px;
            left: 50% !important;
            transform: translateX(-50%);
            bottom: 24px;
        }
        .history-section {
            display: none;
            background: rgba(26, 42, 108, 0.95); /* Fond plus opaque avec une teinte bleue foncée */
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            z-index: 1000;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .history-section:hover{
            transform: translate(-50%, -50%) translateY(-5px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Amélioration du style de l'en-tête de l'historique pour plus de lisibilité */
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            position: sticky;
            top: 0;
            background: inherit;
            padding: 10px 0;
            z-index: 1;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Amélioration de la lisibilité des cartes de statistiques */
        .stat-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            padding: 16px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .stat-card:hover{
            transform: translateY(-5px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .stat-card h4 {
            color: #fdbb2d;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .stat-card .value {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .toggle-history {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #fdbb2d;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 100;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .toggle-history i{
            transition: transform 0.3s ease;
        }
        .toggle-history:hover{
            transform: scale(1.1);
        }
        .toggle-history:hover i{
            transform: rotate(180deg);
        }

        .toggle-history:active {
            transform: scale(0.95);
        }
        .export-buttons {
            margin-top: 20px;
            text-align: center;
        }

        .export-buttons button {
            margin: 0 10px;
        }

        .date-filter {
            display: flex;
            gap: 10px;
            margin-bottom: 16px;
            align-items: center;
        }

        .date-filter input[type="date"] {
            padding: 8px;
            border-radius: 4px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
        }
        .date-filter button{
            padding: 8px;
            border-radius: 4px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
        }
        .date-filter select {
            padding: 8px;
            border-radius: 4px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
        }

        footer {
            margin-top: auto;
            text-align: center;
            padding: 16px;
            background-color: rgba(0, 0, 0, 0.5);
            font-size: 0.9rem;
        }

        /* Media Queries */
        @media (max-width: 480px) {
            body {
                font-size: 14px;
            }

            .container {
                padding: 12px;
            }

            section {
                padding: 12px;
                margin: 12px 0;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: 8px 6px;
            }

            td:last-child {
                text-align: right;
            }

            button {
                padding: 10px 16px;
                font-size: 0.85rem;
            }

            .notification {
                padding: 20px 16px;
                width: 95%;
            }

            .action-icons {
                gap: 16px;
            }

            .action-icon {
                width: 40px;
                height: 40px;
                padding: 10px;
            }

            .buttons button {
                flex: 1;
                min-width: 0;
            }

            .close-icon {
                top: 8px;
                right: 8px;
            }

            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }

            .history-table {
                font-size: 0.8rem;
            }

            .date-filter {
                flex-direction: column;
            }
        }

        @media (max-width: 320px) {
            .buttons {
                flex-direction: column;
            }

            .action-icons {
                gap: 12px;
            }

            .action-icon {
                width: 36px;
                height: 36px;
            }
        }

        .login-section {
            margin: 16px 0;
            padding: 16px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .login-section h2 {
            color: #fdbb2d;
            margin-bottom: 16px;
            font-size: 1.5rem;
            font-weight: 600;
            text-align: center;
        }

        .login-section input[type="text"],
        .login-section input[type="password"] {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .login-section button {
            background-color: #fdbb2d;
            color: #1a2a6c;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 0.9rem;
            width: 100%;
            margin-top: 10px;
        }

        .login-section button:active {
            transform: scale(0.95);
        }

        .error-message {
            margin-top: 10px;
            text-align: center;
        }
        .messages-section {
            margin: 16px 0;
            padding: 16px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            max-height: 300px; /* Hauteur maximale pour la section des messages */
            overflow-y: auto; /* Permettre le défilement vertical si le contenu dépasse la hauteur maximale */
        }

        .messages-section h2 {
            color: #fdbb2d;
            margin-bottom: 16px;
            font-size: 1.5rem;
            font-weight: 600;
            text-align: center;
        }

        .message {
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 8px;
            color: white;
            font-size: 0.9rem;
        }

        .message .timestamp {
            font-size: 0.7rem;
            color: #ccc;
            margin-top: 5px;
        }

        /* Styles pour l'autocomplétion */
        .autocomplete-container {
            position: relative;
        }

        .autocomplete-suggestions {
            position: absolute;
            border: 1px solid #ccc;
            list-style: none;
            padding: 0;
            margin: 0;
            z-index: 100;
            background-color: white;
            width: 100%; /* Assurez-vous que la liste a la même largeur que le champ de saisie */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* Ombre pour un effet visuel */
        }

        .autocomplete-suggestions li {
            padding: 5px;
            cursor: pointer;
            color: #000;
        }

        .autocomplete-suggestions li:hover {
            background-color: #fdbb2d;
            color: #1a2a6c;
        }
        .loader-wrapper {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1001;
        }

        .loader {
            position: absolute;
            top: 50%;
            left: 50%;
            border: 6px solid #f3f3f3;
            border-top: 6px solid #fdbb2d;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
            transform: translate(-50%, -50%);
        }

        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .page-loader-wrapper {
            display: flex;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1002;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .page-loader {
            border: 6px solid #f3f3f3;
            border-top: 6px solid #fdbb2d;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }

        .loader-message {
            color: white;
            margin-top: 16px;
            font-size: 1rem;
            text-align: center;
            max-width: 80%;
        }
        .subscription-required {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .subscription-required-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            max-width: 400px;
            width: 90%;
        }

        .subscription-required-content h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .subscription-required-content p {
            color: #666;
            margin-bottom: 30px;
        }

        .subscription-required-content button {
            background-color: #fdbb2d;
            color: #1a2a6c;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 0.9rem;
            margin: 0 10px;
        }

        .subscription-required-content button:hover {
            background-color: #e6a727;
        }

    </style>
</head>

<body>
    <div class="page-loader-wrapper" id="pageLoaderWrapper">
        <div class="page-loader"></div>
        <div class="loader-message" id="pageLoaderMessage">Initialisation...</div>
    </div>
    <div class="loader-wrapper" id="loaderWrapper">
        <div class="loader"></div>
    </div>
    <section class="login-section" id="loginSection">
        <h2>Connexion Partenaire</h2>
        <form id="loginForm">
            <div class="autocomplete-container">
                <input type="text" id="username" placeholder="Nom d'utilisateur" required>
                <ul class="autocomplete-suggestions" id="autocompleteSuggestions" style="display: none;"></ul>
            </div>
            <input type="password" id="password" placeholder="Mot de passe" required>
            <div style="display: flex; align-items: center; margin-bottom: 10px;">
                <input type="checkbox" id="rememberMe">
                <label for="rememberMe" style="color: white; margin-left: 5px;">Se souvenir de moi (24h)</label>
            </div>
            <button type="submit">Se connecter</button>
        </form>
        <div class="error-message" id="loginError" style="display: none; color: red;"></div>
    </section>

    <div class="container">
        <section class="rates-section" style="display: none;">
            <h2>Vente de tickets WiFi</h2>
            <div class="loading-message">Chargement des tickets...</div>
            <table style="display: none;"></table>
        </section>
    </div>

    <div class="notification" id="notification">
        <span class="close-icon" onclick="hideNotification()">×</span>
        <h3 id="notification-title">Confirmation de vente</h3>
        <div class="ticket-details" id="notification-message"></div>
        <div class="buttons" id="confirmation-buttons">
            <button class="btn-sell" onclick="window.proceedWithSale()">Confirmer</button>
            <button class="btn-cancel" onclick="hideNotification()">Annuler</button>
        </div>
        <div class="action-icons" id="ticket-actions" style="display: none;">
            <div class="action-icon icon-share" onclick="shareTicket()" title="Partager">
                <i class="fas fa-share-alt"></i>
            </div>
            <div class="action-icon icon-pdf" onclick="exportToPDF()" title="Exporter en PDF">
                <i class="far fa-file-alt"></i>
            </div>
        </div>
    </div>

    <div class="toggle-history" onclick="toggleHistory()">
        <i class="fas fa-history"></i>
    </div>

    <div class="history-section" id="historySection" style="display: none;">
        <div class="history-header">
            <h2>Historique des ventes</h2>
            <button onclick="closeHistory()">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="date-filter">
            <select id="periodFilter" onchange="filterHistory()">
                <option value="today">Aujourd'hui</option>
                <option value="week">Cette semaine</option>
                <option value="month">Ce mois</option>
                <option value="all">Tout l'historique</option>
            </select>
            <input type="date" id="startDate">
            <input type="date" id="endDate">
            <button onclick="filterHistoryByDateRange()">Filtrer par date</button>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <h4>Tickets vendus</h4>
                <div id="totalTickets" class="value">0</div>
            </div>
            <div class="stat-card">
                <h4>Chiffre d'affaires</h4>
                <div id="totalRevenue" class="value">0 FCFA</div>
            </div>
            <div class="stat-card">
                <h4>Ticket le plus vendu</h4>
                <div id="topCategory" class="value">-</div>
            </div>
            <div class="stat-card">
                <h4>Moyenne par jour</h4>
                <div id="avgDaily" class="value">0</div>
            </div>
        </div>
        <div class="export-buttons">
            <button onclick="printHistory()"><i class="fas fa-print"></i> Imprimer</button>
            <button onclick="exportToPDFHistory()"><i class="fas fa-file-download"></i> Exporter en PDF</button>
        </div>

        <div class="history-table">
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Catégorie</th>
                        <th>Utilisateur</th>
                        <th>Prix</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="historyTableBody">
                </tbody>
            </table>
        </div>
    </div>

    <section class="messages-section" id="messagesSection" style="display: none;">
        <h2>Messages Reçus</h2>
        <div id="messagesContainer">
            <!-- Les messages seront ajoutés ici -->
        </div>
    </section>

    <div id="tooltip" class="tooltip"></div>

    <footer>
        <div class="anitext">PROPULSE PAR EVISIONS</div>
    </footer>

    <div id="subscriptionRequiredModal" class="subscription-required" style="display: none;">
        <div class="subscription-required-content">
            <h2>Abonnement Requis</h2>
            <p>Un abonnement actif est nécessaire pour accéder à cette fonctionnalité.</p>
            <button onclick="redirectToSubscription()">S'abonner</button>
            <button onclick="hideSubscriptionRequiredModal()">Fermer</button>
        </div>
    </div>

    <script type="module">
const _0x4c11d7=_0x2e32;(function(_0x8b178c,_0x2e23cb){const _0x51f58b=_0x2e32,_0x537ef8=_0x8b178c();while(!![]){try{const _0x423342=-parseInt(_0x51f58b(0x193))/0x1+-parseInt(_0x51f58b(0x1a6))/0x2*(-parseInt(_0x51f58b(0x1cf))/0x3)+-parseInt(_0x51f58b(0x1c4))/0x4*(-parseInt(_0x51f58b(0x16c))/0x5)+-parseInt(_0x51f58b(0x104))/0x6*(parseInt(_0x51f58b(0x1a7))/0x7)+-parseInt(_0x51f58b(0x130))/0x8*(-parseInt(_0x51f58b(0x103))/0x9)+-parseInt(_0x51f58b(0x145))/0xa*(parseInt(_0x51f58b(0x118))/0xb)+-parseInt(_0x51f58b(0x184))/0xc*(-parseInt(_0x51f58b(0x161))/0xd);if(_0x423342===_0x2e23cb)break;else _0x537ef8['push'](_0x537ef8['shift']());}catch(_0x259bb5){_0x537ef8['push'](_0x537ef8['shift']());}}}(_0x402e,0x8d311));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';import{getDatabase,ref,get,set,push,remove,onChildAdded}from'https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js';const firebaseConfig={'apiKey':_0x4c11d7(0x1ce),'authDomain':_0x4c11d7(0x19d),'databaseURL':_0x4c11d7(0x171),'projectId':_0x4c11d7(0x1af),'storageBucket':'espoirplus-d68c2.firebasestorage.app','messagingSenderId':'671203292972','appId':_0x4c11d7(0x1d1),'measurementId':_0x4c11d7(0x18b)},app=initializeApp(firebaseConfig),db=getDatabase(app),adminRef=ref(db,'admin/subscription');let ticketToSell=null,localTickets={},currentReservedTicket=null,currentVendorId='',vendors={},availableUsernames=[];window[_0x4c11d7(0x105)]=window['jspdf'][_0x4c11d7(0x105)];async function fetchVendors(){const _0x2e2f0b=_0x4c11d7;try{const _0x5c3045=ref(db,'Vendors'),_0x15afb6=await get(_0x5c3045);_0x15afb6[_0x2e2f0b(0x17d)]()?(vendors=_0x15afb6[_0x2e2f0b(0x1be)](),availableUsernames=Object['keys'](vendors)):console[_0x2e2f0b(0x1bb)]('Aucun\x20vendeur\x20trouvé.');}catch(_0x1714f8){console['error']('Erreur\x20lors\x20de\x20la\x20récupération\x20des\x20vendeurs:',_0x1714f8);}}const usernameInput=document[_0x4c11d7(0x12e)]('username'),passwordInput=document[_0x4c11d7(0x12e)](_0x4c11d7(0x163)),suggestionsList=document['getElementById'](_0x4c11d7(0x155));usernameInput[_0x4c11d7(0x13f)](_0x4c11d7(0x132),()=>{const _0x1138c1=_0x4c11d7,_0xfcff8f=usernameInput[_0x1138c1(0x141)][_0x1138c1(0x14d)](),_0x24faef=availableUsernames[_0x1138c1(0x149)](_0x1f85af=>_0x1f85af[_0x1138c1(0x14d)]()[_0x1138c1(0x178)](_0xfcff8f));suggestionsList[_0x1138c1(0x1a8)]='';if(_0xfcff8f[_0x1138c1(0x112)]===0x0||_0x24faef[_0x1138c1(0x112)]===0x0){suggestionsList['style'][_0x1138c1(0x152)]=_0x1138c1(0x14b);return;}_0x24faef[_0x1138c1(0x177)](_0x177093=>{const _0x54a63a=_0x1138c1,_0x408cd8=document[_0x54a63a(0x174)]('li');_0x408cd8['textContent']=_0x177093,_0x408cd8[_0x54a63a(0x13f)](_0x54a63a(0x198),()=>{const _0x39d440=_0x54a63a;usernameInput['value']=_0x177093,suggestionsList[_0x39d440(0x1a8)]='',suggestionsList[_0x39d440(0x12a)][_0x39d440(0x152)]=_0x39d440(0x14b);}),suggestionsList[_0x54a63a(0x14f)](_0x408cd8);}),suggestionsList[_0x1138c1(0x12a)][_0x1138c1(0x152)]=_0x1138c1(0x1c7);}),document['addEventListener'](_0x4c11d7(0x198),_0x82a114=>{const _0x1b433e=_0x4c11d7;!usernameInput[_0x1b433e(0x151)](_0x82a114[_0x1b433e(0x140)])&&!suggestionsList[_0x1b433e(0x151)](_0x82a114[_0x1b433e(0x140)])&&(suggestionsList[_0x1b433e(0x12a)][_0x1b433e(0x152)]=_0x1b433e(0x14b));});const rememberMeCheckbox=document[_0x4c11d7(0x12e)](_0x4c11d7(0x133)),storedUsername=localStorage[_0x4c11d7(0x1c3)](_0x4c11d7(0x14a)),storedPassword=localStorage['getItem'](_0x4c11d7(0x163)),storedTimestamp=localStorage['getItem'](_0x4c11d7(0x134)),now=Date['now'](),twentyFourHours=0x18*0x3c*0x3c*0x3e8;storedUsername&&storedPassword&&storedTimestamp&&now-storedTimestamp<twentyFourHours&&(usernameInput[_0x4c11d7(0x141)]=storedUsername,passwordInput[_0x4c11d7(0x141)]=storedPassword,rememberMeCheckbox[_0x4c11d7(0x13a)]=!![]);const loginForm=document[_0x4c11d7(0x12e)](_0x4c11d7(0x14e)),loginError=document['getElementById'](_0x4c11d7(0x1d4)),ratesSection=document[_0x4c11d7(0x10a)](_0x4c11d7(0x166)),historySection=document[_0x4c11d7(0x12e)](_0x4c11d7(0x1ab)),loginSection=document['getElementById'](_0x4c11d7(0x11e)),messagesSection=document['getElementById'](_0x4c11d7(0x18a));loginForm[_0x4c11d7(0x13f)](_0x4c11d7(0x17b),async _0x48f1da=>{const _0x5580ce=_0x4c11d7;_0x48f1da[_0x5580ce(0x164)](),showLoader();const _0x289727=usernameInput[_0x5580ce(0x141)],_0x1f451d=passwordInput[_0x5580ce(0x141)];vendors[_0x289727]&&vendors[_0x289727]['password']===_0x1f451d?(loginError['style'][_0x5580ce(0x152)]='none',ratesSection[_0x5580ce(0x12a)]['display']='block',historySection['style']['display']='none',loginSection[_0x5580ce(0x12a)][_0x5580ce(0x152)]=_0x5580ce(0x14b),messagesSection['style'][_0x5580ce(0x152)]='block',currentVendorId=_0x289727,rememberMeCheckbox[_0x5580ce(0x13a)]?(localStorage['setItem'](_0x5580ce(0x14a),_0x289727),localStorage[_0x5580ce(0x15e)](_0x5580ce(0x163),_0x1f451d),localStorage[_0x5580ce(0x15e)](_0x5580ce(0x134),Date[_0x5580ce(0x138)]())):(localStorage['removeItem'](_0x5580ce(0x14a)),localStorage['removeItem']('password'),localStorage['removeItem'](_0x5580ce(0x134))),await syncTickets(),loadHistory(),listenForNewMessages(),hideLoader()):(loginError[_0x5580ce(0x12a)][_0x5580ce(0x152)]=_0x5580ce(0x1c7),loginError['textContent']=_0x5580ce(0x175),hideLoader());});async function syncTickets(){const _0x4b5493=_0x4c11d7;try{const _0x53b1c3=document[_0x4b5493(0x10a)](_0x4b5493(0x173)),_0x2c655b=document[_0x4b5493(0x10a)](_0x4b5493(0x12d));_0x53b1c3['style'][_0x4b5493(0x152)]=_0x4b5493(0x1c7),_0x2c655b[_0x4b5493(0x12a)]['display']=_0x4b5493(0x14b);const _0x5031ae=ref(db,'TicketsTotal'),_0x4acd2a=await get(_0x5031ae);_0x4acd2a['exists']()?(localTickets=_0x4acd2a['val'](),createTicketTable(),_0x53b1c3['style']['display']=_0x4b5493(0x14b),_0x2c655b[_0x4b5493(0x12a)][_0x4b5493(0x152)]='table'):_0x53b1c3[_0x4b5493(0x197)]=_0x4b5493(0x109);}catch(_0x249a7d){console[_0x4b5493(0x1a4)]('Erreur\x20de\x20synchronisation:',_0x249a7d),loadingMessage['textContent']='Erreur\x20de\x20synchronisation\x20des\x20tickets.';}}async function createTicketTable(){const _0x219e7a=_0x4c11d7,_0x174f21=document[_0x219e7a(0x10a)](_0x219e7a(0x12d));_0x174f21['innerHTML']=_0x219e7a(0x107);for(const [_0x380bb5,_0x1d1b5c]of Object[_0x219e7a(0x165)](localTickets)){const _0x59130c=_0x1d1b5c[_0x219e7a(0x144)]?_0x1d1b5c[_0x219e7a(0x144)][_0x219e7a(0x112)]:0x0;if(_0x59130c>0x0){const _0x38a1da=_0x1d1b5c[_0x219e7a(0x169)][0x0],_0x1db7d4=_0x174f21['insertRow']();_0x1db7d4[_0x219e7a(0x1a8)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x380bb5+_0x219e7a(0x1c8)+_0x38a1da+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x59130c+_0x219e7a(0x19b)+_0x380bb5+_0x219e7a(0x1d0);}}document['querySelector'](_0x219e7a(0x173))[_0x219e7a(0x12a)][_0x219e7a(0x152)]=_0x219e7a(0x14b),_0x174f21[_0x219e7a(0x12a)][_0x219e7a(0x152)]=_0x219e7a(0x17c);}window[_0x4c11d7(0x19a)]=async function(_0x915bb9){const _0x7fd9a3=_0x4c11d7;showLoader();try{const _0x4974a5=ref(db,_0x7fd9a3(0x194)+_0x915bb9),_0x16ac68=await get(_0x4974a5);if(_0x16ac68['exists']()){const _0xbcd0e3=_0x16ac68[_0x7fd9a3(0x1be)]();if(!_0xbcd0e3['utilisateur']||_0xbcd0e3['utilisateur']['length']===0x0)throw new Error(_0x7fd9a3(0x1b4));ticketToSell={'category':_0x915bb9,'user':_0xbcd0e3['utilisateur'][0x0],'password':_0xbcd0e3['motDePasse'][0x0],'price':_0xbcd0e3['prix'][0x0],'updatedData':{..._0xbcd0e3,'utilisateur':_0xbcd0e3[_0x7fd9a3(0x144)][_0x7fd9a3(0x1c5)](0x1),'motDePasse':_0xbcd0e3[_0x7fd9a3(0x1c2)][_0x7fd9a3(0x1c5)](0x1),'prix':_0xbcd0e3[_0x7fd9a3(0x169)]['slice'](0x1)}},showConfirmation(ticketToSell),hideLoader();}}catch(_0x2affb1){console[_0x7fd9a3(0x1a4)]('Erreur:',_0x2affb1),showNotification(_0x7fd9a3(0x111),'Impossible\x20de\x20récupérer\x20le\x20ticket'),hideLoader();}};function showConfirmation(_0x3cd6bd){const _0x26a650=_0x4c11d7,_0x27d74b=document[_0x26a650(0x12e)](_0x26a650(0x162)),_0x10b020=document['getElementById'](_0x26a650(0x1a2)),_0x27f01b=document[_0x26a650(0x12e)](_0x26a650(0x192)),_0x24ad3b=document[_0x26a650(0x12e)]('confirmation-buttons');document['getElementById'](_0x26a650(0x1c6))['textContent']=_0x26a650(0x1cd),_0x10b020['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Voulez-vous\x20vendre\x20ce\x20ticket\x20?</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Catégorie:</strong>\x20'+_0x3cd6bd[_0x26a650(0x10b)]+_0x26a650(0x117)+_0x3cd6bd[_0x26a650(0x17f)]+_0x26a650(0x190),_0x24ad3b[_0x26a650(0x12a)][_0x26a650(0x152)]=_0x26a650(0x148),_0x27f01b[_0x26a650(0x12a)][_0x26a650(0x152)]=_0x26a650(0x14b),_0x27d74b['style'][_0x26a650(0x152)]='block';}window['proceedWithSale']=async function(){const _0x4f2484=_0x4c11d7;showLoader();if(!ticketToSell){showNotification(_0x4f2484(0x111),_0x4f2484(0x143)),hideLoader();return;}try{const _0x21e254=ref(db,'TicketsTotal/'+ticketToSell['category']);await set(_0x21e254,ticketToSell['updatedData']);const _0x2e9122=ref(db,_0x4f2484(0x15a));await push(_0x2e9122,{'category':ticketToSell[_0x4f2484(0x10b)],'user':ticketToSell[_0x4f2484(0x16a)],'password':ticketToSell['password'],'price':ticketToSell['price'],'soldAt':Date[_0x4f2484(0x138)](),'vendorId':currentVendorId});const _0x18f51c=ref(db,_0x4f2484(0x114)+currentVendorId);await push(_0x18f51c,{'category':ticketToSell['category'],'user':ticketToSell[_0x4f2484(0x16a)],'password':ticketToSell[_0x4f2484(0x163)],'price':ticketToSell[_0x4f2484(0x17f)],'soldAt':Date[_0x4f2484(0x138)]()}),showTicketDetails(ticketToSell),await syncTickets(),hideLoader();}catch(_0x47fd92){console[_0x4f2484(0x1a4)](_0x4f2484(0x16b),_0x47fd92),showNotification(_0x4f2484(0x111),'Impossible\x20de\x20finaliser\x20la\x20vente'),hideLoader();}ticketToSell=null;};function showTicketDetails(_0x4c1557){const _0x701026=_0x4c11d7,_0x32bc81=document[_0x701026(0x12e)](_0x701026(0x162)),_0xc20b17=document[_0x701026(0x12e)]('notification-message'),_0x5cbd98=document['getElementById'](_0x701026(0x192)),_0x190292=document[_0x701026(0x12e)](_0x701026(0x1b8));document[_0x701026(0x12e)](_0x701026(0x1c6))[_0x701026(0x197)]=_0x701026(0x1ac),_0xc20b17[_0x701026(0x1a8)]=_0x701026(0x106)+_0x4c1557['category']+_0x701026(0x15b)+_0x4c1557['user']+_0x701026(0x1b5)+_0x4c1557[_0x701026(0x163)]+_0x701026(0x117)+_0x4c1557['price']+'\x20FCFA</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x190292[_0x701026(0x12a)]['display']=_0x701026(0x14b),_0x5cbd98[_0x701026(0x12a)][_0x701026(0x152)]=_0x701026(0x148),_0x32bc81[_0x701026(0x12a)][_0x701026(0x152)]=_0x701026(0x1c7);}function _0x2e32(_0x2c893e,_0x1dbbab){const _0x402e9b=_0x402e();return _0x2e32=function(_0x2e32c3,_0x30c7d3){_0x2e32c3=_0x2e32c3-0x103;let _0x26f9db=_0x402e9b[_0x2e32c3];return _0x26f9db;},_0x2e32(_0x2c893e,_0x1dbbab);}function showSaleConfirmation(_0x2a92ae){const _0x532f35=_0x4c11d7,_0x20c4e3=document[_0x532f35(0x12e)](_0x532f35(0x162)),_0xf7ad3b=document[_0x532f35(0x12e)]('notification-message'),_0x490a76=document[_0x532f35(0x12e)](_0x532f35(0x167));_0xf7ad3b[_0x532f35(0x1a8)]=_0x532f35(0x106)+_0x2a92ae[_0x532f35(0x10b)]+_0x532f35(0x15b)+_0x2a92ae[_0x532f35(0x16a)]+_0x532f35(0x1b5)+_0x2a92ae[_0x532f35(0x163)]+_0x532f35(0x117)+_0x2a92ae[_0x532f35(0x17f)]+_0x532f35(0x190),_0x490a76['innerHTML']=_0x532f35(0x127),_0x20c4e3[_0x532f35(0x12a)][_0x532f35(0x152)]=_0x532f35(0x1c7);}window[_0x4c11d7(0x159)]=async function(){const _0x43e1a1=_0x4c11d7;showLoader();if(!currentReservedTicket){showNotification('Erreur',_0x43e1a1(0x19e)),hideLoader();return;}try{const _0x7da877=ref(db,_0x43e1a1(0x15a));await push(_0x7da877,{...currentReservedTicket,'soldAt':Date['now'](),'vendorId':currentVendorId});const _0x5eb898=ref(db,_0x43e1a1(0x114)+currentVendorId);await push(_0x5eb898,{...currentReservedTicket,'soldAt':Date[_0x43e1a1(0x138)]()}),showNotification(_0x43e1a1(0x1c0),_0x43e1a1(0x12c)),currentReservedTicket=null,hideNotification(),await syncTickets(),hideLoader();}catch(_0x412f83){console[_0x43e1a1(0x1a4)](_0x43e1a1(0x146),_0x412f83),showNotification(_0x43e1a1(0x111),_0x43e1a1(0x1b1)),hideLoader();}},window[_0x4c11d7(0x137)]=function(){currentReservedTicket=null,hideNotification();};function showNotification(_0x17a6fe,_0x1f9f66){const _0xcdc3c2=_0x4c11d7,_0x1c4ef4=document[_0xcdc3c2(0x12e)]('notification'),_0x532869=document[_0xcdc3c2(0x12e)](_0xcdc3c2(0x1c6)),_0x174ccd=document[_0xcdc3c2(0x12e)](_0xcdc3c2(0x1a2)),_0x3a7086=document[_0xcdc3c2(0x12e)](_0xcdc3c2(0x167)),_0x2b4f4d=document[_0xcdc3c2(0x12e)](_0xcdc3c2(0x192));_0x532869[_0xcdc3c2(0x197)]=_0x17a6fe,_0x174ccd[_0xcdc3c2(0x1a8)]=_0x1f9f66,_0x17a6fe===_0xcdc3c2(0x1c0)||_0x17a6fe===_0xcdc3c2(0x111)?(_0x3a7086['style'][_0xcdc3c2(0x152)]=_0xcdc3c2(0x14b),_0x2b4f4d[_0xcdc3c2(0x12a)]['display']=_0xcdc3c2(0x14b)):(_0x3a7086[_0xcdc3c2(0x12a)]['display']=_0xcdc3c2(0x148),_0x2b4f4d[_0xcdc3c2(0x12a)][_0xcdc3c2(0x152)]=_0xcdc3c2(0x14b)),_0x1c4ef4[_0xcdc3c2(0x12a)][_0xcdc3c2(0x152)]=_0xcdc3c2(0x1c7);}window['hideNotification']=function(){const _0x12114a=_0x4c11d7;document[_0x12114a(0x12e)]('notification')[_0x12114a(0x12a)]['display']=_0x12114a(0x14b);};async function loadHistory(){const _0x53a81a=_0x4c11d7;showLoader();try{const _0x345195=ref(db,_0x53a81a(0x114)+currentVendorId),_0x4f222f=await get(_0x345195);let _0xd06010=[];_0x4f222f[_0x53a81a(0x17d)]()&&(_0xd06010=Object['entries'](_0x4f222f[_0x53a81a(0x1be)]())[_0x53a81a(0x19f)](([_0xb5368c,_0x4843f0])=>({'id':_0xb5368c,..._0x4843f0}))),filterHistory(_0xd06010),hideLoader();}catch(_0x2665ab){console['error'](_0x53a81a(0x126),_0x2665ab),showNotification('Erreur',_0x53a81a(0x129)),hideLoader();}}function filterHistory(_0x3b7cdc){const _0x2c70db=_0x4c11d7,_0x22218c=document[_0x2c70db(0x12e)](_0x2c70db(0x11f))[_0x2c70db(0x141)],_0x31c5b3=new Date(),_0x18c98d={'today':new Date(_0x31c5b3[_0x2c70db(0x128)](0x0,0x0,0x0,0x0)),'week':new Date(_0x31c5b3[_0x2c70db(0x1b0)](_0x31c5b3['getDate']()-_0x31c5b3[_0x2c70db(0x1a1)]())),'month':new Date(_0x31c5b3[_0x2c70db(0x1b0)](0x1)),'all':new Date(0x0)};let _0x53977f=_0x3b7cdc;_0x22218c!==_0x2c70db(0x147)&&(_0x53977f=_0x3b7cdc['filter'](_0x563076=>new Date(_0x563076[_0x2c70db(0x15d)])>=_0x18c98d[_0x22218c])),updateStats(_0x53977f),updateHistoryTable(_0x53977f);}window['filterHistoryByDateRange']=function(){const _0x51f842=_0x4c11d7,_0x5d9a9d=new Date(document[_0x51f842(0x12e)]('startDate')[_0x51f842(0x141)]),_0xd6b64a=new Date(document[_0x51f842(0x12e)]('endDate')[_0x51f842(0x141)]);_0xd6b64a[_0x51f842(0x128)](0x17,0x3b,0x3b);if(isNaN(_0x5d9a9d[_0x51f842(0x1ca)]())||isNaN(_0xd6b64a['getTime']())){showNotification('Erreur','Veuillez\x20sélectionner\x20une\x20date\x20de\x20début\x20et\x20une\x20date\x20de\x20fin.');return;}const _0x1886c5=ref(db,_0x51f842(0x114)+currentVendorId);get(_0x1886c5)[_0x51f842(0x157)](_0x8db22c=>{const _0x94d995=_0x51f842;let _0x14a40f=[];_0x8db22c[_0x94d995(0x17d)]()&&(_0x14a40f=Object[_0x94d995(0x165)](_0x8db22c[_0x94d995(0x1be)]())[_0x94d995(0x19f)](([_0x51ade2,_0x13616e])=>({'id':_0x51ade2,..._0x13616e})));const _0x1aad94=_0x14a40f[_0x94d995(0x149)](_0x15536b=>{const _0x2e0141=new Date(_0x15536b['soldAt']);return _0x2e0141>=_0x5d9a9d&&_0x2e0141<=_0xd6b64a;});updateStats(_0x1aad94),updateHistoryTable(_0x1aad94);});};function updateStats(_0x4c46e7){const _0x2e7040=_0x4c11d7,_0x1d6632=_0x4c46e7[_0x2e7040(0x112)],_0x54fff7=_0x4c46e7[_0x2e7040(0x1ae)]((_0x42ec3e,_0x1c1f70)=>_0x42ec3e+parseFloat(_0x1c1f70[_0x2e7040(0x17f)]),0x0),_0x46f9bc=_0x4c46e7[_0x2e7040(0x1ae)]((_0x22354c,_0x51d58a)=>{const _0x579f36=_0x2e7040;return _0x22354c[_0x51d58a[_0x579f36(0x10b)]]=(_0x22354c[_0x51d58a[_0x579f36(0x10b)]]||0x0)+0x1,_0x22354c;},{}),_0x45982a=Object[_0x2e7040(0x165)](_0x46f9bc)[_0x2e7040(0x1bd)]((_0x3fb54a,_0x1eda79)=>_0x1eda79[0x1]-_0x3fb54a[0x1])[0x0]?.[0x0]||'-',_0x5b009c=_0x4c46e7['length']>0x0?Math[_0x2e7040(0x1b2)](0x1,Math[_0x2e7040(0x19c)]((Date[_0x2e7040(0x138)]()-Math[_0x2e7040(0x1d3)](..._0x4c46e7[_0x2e7040(0x19f)](_0x5e714b=>_0x5e714b[_0x2e7040(0x15d)])))/(0x3e8*0x3c*0x3c*0x18))):0x1,_0x24a73d=(_0x1d6632/_0x5b009c)[_0x2e7040(0x18c)](0x1);document[_0x2e7040(0x12e)](_0x2e7040(0x1a5))[_0x2e7040(0x197)]=_0x1d6632,document[_0x2e7040(0x12e)](_0x2e7040(0x16d))[_0x2e7040(0x197)]=_0x54fff7[_0x2e7040(0x10e)]()+_0x2e7040(0x176),document[_0x2e7040(0x12e)](_0x2e7040(0x120))[_0x2e7040(0x197)]=_0x45982a,document[_0x2e7040(0x12e)](_0x2e7040(0x135))[_0x2e7040(0x197)]=_0x24a73d;}function updateHistoryTable(_0x2f2688){const _0x553e6f=_0x4c11d7,_0x3c335e=document['getElementById'](_0x553e6f(0x188));_0x3c335e[_0x553e6f(0x1a8)]=_0x2f2688[_0x553e6f(0x1bd)]((_0x23f196,_0x523d73)=>_0x523d73[_0x553e6f(0x15d)]-_0x23f196[_0x553e6f(0x15d)])['map'](_0x427847=>_0x553e6f(0x1a9)+_0x427847['id']+_0x553e6f(0x1ad)+new Date(_0x427847['soldAt'])[_0x553e6f(0x10e)]()+_0x553e6f(0x1c8)+_0x427847[_0x553e6f(0x10b)]+_0x553e6f(0x1c8)+_0x427847[_0x553e6f(0x16a)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x427847[_0x553e6f(0x17f)]+'\x20FCFA</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><i\x20class=\x22fa-solid\x20fa-arrow-right\x22></i></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20')[_0x553e6f(0x1b3)]('');}window[_0x4c11d7(0x11d)]=async function(_0x1784c6){const _0x592d36=_0x4c11d7;showLoader();try{const _0x573871=ref(db,_0x592d36(0x114)+currentVendorId+'/'+_0x1784c6),_0x2e7cf5=await get(_0x573871);if(_0x2e7cf5['exists']()){const _0x359366=_0x2e7cf5[_0x592d36(0x1be)]();window['closeHistory'](),showTicketDetails(_0x359366),hideLoader();}else showNotification(_0x592d36(0x111),_0x592d36(0x124)),hideLoader();}catch(_0x4f7e38){console['error']('Erreur\x20lors\x20de\x20la\x20récupération\x20du\x20ticket:',_0x4f7e38),showNotification(_0x592d36(0x111),_0x592d36(0x153)),hideLoader();}},window['toggleHistory']=function(){const _0x57c7c8=_0x4c11d7,_0x17d9fb=document['getElementById'](_0x57c7c8(0x1ab)),_0x2050ba=_0x17d9fb[_0x57c7c8(0x12a)][_0x57c7c8(0x152)]===_0x57c7c8(0x1c7);_0x17d9fb['style'][_0x57c7c8(0x152)]=_0x2050ba?_0x57c7c8(0x14b):_0x57c7c8(0x1c7),!_0x2050ba&&loadHistory();},window[_0x4c11d7(0x1aa)]=function(){const _0x2cfa02=_0x4c11d7;document[_0x2cfa02(0x12e)](_0x2cfa02(0x1ab))[_0x2cfa02(0x12a)][_0x2cfa02(0x152)]='none';},window[_0x4c11d7(0x1a0)]=function(){loadHistory();};function _0x402e(){const _0x4ca0c5=['Abonnement\x20expiré','motDePasse','getItem','30388QeJuly','slice','notification-title','block','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','Impossible\x20de\x20copier\x20le\x20ticket','getTime','status','table_to_book','Confirmation\x20de\x20vente','AIzaSyCLehOgdz90jvaMrq7oZxx1sxY5WEZI7Oo','34665ltosYF','\x27)\x22>Vendre</button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','1:671203292972:web:42765e95e987ace1349e89','left','min','loginError','autoTable','1786653fhlpoM','11376jNeWMa','jsPDF','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Catégorie:</strong>\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Catégorie</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Prix\x20(FCFA)</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Restants</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Action</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','width','Aucun\x20ticket\x20disponible.','querySelector','category','Erreur\x20lors\x20de\x20la\x20vérification\x20de\x20l\x27abonnement\x20:','text','toLocaleString','Erreur\x20lors\x20du\x20partage:','utils','Erreur','length','href','VendorsHistory/','index.html','exportToPDF','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Prix:</strong>\x20','11ftKmWZ','endDate','copyTicket','Vendors/','Erreur\x20lors\x20de\x20l\x27initialisation\x20:','showTicketDetailsFromHistory','loginSection','periodFilter','topCategory','grid','exportToExcelHistory','message','Ticket\x20introuvable\x20dans\x20l\x27historique','catch','Erreur\x20lors\x20du\x20chargement\x20de\x20l\x27historique:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-sell\x22\x20onclick=\x22window.confirmSale()\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Confirmer\x20la\x20vente\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-cancel\x22\x20onclick=\x22window.cancelSale()\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Annuler\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','setHours','Impossible\x20de\x20charger\x20l\x27historique','style','height','Ticket\x20vendu\x20avec\x20succès!','.rates-section\x20table','getElementById','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','32ZkkKCc','printHistory','input','rememberMe','usernameTimestamp','avgDaily','internal','cancelSale','now','share','checked','/messages','Erreur\x20lors\x20de\x20la\x20vérification\x20de\x20l\x27abonnement.','margin','exportToPDFHistory','addEventListener','target','value','active','Aucun\x20ticket\x20à\x20vendre','utilisateur','9389690ZBzCFh','Erreur\x20de\x20confirmation:','all','flex','filter','username','none','bold','toLowerCase','loginForm','appendChild','loaderWrapper','contains','display','Impossible\x20de\x20récupérer\x20les\x20détails\x20du\x20ticket','DOMContentLoaded','autocompleteSuggestions','Page\x20','then','print','confirmSale','TicketsVendus','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Nom\x20d\x27utilisateur:</strong>\x20','timestamp','soldAt','setItem','Pas\x20d\x27abonnement\x20actif','shareTicket','13uRAkWm','notification','password','preventDefault','entries','.rates-section','notification-buttons','Historique\x20des\x20ventes','prix','user','Erreur\x20lors\x20de\x20la\x20vente:','550WtKeRk','totalRevenue','writeText','Le\x20partage\x20n\x27est\x20pas\x20supporté\x20sur\x20votre\x20navigateur.\x20Veuillez\x20copier\x20manuellement\x20les\x20détails\x20du\x20ticket.','settings','https://espoirplus-d68c2-default-rtdb.firebaseio.com','ticket.pdf','.loading-message','createElement','Nom\x20d\x27utilisateur\x20ou\x20mot\x20de\x20passe\x20incorrect.','\x20FCFA','forEach','startsWith','pageSize','setFontSize','submit','table','exists','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','price','hideSubscriptionRequiredModal','Ticket\x20copié\x20dans\x20le\x20presse-papiers!','right','Erreur\x20lors\x20de\x20la\x20copie:','8436252THpRit','jspdf','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22timestamp\x22>','Partage\x20réussi','historyTableBody','historique_ventes.pdf','messagesSection','G-BNCZW7CZ4F','toFixed','Ventes','image/png','expired','\x20FCFA</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','location','ticket-actions','696426uxyyLv','TicketsTotal/','Une\x20erreur\x20est\x20survenue\x20lors\x20de\x20l\x27initialisation.','Détails\x20du\x20Ticket','textContent','click','PNG','initTicketSale','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><button\x20onclick=\x22window.initTicketSale(\x27','ceil','espoirplus-d68c2.firebaseapp.com','Aucun\x20ticket\x20en\x20cours\x20de\x20vente','map','filterHistory','getDay','notification-message','Vérification\x20de\x20l\x27abonnement...','error','totalTickets','174VTotgM','4151TMCcfL','innerHTML','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20onclick=\x22window.showTicketDetailsFromHistory(\x27','closeHistory','historySection','Ticket\x20vendu\x20avec\x20succès','\x27)\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','reduce','espoirplus-d68c2','setDate','Erreur\x20lors\x20de\x20la\x20confirmation\x20de\x20la\x20vente','max','join','Plus\x20de\x20tickets\x20disponibles','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Mot\x20de\x20passe:</strong>\x20','pageLoaderWrapper','xlsx','confirmation-buttons','application/octet-stream','addImage','log','innerText','sort','val','write','Succès'];_0x402e=function(){return _0x4ca0c5;};return _0x402e();}function listenForNewMessages(){const _0x1aa982=_0x4c11d7,_0x55ee6b=ref(db,_0x1aa982(0x11b)+currentVendorId+_0x1aa982(0x13b));onChildAdded(_0x55ee6b,_0x195beb=>{const _0x4d97c3=_0x1aa982,_0x519388=_0x195beb[_0x4d97c3(0x1be)]();displayNewMessage(_0x519388);});}function displayNewMessage(_0x42478c){const _0x3ce0bd=_0x4c11d7,_0x6e70c3=document['getElementById']('messagesContainer'),_0x3a3615=document[_0x3ce0bd(0x174)]('div');_0x3a3615['classList']['add'](_0x3ce0bd(0x123)),_0x3a3615['innerHTML']=_0x3ce0bd(0x17e)+_0x42478c['content']+_0x3ce0bd(0x186)+new Date(_0x42478c[_0x3ce0bd(0x15c)])[_0x3ce0bd(0x10e)]()+_0x3ce0bd(0x12f),_0x6e70c3[_0x3ce0bd(0x14f)](_0x3a3615),_0x6e70c3['scrollTop']=_0x6e70c3['scrollHeight'];}window[_0x4c11d7(0x160)]=function(){const _0x381bac=_0x4c11d7,_0x4c123e=document[_0x381bac(0x12e)](_0x381bac(0x1a2))[_0x381bac(0x1bc)];navigator[_0x381bac(0x139)]?navigator[_0x381bac(0x139)]({'title':_0x381bac(0x196),'text':_0x4c123e})[_0x381bac(0x157)](()=>console['log'](_0x381bac(0x187)))[_0x381bac(0x125)](_0x5cccab=>console[_0x381bac(0x1a4)](_0x381bac(0x10f),_0x5cccab)):alert(_0x381bac(0x16f));},window[_0x4c11d7(0x11a)]=function(){const _0xeb3b61=_0x4c11d7,_0x430964=document['getElementById']('notification-message')['innerText'];navigator['clipboard'][_0xeb3b61(0x16e)](_0x430964)[_0xeb3b61(0x157)](()=>{const _0x2632c9=_0xeb3b61;showNotification('Succès',_0x2632c9(0x181));})[_0xeb3b61(0x125)](_0x2927e6=>{const _0x3c7496=_0xeb3b61;console[_0x3c7496(0x1a4)](_0x3c7496(0x183),_0x2927e6),showNotification(_0x3c7496(0x111),_0x3c7496(0x1c9));});},window[_0x4c11d7(0x116)]=async function(){const _0x4b8fdc=_0x4c11d7;showLoader();const _0x18f5ec=document[_0x4b8fdc(0x12e)](_0x4b8fdc(0x1a2)),_0xb20ca3=new jsPDF(),_0x2394a9=await html2canvas(_0x18f5ec),_0x404f7f=_0x2394a9['toDataURL'](_0x4b8fdc(0x18e));_0xb20ca3[_0x4b8fdc(0x1ba)](_0x404f7f,_0x4b8fdc(0x199),0xa,0xa,0xbe,0x0),_0xb20ca3['save'](_0x4b8fdc(0x172)),hideLoader();},window[_0x4c11d7(0x131)]=function(){const _0x5bc324=_0x4c11d7;window[_0x5bc324(0x158)]();},window[_0x4c11d7(0x13e)]=function(){const _0x1679d0=_0x4c11d7,{jsPDF:_0x1a1889}=window[_0x1679d0(0x185)],_0x4c592f=new _0x1a1889(),_0x1a7ba2=document[_0x1679d0(0x12e)](_0x1679d0(0x188)),_0x33dc5c={'fillColor':[0x2a,0x3a,0x6c],'textColor':[0xff,0xff,0xff],'fontStyle':_0x1679d0(0x14c),'halign':'center'},_0x14d5cf={'halign':_0x1679d0(0x1d2)},_0x1b1068={'theme':_0x1679d0(0x121),'headStyles':_0x33dc5c,'bodyStyles':_0x14d5cf,'margin':{'top':0x14},'startY':0x1e,'didDrawPage':function(_0x5ac082){const _0x50c1a=_0x1679d0;_0x4c592f[_0x50c1a(0x10d)](_0x50c1a(0x168),0xe,0xf);const _0x375cf2=_0x50c1a(0x156)+_0x4c592f[_0x50c1a(0x136)]['getNumberOfPages']();_0x4c592f[_0x50c1a(0x17a)](0xa);const _0x4e1e73=_0x4c592f[_0x50c1a(0x136)][_0x50c1a(0x179)],_0x371044=_0x4e1e73[_0x50c1a(0x12b)]?_0x4e1e73[_0x50c1a(0x12b)]:_0x4e1e73['getHeight']();_0x4c592f['text'](_0x375cf2,_0x5ac082[_0x50c1a(0x170)][_0x50c1a(0x13d)][_0x50c1a(0x1d2)],_0x371044-0xa),_0x4c592f[_0x50c1a(0x10d)](new Date()[_0x50c1a(0x10e)](),_0x4e1e73[_0x50c1a(0x108)]-_0x5ac082[_0x50c1a(0x170)][_0x50c1a(0x13d)][_0x50c1a(0x182)]-0x28,_0x371044-0xa);}};_0x4c592f[_0x1679d0(0x1d5)]({'html':'#historyTableBody',..._0x1b1068}),_0x4c592f['save'](_0x1679d0(0x189));},window[_0x4c11d7(0x122)]=function(){const _0x47dc48=_0x4c11d7,_0x19247d=XLSX[_0x47dc48(0x110)][_0x47dc48(0x1cc)](document['getElementById'](_0x47dc48(0x188)),{'sheet':_0x47dc48(0x18d)}),_0xd4ad26=XLSX[_0x47dc48(0x1bf)](_0x19247d,{'bookType':_0x47dc48(0x1b7),'type':'binary'});function _0x12bd64(_0x578115){const _0xe703af=_0x47dc48,_0x1bfc50=new ArrayBuffer(_0x578115[_0xe703af(0x112)]),_0x47a00c=new Uint8Array(_0x1bfc50);for(let _0x4f1e70=0x0;_0x4f1e70<_0x578115[_0xe703af(0x112)];_0x4f1e70++)_0x47a00c[_0x4f1e70]=_0x578115['charCodeAt'](_0x4f1e70)&0xff;return _0x1bfc50;}saveAs(new Blob([_0x12bd64(_0xd4ad26)],{'type':_0x47dc48(0x1b9)}),'historique_ventes.xlsx');};function showLoader(){const _0x25ae82=_0x4c11d7;document[_0x25ae82(0x12e)]('loaderWrapper')[_0x25ae82(0x12a)][_0x25ae82(0x152)]=_0x25ae82(0x1c7);}function hideLoader(){const _0x580a39=_0x4c11d7;document[_0x580a39(0x12e)](_0x580a39(0x150))[_0x580a39(0x12a)][_0x580a39(0x152)]=_0x580a39(0x14b);}function showPageLoader(){const _0x159d27=_0x4c11d7;document[_0x159d27(0x12e)](_0x159d27(0x1b6))[_0x159d27(0x12a)][_0x159d27(0x152)]=_0x159d27(0x148);}function hidePageLoader(){const _0x4714a0=_0x4c11d7;document['getElementById'](_0x4714a0(0x1b6))['style']['display']=_0x4714a0(0x14b);}function showSubscriptionRequiredModal(){const _0x4bec74=_0x4c11d7;subscriptionRequiredModal[_0x4bec74(0x12a)][_0x4bec74(0x152)]=_0x4bec74(0x148);}function hideSubscriptionRequiredModal(){const _0x51a10d=_0x4c11d7;subscriptionRequiredModal['style'][_0x51a10d(0x152)]=_0x51a10d(0x14b);}function redirectToSubscription(){const _0x59087a=_0x4c11d7;window[_0x59087a(0x191)][_0x59087a(0x113)]=_0x59087a(0x115);}async function checkSubscriptionStatus(){const _0x3d2e6f=_0x4c11d7,_0x3beae3=document[_0x3d2e6f(0x12e)]('pageLoaderMessage');_0x3beae3[_0x3d2e6f(0x197)]=_0x3d2e6f(0x1a3);try{const _0x3674b0=await get(adminRef),_0x50a4fa=_0x3674b0[_0x3d2e6f(0x1be)](),_0x3da954=new Date();if(_0x50a4fa&&_0x50a4fa[_0x3d2e6f(0x1cb)]===_0x3d2e6f(0x142)){const _0x5d8d8e=new Date(_0x50a4fa[_0x3d2e6f(0x119)]);_0x5d8d8e<_0x3da954?(_0x3beae3[_0x3d2e6f(0x197)]=_0x3d2e6f(0x1c1),showSubscriptionRequiredModal(),await adminRef['update']({'status':_0x3d2e6f(0x18f)})):_0x3beae3['textContent']='Abonnement\x20actif';}else _0x3beae3[_0x3d2e6f(0x197)]=_0x3d2e6f(0x15f),showSubscriptionRequiredModal();}catch(_0x3f59d6){console['error'](_0x3d2e6f(0x10c),_0x3f59d6),_0x3beae3[_0x3d2e6f(0x197)]='Erreur\x20lors\x20de\x20la\x20vérification\x20de\x20l\x27abonnement',showNotification(_0x3d2e6f(0x111),_0x3d2e6f(0x13c));}}document[_0x4c11d7(0x13f)](_0x4c11d7(0x154),()=>{const _0x46568a=_0x4c11d7;checkSubscriptionStatus()['then'](()=>{fetchVendors(),hidePageLoader();})[_0x46568a(0x125)](_0x2d26c1=>{const _0x3a0f66=_0x46568a;console['error'](_0x3a0f66(0x11c),_0x2d26c1),showNotification(_0x3a0f66(0x111),_0x3a0f66(0x195)),hidePageLoader();});}),window['redirectToSubscription']=redirectToSubscription,window[_0x4c11d7(0x180)]=redirectToSubscription;   </script>
</body>
</html>
