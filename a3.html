<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des tickets</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            /* ... (vos variables CSS) ... */
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --danger-color: #e74c3c;
            --background-color: #00637c;
            --text-color: #34495e;
            --edit-color: #f39c12;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: auto;
            background: rgb(0, 48, 16);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .category-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .category-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h1, h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            display: flex; /* Added to align items */
            justify-content: space-between; /* Added to space items apart */
            align-items: center; /* Added to vertically align items */
        }

        .logout-button {
            background-color: #e74c3c;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
        }

        .logout-button:hover {
            background-color: #c0392b;
        }


        .pin-icon {
            cursor: pointer;
            color: var(--primary-color);
            font-size: 1.2em;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 20px;
            background-color: rgb(244, 255, 143);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            text-transform: uppercase;
        }

        tr:last-child td {
            border-bottom: none;
        }

        button, .file-input-label {
            background-color: var(--primary-color);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
            display: inline-block;
            transition: background-color 0.3s ease;
            font-size: 14px;
        }

        button:hover, .file-input-label:hover {
            background-color: #2980b9;
        }

        .delete-btn {
            background-color: var(--danger-color);
        }

        .delete-btn:hover {
            background-color: #c0392b;
        }

        .edit-btn {
            background-color: var(--edit-color);
        }

        .edit-btn:hover {
            background-color: #d68910;
        }

        .add-ticket-btn {
            background-color: var(--secondary-color);
        }

        .add-ticket-btn:hover {
            background-color: #27ae60;
        }

        #searchBar {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        #searchBar:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .highlight {
            background-color: #fff176;
            padding: 2px;
            border-radius: 2px;
        }

        #importFile {
            display: none;
        }

        .action-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .loading::after {
            content: "";
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            position: relative;
            background-color: white;
            margin: 15% auto;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 500px;
        }

        .modal input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .action-row {
                flex-direction: column;
                align-items: stretch;
            }

            button, .file-input-label {
                width: 100%;
                margin-right: 0;
                margin-bottom: 10px;
            }
        }
        .logout-button {
        position: relative; /* Changed from fixed to relative */
        top: auto; /* Reset top */
        right: auto; /* Reset right */
        margin-left: 10px; /* Add some space from the title */
        z-index: auto;
        background-color: #e74c3c;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .logout-button:hover {
        background-color: #c0392b;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .logout-button:active {
        transform: translateY(0);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .logout-button i {
        font-size: 16px;
    }

    @media (max-width: 768px) {
        .logout-button {
            top: 10px;
            right: 10px;
            padding: 8px 16px;
            font-size: 12px;
        }
    }
      .database-selector {
        margin-bottom: 20px;
    }

    .database-selector select {
        padding: 10px;
        border: 1px solid #bdc3c7;
        border-radius: 4px;
        font-size: 16px;
        background-color: white;
        color: var(--text-color);
        cursor: pointer;
    }

    .database-selector select:focus {
        outline: none;
        border-color: var(--primary-color);
    }
    </style>
</head>
<body>
    <div id="loadingIndicator" class="loading" style="display: none;"></div>
    <div class="container" id="contentContainer" style="display:none;">
        <h1>Gestion des tickets <button onclick="logout()" class="logout-button">
            <i class="fas fa-sign-out-alt"></i> Déconnexion
        </button></h1>


        <div class="database-selector">
            <label for="databaseSelect">Choisir la base de données : </label>
            <select id="databaseSelect" onchange="changeDatabase()">
                <option value="TicketsTotal">TicketsTotal</option>
                <option value="TicketsTransit">TicketsTransit</option>
            </select>
        </div>

        <div class="action-row">
            <div>
                <button onclick="exportTickets()">Exporter tous les tickets</button>
                <label for="importFile" class="file-input-label">Importer des tickets</label>
                <input type="file" id="importFile" accept=".txt,.json" onchange="importTickets(event)">
            </div>
            <button onclick="exportFilteredTickets()">Exporter les tickets filtrés</button>
        </div>
        <input type="text" id="searchBar" placeholder="Rechercher un ticket (mot de passe, prix ou utilisateur)">
        <button onclick="deleteSearchResults()">Supprimer les résultats de recherche</button>
        <div id="ticketCategories"></div>
    </div>


    <!-- Modal pour les prix -->
    <div id="priceModal" class="modal">
        <div class="modal-content">
            <h2>Définir le prix</h2>
            <p>Veuillez entrer le prix pour la catégorie <span id="categoryName"></span></p>
            <input type="text" id="priceInput" placeholder="Entrer le prix">
            <div class="modal-buttons">
                <button onclick="confirmPrice()">Confirmer</button>
                <button onclick="cancelImport()">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal pour modifier un ticket -->
    <div id="editTicketModal" class="modal">
        <div class="modal-content">
            <h2>Modifier le ticket</h2>
            <input type="text" id="editId" placeholder="ID" disabled>
            <input type="text" id="editCategory" placeholder="Catégorie">
            <input type="text" id="editPassword" placeholder="Mot de passe">
            <input type="text" id="editPrice" placeholder="Prix">
            <input type="text" id="editUser" placeholder="Utilisateur">
            <div class="modal-buttons">
                <button onclick="saveTicketEdit()">Enregistrer</button>
                <button onclick="closeEditModal()">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal pour modifier une catégorie -->
    <div id="editCategoryModal" class="modal">
        <div class="modal-content">
            <h2>Modifier la catégorie</h2>
            <input type="text" id="editCategoryName" placeholder="Nouveau nom de la catégorie">
            <div class="modal-buttons">
                <button onclick="saveCategoryEdit()">Enregistrer</button>
                <button onclick="closeEditCategoryModal()">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal pour ajouter un ticket -->
    <div id="addTicketModal" class="modal">
        <div class="modal-content">
            <h2>Ajouter un nouveau ticket</h2>
            <input type="text" id="newCategory" placeholder="Catégorie">
            <input type="text" id="newPassword" placeholder="Mot de passe">
            <input type="text" id="newPrice" placeholder="Prix">
            <input type="text" id="newUser" placeholder="Utilisateur">
            <div class="modal-buttons">
                <button onclick="saveNewTicket()">Ajouter</button>
                <button onclick="closeAddTicketModal()">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal pour la modification groupée -->
    <div id="bulkEditModal" class="modal">
        <div class="modal-content">
            <h2>Modifier les tickets sélectionnés</h2>
            <input type="text" id="bulkEditCategory" placeholder="Catégorie (laisser vide si inchangé)">
            <input type="text" id="bulkEditPassword" placeholder="Mot de passe (laisser vide si inchangé)">
            <input type="text" id="bulkEditPrice" placeholder="Prix (laisser vide si inchangé)">
            <input type="text" id="bulkEditUser" placeholder="Utilisateur (laisser vide si inchangé)">
            <div class="modal-buttons">
                <button onclick="saveBulkEdit()">Enregistrer</button>
                <button onclick="closeBulkEditModal()">Annuler</button>
            </div>
        </div>
    </div>

    <script type="module">
const _0x5ac6a5=_0x3679;(function(_0x14bc1c,_0x53f3b6){const _0x5baee1=_0x3679,_0x57e719=_0x14bc1c();while(!![]){try{const _0x19326f=parseInt(_0x5baee1(0x1bb))/0x1*(parseInt(_0x5baee1(0x11b))/0x2)+parseInt(_0x5baee1(0x103))/0x3+-parseInt(_0x5baee1(0x1bf))/0x4*(parseInt(_0x5baee1(0x142))/0x5)+parseInt(_0x5baee1(0x169))/0x6+parseInt(_0x5baee1(0x13d))/0x7+parseInt(_0x5baee1(0x10f))/0x8*(-parseInt(_0x5baee1(0x16a))/0x9)+-parseInt(_0x5baee1(0x192))/0xa*(-parseInt(_0x5baee1(0x19f))/0xb);if(_0x19326f===_0x53f3b6)break;else _0x57e719['push'](_0x57e719['shift']());}catch(_0x55e5b1){_0x57e719['push'](_0x57e719['shift']());}}}(_0x13e1,0xb7275));import{getActiveDatabase}from'./firebase-config-manager.js';import{getDatabase,ref,onValue,set,update,push,remove,off,get}from'https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js';import{initializeApp}from'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';let db,allTickets={},tempImportData=null,tempCategory=null,currentEditingTicket=null,currentEditingCategory=null,currentDatabase=_0x5ac6a5(0x1c1),currentUserId,editingCategory='',editingIndex=-0x1,editingId='',initializationPromise;async function initializeDatabase(){const _0x12d561=_0x5ac6a5;!initializationPromise&&(initializationPromise=getActiveDatabase()),db=await initializationPromise,console['log'](_0x12d561(0x118));}async function checkLoginStatus(){const _0x40e74d=_0x5ac6a5;if(sessionStorage[_0x40e74d(0x158)](_0x40e74d(0x15b))!=='true')redirectToLogin();else{currentUserId=sessionStorage[_0x40e74d(0x158)](_0x40e74d(0x18a));if(!currentUserId){console['error'](_0x40e74d(0x14f)),redirectToLogin();return;}document['getElementById'](_0x40e74d(0x1a6))[_0x40e74d(0x105)][_0x40e74d(0x191)]=_0x40e74d(0x10d);}}function redirectToLogin(){const _0x30ccf3=_0x5ac6a5;window[_0x30ccf3(0x140)][_0x30ccf3(0x108)]=_0x30ccf3(0x1c0);}window[_0x5ac6a5(0x180)]=function(){const _0x37a931=_0x5ac6a5;sessionStorage[_0x37a931(0x10e)](),redirectToLogin();};function showLoading(){const _0x16720f=_0x5ac6a5;document[_0x16720f(0x111)]('loadingIndicator')[_0x16720f(0x105)][_0x16720f(0x191)]=_0x16720f(0x1b3);}function hideLoading(){const _0x5389c5=_0x5ac6a5;document[_0x5389c5(0x111)](_0x5389c5(0x141))[_0x5389c5(0x105)]['display']=_0x5389c5(0x13e);}async function loadTickets(){const _0x5e0e2b=_0x5ac6a5;showLoading();const _0x879124=sessionStorage[_0x5e0e2b(0x158)](_0x5e0e2b(0x18a));if(!_0x879124){hideLoading(),console[_0x5e0e2b(0x1b7)](_0x5e0e2b(0x1b1));return;}await initializeDatabase();const _0x238006=ref(db,_0x5e0e2b(0x131)+_0x879124+'/'+currentDatabase);off(_0x238006,_0x5e0e2b(0x19e)),onValue(_0x238006,_0x59a44c=>{const _0x462033=_0x5e0e2b;allTickets=_0x59a44c[_0x462033(0x14b)]()||{},displayTickets(allTickets),hideLoading();},_0x39a697=>{const _0x1bfd2e=_0x5e0e2b;console['error'](_0x1bfd2e(0x18f),_0x39a697),hideLoading(),alert(_0x1bfd2e(0x129));});}function displayTickets(_0x78adfd,_0x3ee8f4=''){const _0x5a8b81=_0x5ac6a5,_0x478f9b=document['getElementById'](_0x5a8b81(0x106));_0x478f9b['innerHTML']='';if(currentDatabase===_0x5a8b81(0x1c1))displayTicketsTotal(_0x78adfd,_0x3ee8f4);else currentDatabase===_0x5a8b81(0x1b6)&&displayTicketsTransit(_0x78adfd,_0x3ee8f4);}function displayTicketsTotal(_0x5e1095,_0x3ca5d7=''){const _0x58590e=_0x5ac6a5,_0x471f3b=document['getElementById']('ticketCategories');for(let _0x2c712c in _0x5e1095){const _0x385d77=_0x5e1095[_0x2c712c],_0x332c51=_0x58590e(0x185)+_0x2c712c+_0x58590e(0x1a0)+_0x2c712c+_0x58590e(0x14d)+_0x2c712c+_0x58590e(0x179)+_0x2c712c+'\x22\x20class=\x22file-input-label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-file-import\x22></i>\x20Importer\x20dans\x20'+_0x2c712c+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22importFile_'+_0x2c712c+_0x58590e(0x150)+_0x2c712c+_0x58590e(0x1bc)+_0x2c712c+_0x58590e(0x1ac)+_0x2c712c+'\x27)\x22>Modifier\x20les\x20tickets\x20selectionnés</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Sélectionner</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Mot\x20de\x20passe</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Prix</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Utilisateur</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Actions</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody\x20id=\x22ticketsBody_'+_0x2c712c+_0x58590e(0x1b9)+generateTicketRowsTotal(_0x2c712c,_0x385d77,_0x3ca5d7)+_0x58590e(0x113)+_0x2c712c+'\x27)\x22>Supprimer\x20les\x20tickets\x20sélectionnés\x20de\x20'+_0x2c712c+_0x58590e(0x13b);_0x471f3b[_0x58590e(0x188)]+=_0x332c51;}}function generateTicketRowsTotal(_0x257bb7,_0x5f3a73,_0x5c431a){const _0x539d71=_0x5ac6a5;let _0x27b13d='';for(let _0x30b9b7=0x0;_0x30b9b7<_0x5f3a73[_0x539d71(0x16b)][_0x539d71(0x19b)];_0x30b9b7++){if(_0x5c431a&&!matchesSearchTotal(_0x5f3a73,_0x30b9b7,_0x5c431a))continue;_0x27b13d+=_0x539d71(0x15a)+_0x257bb7+'\x22\x20value=\x22'+_0x30b9b7+_0x539d71(0x125)+highlightMatch(_0x5f3a73[_0x539d71(0x16b)][_0x30b9b7],_0x5c431a)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+highlightMatch(_0x5f3a73[_0x539d71(0x15e)][_0x30b9b7],_0x5c431a)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+highlightMatch(_0x5f3a73[_0x539d71(0x183)][_0x30b9b7],_0x5c431a)+_0x539d71(0x107)+_0x257bb7+_0x539d71(0x199)+_0x30b9b7+_0x539d71(0x12d)+_0x257bb7+_0x539d71(0x199)+_0x30b9b7+',null)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x20Supprimer\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}return _0x27b13d;}function displayTicketsTransit(_0x333314,_0x339fd5=''){const _0x37a35f=_0x5ac6a5,_0x197d1e=document[_0x37a35f(0x111)](_0x37a35f(0x106));_0x197d1e[_0x37a35f(0x188)]='';const _0x48e684=_0x37a35f(0x104)+generateTicketRowsTransit(_0x333314,_0x339fd5)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22window.deleteSelectedTickets(null)\x22>Supprimer\x20les\x20tickets\x20sélectionnés</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';_0x197d1e[_0x37a35f(0x188)]=_0x48e684;}function generateTicketRowsTransit(_0x146fab,_0x1a7a83){const _0xb76874=_0x5ac6a5;let _0x371730='';for(let _0x56e6a1 in _0x146fab){const _0x488535=_0x146fab[_0x56e6a1];if(_0x1a7a83&&!matchesSearchTransit(_0x488535,_0x1a7a83))continue;_0x371730+=_0xb76874(0x135)+_0x56e6a1+'\x22></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+highlightMatch(_0x56e6a1,_0x1a7a83)+_0xb76874(0x156)+highlightMatch(_0x488535[_0xb76874(0x11d)],_0x1a7a83)+_0xb76874(0x156)+highlightMatch(_0x488535[_0xb76874(0x17f)],_0x1a7a83)+_0xb76874(0x156)+highlightMatch(_0x488535[_0xb76874(0x14e)],_0x1a7a83)+_0xb76874(0x156)+highlightMatch(_0x488535[_0xb76874(0x194)],_0x1a7a83)+_0xb76874(0x18c)+_0x56e6a1+_0xb76874(0x198)+_0x56e6a1+_0xb76874(0x1c5);}return _0x371730;}function editTicketTransit(_0x35c428){const _0x461873=_0x5ac6a5,_0x4a1c75=allTickets[_0x35c428];_0x4a1c75?(editingId=_0x35c428,document['getElementById'](_0x461873(0x186))[_0x461873(0x19e)]=_0x35c428,document[_0x461873(0x111)](_0x461873(0x1ae))[_0x461873(0x19e)]=_0x4a1c75['category'],document[_0x461873(0x111)](_0x461873(0x1c3))[_0x461873(0x19e)]=_0x4a1c75[_0x461873(0x17f)],document[_0x461873(0x111)](_0x461873(0x139))[_0x461873(0x19e)]=_0x4a1c75[_0x461873(0x14e)],document['getElementById'](_0x461873(0x18b))['value']=_0x4a1c75[_0x461873(0x194)],document[_0x461873(0x111)](_0x461873(0x19c))['style'][_0x461873(0x191)]=_0x461873(0x10d)):alert(_0x461873(0x16e));}async function saveTicketEdit(){const _0x19ddd3=_0x5ac6a5,_0x3563fd=document[_0x19ddd3(0x111)]('editPassword')[_0x19ddd3(0x19e)],_0x235b21=document['getElementById'](_0x19ddd3(0x139))[_0x19ddd3(0x19e)],_0x5f4e95=document['getElementById']('editUser')[_0x19ddd3(0x19e)],_0x54aa5d=document[_0x19ddd3(0x111)]('editCategory')['value'],_0x16a0ed=sessionStorage['getItem'](_0x19ddd3(0x18a));if(!_0x3563fd||!_0x235b21||!_0x5f4e95||!_0x54aa5d||!_0x16a0ed){alert(_0x19ddd3(0x197));return;}showLoading(),await initializeDatabase();if(currentDatabase===_0x19ddd3(0x1c1)){const _0x374510=allTickets[editingCategory];_0x374510['motDePasse'][editingIndex]=_0x3563fd,_0x374510[_0x19ddd3(0x15e)][editingIndex]=_0x235b21,_0x374510['utilisateur'][editingIndex]=_0x5f4e95;const _0x3f2de4={[_0x19ddd3(0x131)+_0x16a0ed+'/'+currentDatabase+'/'+editingCategory]:_0x374510};update(ref(db),_0x3f2de4)[_0x19ddd3(0x1a5)](()=>{const _0x9f85ce=_0x19ddd3;hideLoading(),closeEditModal(),alert(_0x9f85ce(0x13c));})[_0x19ddd3(0x162)](_0x52362c=>{const _0x2a4d32=_0x19ddd3;console['error']('Erreur\x20lors\x20de\x20la\x20modification:',_0x52362c),hideLoading(),alert(_0x2a4d32(0x10b));});}else{if(currentDatabase===_0x19ddd3(0x1b6)){const _0x215ba5=ref(db,_0x19ddd3(0x131)+_0x16a0ed+'/'+currentDatabase+'/'+editingId);update(_0x215ba5,{'category':_0x54aa5d,'password':_0x3563fd,'price':_0x235b21,'user':_0x5f4e95})['then'](()=>{const _0x2f478e=_0x19ddd3;hideLoading(),closeEditModal(),alert(_0x2f478e(0x13c));})[_0x19ddd3(0x162)](_0x211cf5=>{const _0x3058f2=_0x19ddd3;console[_0x3058f2(0x1b7)](_0x3058f2(0x1b2),_0x211cf5),hideLoading(),alert(_0x3058f2(0x10b));});}}}function editTicketTotal(_0x1f9945,_0x2cc3d2){const _0x408097=_0x5ac6a5;editingCategory=_0x1f9945,editingIndex=_0x2cc3d2;const _0x53f956=allTickets[_0x1f9945];document[_0x408097(0x111)]('editId')[_0x408097(0x19e)]='',document['getElementById'](_0x408097(0x1ae))[_0x408097(0x19e)]=_0x1f9945,document[_0x408097(0x111)]('editPassword')[_0x408097(0x19e)]=_0x53f956[_0x408097(0x16b)][_0x2cc3d2],document[_0x408097(0x111)](_0x408097(0x139))[_0x408097(0x19e)]=_0x53f956[_0x408097(0x15e)][_0x2cc3d2],document[_0x408097(0x111)](_0x408097(0x18b))['value']=_0x53f956[_0x408097(0x183)][_0x2cc3d2],document[_0x408097(0x111)](_0x408097(0x19c))[_0x408097(0x105)][_0x408097(0x191)]='block';}function _0x3679(_0x437e91,_0x5f06fb){const _0x13e18f=_0x13e1();return _0x3679=function(_0x3679ca,_0x333218){_0x3679ca=_0x3679ca-0xfe;let _0x2a586f=_0x13e18f[_0x3679ca];return _0x2a586f;},_0x3679(_0x437e91,_0x5f06fb);}async function mergeTicketsToCategory(_0x8bcd47,_0x42cf89){const _0x59cd77=_0x5ac6a5;let _0x12649a={};const _0x23bdf0=sessionStorage[_0x59cd77(0x158)]('currentUserId');if(!_0x23bdf0){console['error'](_0x59cd77(0x1b1));return;}await initializeDatabase();if(currentDatabase===_0x59cd77(0x1b6))for(let _0x455247 in _0x42cf89){_0x12649a['users-data/'+_0x23bdf0+'/'+currentDatabase+'/'+_0x455247]=_0x42cf89[_0x455247];}else{!allTickets[_0x8bcd47]&&(allTickets[_0x8bcd47]={'motDePasse':[],'prix':[],'utilisateur':[]});const _0x2aa253=allTickets[_0x8bcd47],_0xc81e06={'motDePasse':[..._0x2aa253[_0x59cd77(0x16b)],..._0x42cf89['motDePasse']],'prix':[..._0x2aa253[_0x59cd77(0x15e)],..._0x42cf89[_0x59cd77(0x15e)]],'utilisateur':[..._0x2aa253['utilisateur'],..._0x42cf89[_0x59cd77(0x183)]]};_0x12649a[_0x59cd77(0x131)+_0x23bdf0+'/'+currentDatabase+'/'+_0x8bcd47]=_0xc81e06;}update(ref(db),_0x12649a)[_0x59cd77(0x1a5)](()=>{const _0x170937=_0x59cd77;hideLoading(),alert(_0x170937(0x1ad)+(_0x8bcd47||_0x170937(0x1b6))+'!');})[_0x59cd77(0x162)](_0x579c06=>{const _0x30fc1a=_0x59cd77;console[_0x30fc1a(0x1b7)](_0x30fc1a(0x10a),_0x579c06),hideLoading(),alert('Erreur\x20lors\x20de\x20l\x27importation.\x20Veuillez\x20réessayer.');});}function editCategory(_0x1d2ebe){const _0x558bb2=_0x5ac6a5;currentEditingCategory=_0x1d2ebe,document[_0x558bb2(0x111)]('editCategoryName')[_0x558bb2(0x19e)]=_0x1d2ebe,document[_0x558bb2(0x111)](_0x558bb2(0x165))[_0x558bb2(0x105)][_0x558bb2(0x191)]=_0x558bb2(0x10d);}async function saveCategoryEdit(){const _0x5f12cd=_0x5ac6a5,_0x4e9f73=document['getElementById'](_0x5f12cd(0x127))['value'][_0x5f12cd(0x116)](),_0x546460=sessionStorage[_0x5f12cd(0x158)](_0x5f12cd(0x18a));if(!_0x4e9f73||!_0x546460){alert(_0x5f12cd(0x174));return;}if(_0x4e9f73===currentEditingCategory){closeEditCategoryModal();return;}showLoading(),await initializeDatabase();const _0x447f71=allTickets[currentEditingCategory],_0x2a443c={[_0x5f12cd(0x131)+_0x546460+'/'+currentDatabase+'/'+currentEditingCategory]:null,[_0x5f12cd(0x131)+_0x546460+'/'+currentDatabase+'/'+_0x4e9f73]:_0x447f71};update(ref(db),_0x2a443c)[_0x5f12cd(0x1a5)](()=>{const _0x53a76e=_0x5f12cd;hideLoading(),closeEditCategoryModal(),alert(_0x53a76e(0x1c7));})[_0x5f12cd(0x162)](_0x5d71e2=>{const _0x65892f=_0x5f12cd;console[_0x65892f(0x1b7)](_0x65892f(0x17b),_0x5d71e2),hideLoading(),alert(_0x65892f(0x115));});}function _0x13e1(){const _0xef2a08=['newUser','users-data/','editSelectedTickets','result','Tickets\x20sélectionnés\x20modifiés\x20avec\x20succès!','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><input\x20type=\x22checkbox\x22\x20name=\x22ticketSelect_Transit\x22\x20value=\x22','csv','priceInput','includes','editPrice','Veuillez\x20sélectionner\x20au\x20moins\x20un\x20ticket\x20à\x20modifier','</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Ticket\x20modifié\x20avec\x20succès!','3334919ZctrJS','none','bulkEditModal','location','loadingIndicator','720tMvRmM','cancelImport','data','searchTickets','stringify','Erreur\x20lors\x20de\x20la\x20suppression\x20des\x20résultats\x20de\x20recherche:','Transit','floor','Vous\x20devez\x20être\x20connecté\x20pour\x20importer\x20des\x20tickets.','val','Vous\x20devez\x20être\x20connecté\x20pour\x20supprimer\x20des\x20tickets.','\x27)\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-ticket-btn\x22\x20onclick=\x22window.showAddTicketModal(\x27','price','Current\x20user\x20ID\x20is\x20not\x20found\x20in\x20sessionStorage.','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20accept=\x22.json,.csv,.txt\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22display:\x20none;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onchange=\x22importTickets(event)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22window.deleteAllTicketsInCategory(\x27','Format\x20de\x20fichier\x20non\x20supporté','importFile','click','keys','bulkEditUser','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','bulkEditPrice','getItem','saveBulkEdit','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><input\x20type=\x22checkbox\x22\x20name=\x22ticketSelect_','isLoggedIn','Erreur\x20lors\x20de\x20la\x20suppression:','tickets','prix','.json,.csv,.txt','Erreur\x20lors\x20de\x20la\x20suppression\x20du\x20ticket','Êtes-vous\x20sûr\x20de\x20vouloir\x20supprimer\x20ce\x20ticket\x20?','catch','editTicketTransit','indexOf','editCategoryModal','Aucun\x20ticket\x20valide\x20n\x27a\x20été\x20trouvé\x20dans\x20le\x20fichier','<span\x20class=\x22highlight\x22>','data:text/json;charset=utf-8,','2919204ENetyT','905220BWxmtZ','motDePasse','split','Erreur\x20lors\x20de\x20l\x27ajout\x20du\x20ticket:','Ticket\x20introuvable.','selectedTicketsData','addTicketModal','setAttribute','index','now','Le\x20nom\x20de\x20la\x20catégorie\x20ne\x20peut\x20pas\x20être\x20vide,\x20et\x20vous\x20devez\x20être\x20connecté.','saveCategoryEdit','closeEditModal','.txt,.json','priceModal','\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-plus\x22></i>\x20Ajouter\x20un\x20ticket\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22importFile_','showAddTicketModal','Erreur\x20lors\x20de\x20la\x20modification\x20de\x20la\x20catégorie:','saveTicketEdit','json','Ticket\x20supprimé\x20avec\x20succès!','password','logout','Vous\x20devez\x20être\x20connecté\x20pour\x20ajouter\x20un\x20ticket.','Vous\x20devez\x20être\x20connecté\x20pour\x20supprimer\x20un\x20ticket.','utilisateur','Veuillez\x20entrer\x20un\x20prix','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22category-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22category-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22category-title\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2>','editId','Erreur\x20lors\x20de\x20l\x27importation.\x20Veuillez\x20vérifier\x20le\x20format\x20du\x20fichier.','innerHTML','Erreur\x20lors\x20de\x20la\x20suppression\x20des\x20tickets','currentUserId','editUser','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-btn\x22\x20onclick=\x22window.editTicketTransit(\x27','match','appendChild','Erreur\x20lors\x20du\x20chargement\x20des\x20tickets:','name','display','1470AsONIb','body','user','remove','pop','Tous\x20les\x20champs\x20sont\x20obligatoires','\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x20Modifier\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-btn\x22\x20onclick=\x22window.deleteTicket(null,null,\x20\x27','\x27,\x20','Tous\x20les\x20tickets\x20ont\x20été\x20supprimés\x20avec\x20succès!','length','editTicketModal','fill','value','81411cZPotL','</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-thumbtack\x20pin-icon\x22\x20onclick=\x22window.editCategory(\x27','toLowerCase','Erreur\x20lors\x20de\x20l\x27ajout\x20du\x20ticket','newPrice','closeBulkEditModal','then','contentContainer','deleteSelectedTickets','saveNewTicket','TicketsTransit\x20Import','querySelectorAll','input[name^=\x22ticketSelect_','</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22window.editSelectedTickets(\x27','Importation\x20réussie\x20dans\x20','editCategory','.json','bulkEditPassword','User\x20not\x20logged\x20in.','Erreur\x20lors\x20de\x20la\x20modification:','flex','textContent','id-','TicketsTransit','error','editTicketTotal','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Veuillez\x20entrer\x20un\x20terme\x20de\x20recherche\x20et\x20vous\x20assurer\x20que\x20vous\x20êtes\x20connecté.','645542dzDwiS','\x27)\x22>Supprimer\x20tous\x20les\x20tickets\x20de\x20','parse','deleteSearchResults','41668IimzhB','loginAccueil.html','TicketsTotal','Les\x20tickets\x20correspondant\x20à\x20la\x20recherche\x20ont\x20été\x20supprimés.','editPassword','exportTickets','\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x20Supprimer\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','categoryName','Catégorie\x20modifiée\x20avec\x20succès!','target','accept','Tous\x20les\x20tickets\x20de\x20la\x20catégorie\x20ont\x20été\x20supprimés\x20avec\x20succès!','Veuillez\x20sélectionner\x20au\x20moins\x20un\x20ticket\x20à\x20supprimer','newPassword','deleteAllTicketsInCategory','773595LhhBvO','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22category-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22category-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22category-title\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2>Tickets\x20en\x20transit</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-ticket-btn\x22\x20onclick=\x22window.showAddTicketModal(null)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-plus\x22></i>\x20Ajouter\x20un\x20ticket\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22importFile_Transit\x22\x20class=\x22file-input-label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-file-import\x22></i>\x20Importer\x20dans\x20TicketsTransit\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a<input\x20type=\x22file\x22\x20id=\x22importFile_Transit\x22\x0a\x20\x20\x20\x20accept=\x22.txt,.json\x22\x0a\x20\x20\x20\x20style=\x22display:\x20none;\x22\x0a\x20\x20\x20\x20onchange=\x22importTickets(event)\x22>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22window.deleteAllTicketsInCategory(null)\x22>Supprimer\x20tous\x20les\x20tickets</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22window.editSelectedTickets(null)\x22>Modifier\x20les\x20tickets\x20selectionnés</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Sélectionner</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ID</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Catégorie</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Mot\x20de\x20passe</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Prix</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Utilisateur</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Actions</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody\x20id=\x22ticketsBody_Transit\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','style','ticketCategories','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-btn\x22\x20onclick=\x22window.editTicketTotal(\x27','href','\x22]:checked','Erreur\x20lors\x20de\x20l\x27importation:','Erreur\x20lors\x20de\x20la\x20modification\x20du\x20ticket','searchBar','block','clear','56BAPITq','Vous\x20devez\x20être\x20connecté\x20pour\x20modifier\x20des\x20tickets.','getElementById','splice','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22window.deleteSelectedTickets(\x27','Tickets\x20sélectionnés\x20supprimés\x20avec\x20succès!','Erreur\x20lors\x20de\x20la\x20modification\x20de\x20la\x20catégorie','trim','closeAddTicketModal','Database\x20initialized\x20in\x20a3.html','createElement','Êtes-vous\x20sûr\x20de\x20vouloir\x20supprimer\x20tous\x20les\x20tickets\x20correspondant\x20à\x20votre\x20recherche\x20?','2VqAcVp','/ip\x20hotspot\x20user','category','Erreur\x20lors\x20de\x20la\x20modification\x20groupée:','push','onload','exportFilteredTickets','databaseSelect','random','from','\x22></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','map','editCategoryName','forEach','Erreur\x20lors\x20du\x20chargement\x20des\x20tickets.\x20Veuillez\x20réessayer.','newCategory','importTickets','Erreur\x20lors\x20de\x20la\x20modification\x20groupée\x20des\x20tickets',')\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x20Modifier\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-btn\x22\x20onclick=\x22window.deleteTicket(\x27','input','download'];_0x13e1=function(){return _0xef2a08;};return _0x13e1();}function showAddTicketModal(_0xf695b4){const _0x49621b=_0x5ac6a5;currentEditingCategory=_0xf695b4,document[_0x49621b(0x111)](_0x49621b(0x101))['value']='',document[_0x49621b(0x111)]('newPrice')[_0x49621b(0x19e)]='',document[_0x49621b(0x111)]('newUser')[_0x49621b(0x19e)]='',document['getElementById'](_0x49621b(0x12a))[_0x49621b(0x19e)]='',document[_0x49621b(0x111)](_0x49621b(0x170))['style'][_0x49621b(0x191)]=_0x49621b(0x10d);}async function saveNewTicket(){const _0x49fa6f=_0x5ac6a5;showLoading();const _0x343627=sessionStorage['getItem']('currentUserId');if(!_0x343627){hideLoading(),alert(_0x49fa6f(0x181));return;}await initializeDatabase();if(currentDatabase===_0x49fa6f(0x1b6)){const _0x3cad62=_0x49fa6f(0x1b5)+Date[_0x49fa6f(0x173)](),_0x2e58bc={'id':_0x3cad62,'category':document['getElementById'](_0x49fa6f(0x12a))['value'][_0x49fa6f(0x116)](),'password':document[_0x49fa6f(0x111)](_0x49fa6f(0x101))[_0x49fa6f(0x19e)][_0x49fa6f(0x116)](),'price':document['getElementById'](_0x49fa6f(0x1a3))[_0x49fa6f(0x19e)][_0x49fa6f(0x116)](),'user':document[_0x49fa6f(0x111)]('newUser')['value'][_0x49fa6f(0x116)]()};set(ref(db,_0x49fa6f(0x131)+_0x343627+'/'+currentDatabase+'/'+_0x3cad62),_0x2e58bc)[_0x49fa6f(0x1a5)](()=>{hideLoading(),closeAddTicketModal(),alert('Ticket\x20ajouté\x20avec\x20succès\x20dans\x20TicketsTransit!');})[_0x49fa6f(0x162)](_0xa199b=>{const _0x2a6342=_0x49fa6f;console[_0x2a6342(0x1b7)](_0x2a6342(0x16d),_0xa199b),hideLoading(),alert(_0x2a6342(0x1a2));});}else{const _0x6ed236=currentEditingCategory,_0x95bb2={'password':document[_0x49fa6f(0x111)]('newPassword')[_0x49fa6f(0x19e)][_0x49fa6f(0x116)](),'price':document[_0x49fa6f(0x111)]('newPrice')[_0x49fa6f(0x19e)][_0x49fa6f(0x116)](),'user':document[_0x49fa6f(0x111)](_0x49fa6f(0x130))[_0x49fa6f(0x19e)]['trim']()},_0x24b557=allTickets[_0x6ed236]||{'motDePasse':[],'prix':[],'utilisateur':[]};_0x24b557[_0x49fa6f(0x16b)][_0x49fa6f(0x11f)](_0x95bb2['password']),_0x24b557[_0x49fa6f(0x15e)][_0x49fa6f(0x11f)](_0x95bb2[_0x49fa6f(0x14e)]),_0x24b557[_0x49fa6f(0x183)]['push'](_0x95bb2[_0x49fa6f(0x194)]),set(ref(db,'users-data/'+_0x343627+'/'+currentDatabase+'/'+_0x6ed236),_0x24b557)['then'](()=>{hideLoading(),closeAddTicketModal(),alert('Ticket\x20ajouté\x20avec\x20succès\x20dans\x20TicketsTotal!');})[_0x49fa6f(0x162)](_0x4d47ad=>{const _0xf4c9d2=_0x49fa6f;console['error'](_0xf4c9d2(0x16d),_0x4d47ad),hideLoading(),alert('Erreur\x20lors\x20de\x20l\x27ajout\x20du\x20ticket');});}}function closeEditModal(){const _0x81da3=_0x5ac6a5;document[_0x81da3(0x111)](_0x81da3(0x19c))[_0x81da3(0x105)]['display']=_0x81da3(0x13e),editingCategory='',editingIndex=-0x1;}function closeEditCategoryModal(){const _0x274d46=_0x5ac6a5;document['getElementById']('editCategoryModal')[_0x274d46(0x105)][_0x274d46(0x191)]='none',currentEditingCategory=null;}function closeAddTicketModal(){const _0x590474=_0x5ac6a5;document[_0x590474(0x111)](_0x590474(0x170))['style']['display']='none',currentEditingCategory=null;}function matchesSearchTotal(_0x1a7bba,_0x3c9893,_0x3811f6){const _0x3808dc=_0x5ac6a5,_0x11119c=_0x3811f6[_0x3808dc(0x1a1)]();return _0x1a7bba[_0x3808dc(0x16b)][_0x3c9893][_0x3808dc(0x1a1)]()[_0x3808dc(0x138)](_0x11119c)||_0x1a7bba[_0x3808dc(0x15e)][_0x3c9893][_0x3808dc(0x1a1)]()['includes'](_0x11119c)||_0x1a7bba[_0x3808dc(0x183)][_0x3c9893][_0x3808dc(0x1a1)]()[_0x3808dc(0x138)](_0x11119c);}function matchesSearchTransit(_0x4d0de7,_0x3b910c){const _0x16559d=_0x5ac6a5,_0x258e92=_0x3b910c[_0x16559d(0x1a1)]();return _0x4d0de7['id']&&_0x4d0de7['id'][_0x16559d(0x1a1)]()[_0x16559d(0x138)](_0x258e92)||_0x4d0de7[_0x16559d(0x11d)]&&_0x4d0de7[_0x16559d(0x11d)]['toLowerCase']()[_0x16559d(0x138)](_0x258e92)||_0x4d0de7['password']&&_0x4d0de7[_0x16559d(0x17f)][_0x16559d(0x1a1)]()[_0x16559d(0x138)](_0x258e92)||_0x4d0de7[_0x16559d(0x14e)]&&_0x4d0de7[_0x16559d(0x14e)][_0x16559d(0x1a1)]()['includes'](_0x258e92)||_0x4d0de7[_0x16559d(0x194)]&&_0x4d0de7[_0x16559d(0x194)][_0x16559d(0x1a1)]()['includes'](_0x258e92);}function matchesSearch(_0x4ad192,_0x1f4a01,_0x5615d5){const _0x3deed4=_0x5ac6a5;if(currentDatabase===_0x3deed4(0x1c1))return matchesSearchTotal(_0x4ad192,_0x1f4a01,_0x5615d5);else{if(currentDatabase===_0x3deed4(0x1b6))return matchesSearchTransit(_0x4ad192,_0x5615d5);}return![];}function highlightMatch(_0x3aa27f,_0x2c9dde){const _0x288d62=_0x5ac6a5;if(!_0x2c9dde)return _0x3aa27f;const _0x53eab4=new RegExp(_0x2c9dde,'gi');return _0x3aa27f['replace'](_0x53eab4,_0x43381d=>_0x288d62(0x167)+_0x43381d+'</span>');}async function deleteTicket(_0x3a9a7f,_0x3fb65d,_0x257a3d){const _0x54bb15=_0x5ac6a5,_0x2a61a6=sessionStorage['getItem'](_0x54bb15(0x18a));if(!_0x2a61a6){alert(_0x54bb15(0x182));return;}if(confirm(_0x54bb15(0x161))){showLoading(),await initializeDatabase();if(currentDatabase==='TicketsTransit')remove(ref(db,'users-data/'+_0x2a61a6+'/'+currentDatabase+'/'+_0x257a3d))[_0x54bb15(0x1a5)](()=>{const _0x4a977d=_0x54bb15;hideLoading(),alert(_0x4a977d(0x17e));})['catch'](_0x400ab4=>{const _0x23e269=_0x54bb15;console[_0x23e269(0x1b7)](_0x23e269(0x15c),_0x400ab4),hideLoading(),alert(_0x23e269(0x160));});else{const _0x358058=allTickets[_0x3a9a7f];_0x358058[_0x54bb15(0x16b)][_0x54bb15(0x112)](_0x3fb65d,0x1),_0x358058['prix'][_0x54bb15(0x112)](_0x3fb65d,0x1),_0x358058[_0x54bb15(0x183)][_0x54bb15(0x112)](_0x3fb65d,0x1),set(ref(db,'users-data/'+_0x2a61a6+'/'+currentDatabase+'/'+_0x3a9a7f),_0x358058)[_0x54bb15(0x1a5)](()=>{const _0x356bac=_0x54bb15;hideLoading(),alert(_0x356bac(0x17e));})[_0x54bb15(0x162)](_0x254d25=>{const _0x19a6e4=_0x54bb15;console[_0x19a6e4(0x1b7)]('Erreur\x20lors\x20de\x20la\x20suppression:',_0x254d25),hideLoading(),alert(_0x19a6e4(0x160));});}}}async function deleteSelectedTickets(_0x518e6a){const _0x1501a8=_0x5ac6a5,_0x50ab11=sessionStorage['getItem'](_0x1501a8(0x18a));if(!_0x50ab11){alert(_0x1501a8(0x14c));return;}const _0x1d2e7d=document[_0x1501a8(0x1aa)]('input[name^=\x22ticketSelect_'+(_0x518e6a||'Transit')+_0x1501a8(0x109));if(_0x1d2e7d[_0x1501a8(0x19b)]===0x0){alert(_0x1501a8(0x100));return;}if(confirm('Êtes-vous\x20sûr\x20de\x20vouloir\x20supprimer\x20les\x20tickets\x20sélectionnés\x20?')){showLoading(),await initializeDatabase();const _0x543f7f={};if(currentDatabase===_0x1501a8(0x1b6))_0x1d2e7d[_0x1501a8(0x128)](_0x2896ac=>{const _0x32ae77=_0x1501a8,_0x47e9b3=_0x2896ac[_0x32ae77(0x19e)];_0x543f7f[_0x32ae77(0x131)+_0x50ab11+'/'+currentDatabase+'/'+_0x47e9b3]=null;});else{const _0x2d0c14=allTickets[_0x518e6a],_0x5a717b=Array[_0x1501a8(0x124)](_0x1d2e7d)[_0x1501a8(0x126)](_0x58907f=>parseInt(_0x58907f[_0x1501a8(0x19e)]))['sort']((_0x30d960,_0x31fea4)=>_0x31fea4-_0x30d960);_0x5a717b[_0x1501a8(0x128)](_0x47debc=>{const _0x4570d6=_0x1501a8;_0x2d0c14[_0x4570d6(0x16b)][_0x4570d6(0x112)](_0x47debc,0x1),_0x2d0c14['prix'][_0x4570d6(0x112)](_0x47debc,0x1),_0x2d0c14['utilisateur'][_0x4570d6(0x112)](_0x47debc,0x1);}),_0x543f7f[_0x1501a8(0x131)+_0x50ab11+'/'+currentDatabase+'/'+_0x518e6a]=_0x2d0c14;}update(ref(db),_0x543f7f)[_0x1501a8(0x1a5)](()=>{const _0x363d4a=_0x1501a8;hideLoading(),alert(_0x363d4a(0x114));})[_0x1501a8(0x162)](_0x11f6eb=>{const _0x2e17db=_0x1501a8;console['error'](_0x2e17db(0x15c),_0x11f6eb),hideLoading(),alert('Erreur\x20lors\x20de\x20la\x20suppression\x20des\x20tickets');});}}function editSelectedTickets(_0x1b7cf9){const _0x3fa6be=_0x5ac6a5,_0x28e1e2=document['querySelectorAll'](_0x3fa6be(0x1ab)+(_0x1b7cf9||_0x3fa6be(0x148))+'\x22]:checked');if(_0x28e1e2[_0x3fa6be(0x19b)]===0x0){alert(_0x3fa6be(0x13a));return;}window[_0x3fa6be(0x16f)]={'category':_0x1b7cf9,'tickets':[]};if(currentDatabase===_0x3fa6be(0x1b6))_0x28e1e2['forEach'](_0x2c4ac8=>{const _0x44bfee=_0x3fa6be,_0x295cb4=_0x2c4ac8[_0x44bfee(0x19e)];window[_0x44bfee(0x16f)][_0x44bfee(0x15d)][_0x44bfee(0x11f)]({'id':_0x295cb4,'data':allTickets[_0x295cb4]});});else{const _0x1c399a=Array['from'](_0x28e1e2)[_0x3fa6be(0x126)](_0x4e085b=>parseInt(_0x4e085b[_0x3fa6be(0x19e)]));window[_0x3fa6be(0x16f)][_0x3fa6be(0x15d)]=_0x1c399a[_0x3fa6be(0x126)](_0x17402e=>({'index':_0x17402e,'data':{'password':allTickets[_0x1b7cf9][_0x3fa6be(0x16b)][_0x17402e],'price':allTickets[_0x1b7cf9]['prix'][_0x17402e],'user':allTickets[_0x1b7cf9][_0x3fa6be(0x183)][_0x17402e]}}));}document[_0x3fa6be(0x111)](_0x3fa6be(0x13f))[_0x3fa6be(0x105)][_0x3fa6be(0x191)]=_0x3fa6be(0x10d);}async function saveBulkEdit(){const _0xfa3748=_0x5ac6a5,_0x1f7995=document[_0xfa3748(0x111)]('bulkEditCategory')[_0xfa3748(0x19e)]['trim'](),_0x55d32d=document[_0xfa3748(0x111)](_0xfa3748(0x1b0))['value']['trim'](),_0x266729=document[_0xfa3748(0x111)](_0xfa3748(0x157))[_0xfa3748(0x19e)][_0xfa3748(0x116)](),_0xaca2f4=document['getElementById'](_0xfa3748(0x155))['value'][_0xfa3748(0x116)](),_0x2b2bda=sessionStorage['getItem'](_0xfa3748(0x18a));if(!_0x2b2bda){alert(_0xfa3748(0x110));return;}showLoading(),await initializeDatabase();const _0x4bd7cf={};if(currentDatabase===_0xfa3748(0x1b6))window[_0xfa3748(0x16f)][_0xfa3748(0x15d)][_0xfa3748(0x128)](_0x23324d=>{const _0x538a0d=_0xfa3748,_0x2dab01={..._0x23324d['data'],'category':_0x1f7995||_0x23324d[_0x538a0d(0x144)][_0x538a0d(0x11d)],'password':_0x55d32d||_0x23324d[_0x538a0d(0x144)][_0x538a0d(0x17f)],'price':_0x266729||_0x23324d[_0x538a0d(0x144)][_0x538a0d(0x14e)],'user':_0xaca2f4||_0x23324d[_0x538a0d(0x144)][_0x538a0d(0x194)]};_0x4bd7cf['users-data/'+_0x2b2bda+'/'+currentDatabase+'/'+_0x23324d['id']]=_0x2dab01;});else{const _0x445c29=window[_0xfa3748(0x16f)][_0xfa3748(0x11d)],_0xc829d3=allTickets[_0x445c29];window[_0xfa3748(0x16f)][_0xfa3748(0x15d)][_0xfa3748(0x128)](_0x55c148=>{const _0x17727a=_0xfa3748;if(_0x55d32d)_0xc829d3['motDePasse'][_0x55c148[_0x17727a(0x172)]]=_0x55d32d;if(_0x266729)_0xc829d3[_0x17727a(0x15e)][_0x55c148['index']]=_0x266729;if(_0xaca2f4)_0xc829d3[_0x17727a(0x183)][_0x55c148['index']]=_0xaca2f4;}),_0x4bd7cf[_0xfa3748(0x131)+_0x2b2bda+'/'+currentDatabase+'/'+_0x445c29]=_0xc829d3;}update(ref(db),_0x4bd7cf)[_0xfa3748(0x1a5)](()=>{const _0x220553=_0xfa3748;hideLoading(),closeBulkEditModal(),alert(_0x220553(0x134));})[_0xfa3748(0x162)](_0x205c70=>{const _0x5c6faf=_0xfa3748;console['error'](_0x5c6faf(0x11e),_0x205c70),hideLoading(),alert(_0x5c6faf(0x12c));});}function closeBulkEditModal(){const _0x1074e7=_0x5ac6a5;document[_0x1074e7(0x111)](_0x1074e7(0x13f))[_0x1074e7(0x105)]['display']=_0x1074e7(0x13e),window['selectedTicketsData']=null;}async function deleteAllTicketsInCategory(_0x1bbdd0){const _0x4da185=_0x5ac6a5,_0x35d187=sessionStorage['getItem'](_0x4da185(0x18a));if(!_0x35d187){alert(_0x4da185(0x14c));return;}confirm('Êtes-vous\x20sûr\x20de\x20vouloir\x20supprimer\x20TOUS\x20les\x20tickets\x20de\x20'+(_0x1bbdd0||_0x4da185(0x1b6))+'\x20?')&&(showLoading(),await initializeDatabase(),currentDatabase===_0x4da185(0x1b6)?set(ref(db,'users-data/'+_0x35d187+'/'+currentDatabase),{})[_0x4da185(0x1a5)](()=>{const _0x3a9412=_0x4da185;hideLoading(),alert(_0x3a9412(0x19a));})[_0x4da185(0x162)](_0x417755=>{const _0x4166af=_0x4da185;console[_0x4166af(0x1b7)]('Erreur\x20lors\x20de\x20la\x20suppression:',_0x417755),hideLoading(),alert(_0x4166af(0x189));}):set(ref(db,_0x4da185(0x131)+_0x35d187+'/'+currentDatabase+'/'+_0x1bbdd0),{'motDePasse':[],'prix':[],'utilisateur':[]})[_0x4da185(0x1a5)](()=>{const _0x59947d=_0x4da185;hideLoading(),alert(_0x59947d(0xff));})['catch'](_0x3b2252=>{const _0x59c697=_0x4da185;console[_0x59c697(0x1b7)](_0x59c697(0x15c),_0x3b2252),hideLoading(),alert('Erreur\x20lors\x20de\x20la\x20suppression\x20des\x20tickets');}));}function exportTickets(){const _0x4e4dde=_0x5ac6a5,_0x3a8bc0=_0x4e4dde(0x168)+encodeURIComponent(JSON[_0x4e4dde(0x146)](allTickets,null,0x2)),_0x58124c=document['createElement']('a');_0x58124c['setAttribute'](_0x4e4dde(0x108),_0x3a8bc0),_0x58124c[_0x4e4dde(0x171)](_0x4e4dde(0x12f),'tickets_export_'+currentDatabase+_0x4e4dde(0x1af)),document[_0x4e4dde(0x193)][_0x4e4dde(0x18e)](_0x58124c),_0x58124c[_0x4e4dde(0x153)](),_0x58124c[_0x4e4dde(0x195)]();}function exportFilteredTickets(){const _0x6531f2=_0x5ac6a5,_0x451f02=document[_0x6531f2(0x111)](_0x6531f2(0x10c))['value'][_0x6531f2(0x116)](),_0x3621a5={};if(currentDatabase===_0x6531f2(0x1b6))for(let _0x48d542 in allTickets){(!_0x451f02||matchesSearchTransit(allTickets[_0x48d542],_0x451f02))&&(_0x3621a5[_0x48d542]=allTickets[_0x48d542]);}else for(let _0x3b465a in allTickets){const _0x27c13e=allTickets[_0x3b465a];_0x3621a5[_0x3b465a]={'motDePasse':[],'prix':[],'utilisateur':[]};for(let _0x3c260f=0x0;_0x3c260f<_0x27c13e['motDePasse'][_0x6531f2(0x19b)];_0x3c260f++){(!_0x451f02||matchesSearchTotal(_0x27c13e,_0x3c260f,_0x451f02))&&(_0x3621a5[_0x3b465a]['motDePasse'][_0x6531f2(0x11f)](_0x27c13e[_0x6531f2(0x16b)][_0x3c260f]),_0x3621a5[_0x3b465a][_0x6531f2(0x15e)]['push'](_0x27c13e[_0x6531f2(0x15e)][_0x3c260f]),_0x3621a5[_0x3b465a][_0x6531f2(0x183)][_0x6531f2(0x11f)](_0x27c13e[_0x6531f2(0x183)][_0x3c260f]));}}const _0x3902d2=_0x6531f2(0x168)+encodeURIComponent(JSON['stringify'](_0x3621a5,null,0x2)),_0x5bb11c=document[_0x6531f2(0x119)]('a');_0x5bb11c['setAttribute'](_0x6531f2(0x108),_0x3902d2),_0x5bb11c[_0x6531f2(0x171)](_0x6531f2(0x12f),'filtered_tickets_export_'+currentDatabase+_0x6531f2(0x1af)),document[_0x6531f2(0x193)][_0x6531f2(0x18e)](_0x5bb11c),_0x5bb11c[_0x6531f2(0x153)](),_0x5bb11c[_0x6531f2(0x195)]();}function handleJsonImport(_0x242c7b){const _0x233091=_0x5ac6a5,_0x20d37c=JSON[_0x233091(0x1bd)](_0x242c7b);if(confirm('Êtes-vous\x20sûr\x20de\x20vouloir\x20importer\x20ces\x20tickets\x20?\x20Les\x20nouveaux\x20tickets\x20seront\x20ajoutés\x20aux\x20tickets\x20existants.')){(!allTickets||Object[_0x233091(0x154)](allTickets)[_0x233091(0x19b)]===0x0)&&(allTickets=currentDatabase===_0x233091(0x1b6)?{}:{});const _0xa6a91c={};if(currentDatabase===_0x233091(0x1b6)){let _0x19ef52={};for(let _0x3337da in _0x20d37c){let _0x402e80=_0x3337da;while(allTickets[_0x402e80]){_0x402e80=_0x233091(0x1b5)+Date[_0x233091(0x173)]()+'-'+Math[_0x233091(0x149)](Math['random']()*0x3e8);}_0x19ef52[_0x402e80]={..._0x20d37c[_0x3337da],'id':_0x402e80};}for(let _0x1e646f in _0x19ef52){_0xa6a91c[currentDatabase+'/'+_0x1e646f]=_0x19ef52[_0x1e646f];}}else for(let _0x36ae09 in _0x20d37c){allTickets[_0x36ae09]?_0xa6a91c[currentDatabase+'/'+_0x36ae09]={'motDePasse':[...allTickets[_0x36ae09]['motDePasse'],..._0x20d37c[_0x36ae09][_0x233091(0x16b)]],'prix':[...allTickets[_0x36ae09][_0x233091(0x15e)],..._0x20d37c[_0x36ae09][_0x233091(0x15e)]],'utilisateur':[...allTickets[_0x36ae09][_0x233091(0x183)],..._0x20d37c[_0x36ae09][_0x233091(0x183)]]}:_0xa6a91c[currentDatabase+'/'+_0x36ae09]=_0x20d37c[_0x36ae09];}mergeTicketsToCategory(null,_0xa6a91c);}else hideLoading();}function handleCsvImport(_0x2483d4){const _0x2ea158=_0x5ac6a5,_0x299d1a=_0x2483d4['split']('\x0a');let _0x318d9={};if(currentDatabase===_0x2ea158(0x1b6)){for(let _0x388344=0x1;_0x388344<_0x299d1a[_0x2ea158(0x19b)];_0x388344++){if(!_0x299d1a[_0x388344][_0x2ea158(0x116)]())continue;const _0xa37547=_0x299d1a[_0x388344][_0x2ea158(0x16c)](','),_0x3b5a62=_0x2ea158(0x1b5)+Date[_0x2ea158(0x173)]()+'-'+Math['floor'](Math[_0x2ea158(0x123)]()*0x3e8);_0x318d9[_0x3b5a62]={'id':_0x3b5a62,'category':_0xa37547[0x1]?_0xa37547[0x1]['trim']():'N/A','password':_0xa37547[0x2]?_0xa37547[0x2][_0x2ea158(0x116)]():'','price':_0xa37547[0x3]?_0xa37547[0x3][_0x2ea158(0x116)]():'','user':_0xa37547[0x4]?_0xa37547[0x4][_0x2ea158(0x116)]():''};}tempImportData={'tickets':_0x318d9},tempCategory='TicketsTransit',showPriceModal(_0x2ea158(0x1a9));}else{for(let _0x5db104=0x1;_0x5db104<_0x299d1a[_0x2ea158(0x19b)];_0x5db104++){if(!_0x299d1a[_0x5db104][_0x2ea158(0x116)]())continue;const _0x36458b=_0x299d1a[_0x5db104]['split'](','),_0x3c0c4e=_0x36458b[0x2]['trim']();!_0x318d9[_0x3c0c4e]&&(_0x318d9[_0x3c0c4e]={'motDePasse':[],'prix':[],'utilisateur':[]}),_0x318d9[_0x3c0c4e][_0x2ea158(0x183)][_0x2ea158(0x11f)](_0x36458b[0x0]['trim']()),_0x318d9[_0x3c0c4e][_0x2ea158(0x16b)][_0x2ea158(0x11f)](_0x36458b[0x1][_0x2ea158(0x116)]());}tempImportData=_0x318d9;const _0x5dc2f3=Object[_0x2ea158(0x154)](_0x318d9)[0x0];showPriceModal(_0x5dc2f3);}}function handleTxtImport(_0x378366){const _0x50b53a=_0x5ac6a5,_0x20e7ae=_0x378366[_0x50b53a(0x16c)]('\x0a');let _0x16a7a4={};if(currentDatabase===_0x50b53a(0x1b6)){const _0x4da0fd=/add name="([^"]+)" password="([^"]+)" profile="([^"]+)"/;for(let _0x3a5fa4 of _0x20e7ae){_0x3a5fa4=_0x3a5fa4['trim']();if(!_0x3a5fa4||_0x3a5fa4===_0x50b53a(0x11c))continue;const _0xe27a2d=_0x3a5fa4[_0x50b53a(0x18d)](_0x4da0fd);if(_0xe27a2d){const [_0x512259,_0x55b9c7,_0x5ba180,_0x5f26a4]=_0xe27a2d,_0x2c465b='id-'+Date['now']()+'-'+Math[_0x50b53a(0x149)](Math[_0x50b53a(0x123)]()*0x3e8);_0x16a7a4[_0x2c465b]={'id':_0x2c465b,'category':_0x5f26a4,'password':_0x5ba180,'price':'','user':_0x55b9c7};}}tempImportData={'tickets':_0x16a7a4},tempCategory=_0x50b53a(0x1b6),showPriceModal(_0x50b53a(0x1a9));}else{const _0x813d1e=/add name="([^"]+)" password="([^"]+)" profile="([^"]+)"/;for(let _0x19a086 of _0x20e7ae){_0x19a086=_0x19a086['trim']();if(!_0x19a086||_0x19a086==='/ip\x20hotspot\x20user')continue;const _0x1bfbef=_0x19a086['match'](_0x813d1e);if(_0x1bfbef){const [_0x17a494,_0x2c15cf,_0x3f92a9,_0x500dee]=_0x1bfbef;!_0x16a7a4[_0x500dee]&&(_0x16a7a4[_0x500dee]={'motDePasse':[],'prix':[],'utilisateur':[]}),_0x16a7a4[_0x500dee][_0x50b53a(0x183)][_0x50b53a(0x11f)](_0x2c15cf),_0x16a7a4[_0x500dee][_0x50b53a(0x16b)][_0x50b53a(0x11f)](_0x3f92a9);}}if(Object[_0x50b53a(0x154)](_0x16a7a4)[_0x50b53a(0x19b)]===0x0){hideLoading(),alert(_0x50b53a(0x166));return;}tempImportData=_0x16a7a4;const _0x17aaa3=Object[_0x50b53a(0x154)](_0x16a7a4)[0x0];showPriceModal(_0x17aaa3);}}function showPriceModal(_0x29c6f4){const _0x509e08=_0x5ac6a5;tempCategory=_0x29c6f4,document[_0x509e08(0x111)](_0x509e08(0x1c6))[_0x509e08(0x1b4)]=_0x29c6f4,document[_0x509e08(0x111)](_0x509e08(0x178))['style'][_0x509e08(0x191)]='block',document['getElementById']('priceInput')[_0x509e08(0x19e)]='';}function confirmPrice(){const _0x5c5f91=_0x5ac6a5,_0x2f1586=document[_0x5c5f91(0x111)](_0x5c5f91(0x137))[_0x5c5f91(0x19e)][_0x5c5f91(0x116)]();if(!_0x2f1586){alert(_0x5c5f91(0x184));return;}if(currentDatabase===_0x5c5f91(0x1b6)){for(let _0x489220 in tempImportData['tickets']){tempImportData['tickets'][_0x489220][_0x5c5f91(0x14e)]=_0x2f1586;}finishImport();}else{tempImportData[tempCategory][_0x5c5f91(0x15e)]=Array(tempImportData[tempCategory][_0x5c5f91(0x16b)]['length'])[_0x5c5f91(0x19d)](_0x2f1586);const _0x3af8dc=Object[_0x5c5f91(0x154)](tempImportData),_0x2bfb27=_0x3af8dc[_0x5c5f91(0x164)](tempCategory);_0x2bfb27<_0x3af8dc['length']-0x1?(document[_0x5c5f91(0x111)](_0x5c5f91(0x137))[_0x5c5f91(0x19e)]='',showPriceModal(_0x3af8dc[_0x2bfb27+0x1])):finishImport();}}function cancelImport(){const _0x399073=_0x5ac6a5;document[_0x399073(0x111)](_0x399073(0x178))[_0x399073(0x105)][_0x399073(0x191)]=_0x399073(0x13e),currentDatabase==='TicketsTransit'&&(tempImportData=null),document[_0x399073(0x111)](_0x399073(0x152))[_0x399073(0x19e)]='',tempCategory=null,hideLoading();}async function finishImport(){const _0x4586e8=_0x5ac6a5,_0x490d82=sessionStorage['getItem'](_0x4586e8(0x18a));if(!_0x490d82){alert(_0x4586e8(0x14a));return;}if(confirm('Êtes-vous\x20sûr\x20de\x20vouloir\x20importer\x20ces\x20tickets\x20?\x20Les\x20nouveaux\x20tickets\x20seront\x20ajoutés\x20aux\x20tickets\x20existants.')){showLoading(),await initializeDatabase();(!allTickets||Object[_0x4586e8(0x154)](allTickets)[_0x4586e8(0x19b)]===0x0)&&(allTickets=currentDatabase===_0x4586e8(0x1b6)?{}:{});const _0x433491={};if(currentDatabase===_0x4586e8(0x1b6))for(let _0x59cb92 in tempImportData[_0x4586e8(0x15d)]){_0x433491[_0x4586e8(0x131)+_0x490d82+'/'+currentDatabase+'/'+_0x59cb92]=tempImportData[_0x4586e8(0x15d)][_0x59cb92];}else for(let _0x35aed0 in tempImportData){allTickets[_0x35aed0]?_0x433491[_0x4586e8(0x131)+_0x490d82+'/'+currentDatabase+'/'+_0x35aed0]={'motDePasse':[...allTickets[_0x35aed0][_0x4586e8(0x16b)],...tempImportData[_0x35aed0]['motDePasse']],'prix':[...allTickets[_0x35aed0][_0x4586e8(0x15e)],...tempImportData[_0x35aed0][_0x4586e8(0x15e)]],'utilisateur':[...allTickets[_0x35aed0][_0x4586e8(0x183)],...tempImportData[_0x35aed0]['utilisateur']]}:_0x433491[_0x4586e8(0x131)+_0x490d82+'/'+currentDatabase+'/'+_0x35aed0]=tempImportData[_0x35aed0];}update(ref(db),_0x433491)[_0x4586e8(0x1a5)](()=>{const _0x3b9ebd=_0x4586e8;document['getElementById'](_0x3b9ebd(0x178))['style'][_0x3b9ebd(0x191)]=_0x3b9ebd(0x13e),document['getElementById'](_0x3b9ebd(0x152))[_0x3b9ebd(0x19e)]='',tempImportData=null,tempCategory=null,hideLoading(),alert('Importation\x20réussie\x20!');})[_0x4586e8(0x162)](_0x44445b=>{const _0x487cee=_0x4586e8;console[_0x487cee(0x1b7)](_0x487cee(0x10a),_0x44445b),hideLoading(),alert('Erreur\x20lors\x20de\x20l\x27importation.\x20Veuillez\x20réessayer.');});}else cancelImport();}function importTickets(_0x5b0103){const _0x148584=_0x5ac6a5,_0x1e58e0=_0x5b0103[_0x148584(0x1c8)]['files'][0x0];if(!_0x1e58e0)return;showLoading();const _0x3d7e8c=new FileReader();_0x3d7e8c[_0x148584(0x120)]=function(_0x278918){const _0x4752a2=_0x148584;try{const _0x1ada0b=_0x1e58e0[_0x4752a2(0x190)][_0x4752a2(0x16c)]('.')[_0x4752a2(0x196)]()['toLowerCase']();if(_0x1ada0b===_0x4752a2(0x17d))handleJsonImport(_0x278918[_0x4752a2(0x1c8)][_0x4752a2(0x133)]);else{if(_0x1ada0b===_0x4752a2(0x136))handleCsvImport(_0x278918[_0x4752a2(0x1c8)][_0x4752a2(0x133)]);else{if(_0x1ada0b==='txt')handleTxtImport(_0x278918[_0x4752a2(0x1c8)][_0x4752a2(0x133)]);else throw new Error(_0x4752a2(0x151));}}}catch(_0x246c5c){console[_0x4752a2(0x1b7)]('Erreur\x20d\x27importation:',_0x246c5c),hideLoading(),alert(_0x4752a2(0x187));}},_0x3d7e8c['readAsText'](_0x1e58e0);}async function deleteSearchResults(){const _0x33e8d2=_0x5ac6a5,_0x7fe84e=document[_0x33e8d2(0x111)]('searchBar')[_0x33e8d2(0x19e)][_0x33e8d2(0x116)](),_0x49d929=sessionStorage['getItem'](_0x33e8d2(0x18a));if(!_0x7fe84e||!_0x49d929){alert(_0x33e8d2(0x1ba));return;}if(confirm(_0x33e8d2(0x11a))){showLoading(),await initializeDatabase();const _0x5cce0d={};if(currentDatabase===_0x33e8d2(0x1b6))for(let _0x1e7773 in allTickets){matchesSearchTransit(allTickets[_0x1e7773],_0x7fe84e)&&(_0x5cce0d[_0x33e8d2(0x131)+_0x49d929+'/'+currentDatabase+'/'+_0x1e7773]=null);}else for(let _0x25422d in allTickets){const _0x3f6b97=allTickets[_0x25422d],_0x58521d={'motDePasse':[],'prix':[],'utilisateur':[]};for(let _0x3a4734=0x0;_0x3a4734<_0x3f6b97[_0x33e8d2(0x16b)]['length'];_0x3a4734++){!matchesSearchTotal(_0x3f6b97,_0x3a4734,_0x7fe84e)&&(_0x58521d[_0x33e8d2(0x16b)]['push'](_0x3f6b97[_0x33e8d2(0x16b)][_0x3a4734]),_0x58521d[_0x33e8d2(0x15e)]['push'](_0x3f6b97[_0x33e8d2(0x15e)][_0x3a4734]),_0x58521d[_0x33e8d2(0x183)][_0x33e8d2(0x11f)](_0x3f6b97[_0x33e8d2(0x183)][_0x3a4734]));}_0x5cce0d[_0x33e8d2(0x131)+_0x49d929+'/'+currentDatabase+'/'+_0x25422d]=_0x58521d;}update(ref(db),_0x5cce0d)['then'](()=>{const _0x3edc22=_0x33e8d2;hideLoading(),alert(_0x3edc22(0x1c2));})[_0x33e8d2(0x162)](_0x296dcf=>{const _0x3b58b9=_0x33e8d2;console[_0x3b58b9(0x1b7)](_0x3b58b9(0x147),_0x296dcf),hideLoading(),alert('Erreur\x20lors\x20de\x20la\x20suppression\x20des\x20résultats\x20de\x20recherche.\x20Veuillez\x20réessayer.');});}}function searchTickets(){const _0xb81af9=_0x5ac6a5,_0x4758e0=document[_0xb81af9(0x111)](_0xb81af9(0x10c))[_0xb81af9(0x19e)]['trim']();displayTickets(allTickets,_0x4758e0);}function changeDatabase(){const _0x43b3ce=_0x5ac6a5;currentDatabase=document['getElementById'](_0x43b3ce(0x122))[_0x43b3ce(0x19e)],updateImportFileAccept(),loadTickets();}function updateImportFileAccept(){const _0x5c4bd6=_0x5ac6a5,_0x4a3a3d=document[_0x5c4bd6(0x111)](_0x5c4bd6(0x152));currentDatabase==='TicketsTransit'?_0x4a3a3d[_0x5c4bd6(0xfe)]=_0x5c4bd6(0x177):_0x4a3a3d[_0x5c4bd6(0xfe)]=_0x5c4bd6(0x15f);}window[_0x5ac6a5(0x1ae)]=editCategory,window[_0x5ac6a5(0x17a)]=showAddTicketModal,window[_0x5ac6a5(0x102)]=deleteAllTicketsInCategory,window[_0x5ac6a5(0x132)]=editSelectedTickets,window[_0x5ac6a5(0x1a7)]=deleteSelectedTickets,window[_0x5ac6a5(0x1b8)]=editTicketTotal,window[_0x5ac6a5(0x163)]=editTicketTransit,window[_0x5ac6a5(0x17c)]=saveTicketEdit,window[_0x5ac6a5(0x175)]=saveCategoryEdit,window[_0x5ac6a5(0x1a8)]=saveNewTicket,window[_0x5ac6a5(0x176)]=closeEditModal,window['closeEditCategoryModal']=closeEditCategoryModal,window[_0x5ac6a5(0x117)]=closeAddTicketModal,window[_0x5ac6a5(0x1c4)]=exportTickets,window[_0x5ac6a5(0x121)]=exportFilteredTickets,window['confirmPrice']=confirmPrice,window[_0x5ac6a5(0x143)]=cancelImport,window[_0x5ac6a5(0x1be)]=deleteSearchResults,window[_0x5ac6a5(0x145)]=searchTickets,window['changeDatabase']=changeDatabase,window[_0x5ac6a5(0x180)]=logout,window[_0x5ac6a5(0x12b)]=importTickets,window[_0x5ac6a5(0x159)]=saveBulkEdit,window[_0x5ac6a5(0x1a4)]=closeBulkEditModal,window[_0x5ac6a5(0x120)]=async()=>{await initializeDatabase(),await checkLoginStatus(),updateImportFileAccept(),loadTickets();},document['getElementById'](_0x5ac6a5(0x10c))['addEventListener'](_0x5ac6a5(0x12e),searchTickets),window[_0x5ac6a5(0x120)]=async()=>{await initializeDatabase(),await checkLoginStatus(),loadTickets();};
    </script>

</body>
</html>