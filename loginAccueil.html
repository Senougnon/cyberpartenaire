
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connexion / Inscription Administrateur</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        /* Style pour le formulaire de connexion et d'inscription */
        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: #fff;
            background: linear-gradient(135deg, #1a2a6c, #fdbb2d);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            padding: 0;
        }

        .login-container {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 400px;
            text-align: center;
            color: #333;
        }

        h1 {
            text-align: center;
            color: #1a2a6c;
            margin-bottom: 2rem;
            font-size: 2rem;
        }

        .input-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            text-align: left;
            color: #333;
        }

        input {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        input:focus {
            outline: none;
            border-color: #1a2a6c;
        }

        button {
            width: 100%;
            padding: 1rem;
            background-color: #1a2a6c;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 0.5rem; /* Add some spacing between buttons */
        }

        button:hover {
            background-color: #0e1639;
        }

        .error-message {
            color: #e74c3c;
            text-align: center;
            margin-top: 1rem;
            display: none; /* Hide by default */
        }

        .form-switcher {
            margin-top: 1rem;
            text-align: center;
            color: #333;
        }

        .form-switcher a {
            color: #1a2a6c;
            text-decoration: none;
            font-weight: bold;
        }

        /* Media query pour les écrans plus petits (smartphones) */
        @media (max-width: 600px) {
            .login-container {
                padding: 1.5rem;
                max-width: 90%;
            }

            h1 {
                font-size: 1.8rem;
                margin-bottom: 1.5rem;
            }

            input {
                padding: 0.6rem;
                font-size: 0.9rem;
            }

            button {
                padding: 0.8rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="login-container">
        <h1>Connexion / Inscription Administrateur</h1>

        <!-- Formulaire de connexion -->
        <form id="loginForm">
            <div class="input-group">
                <label for="username">Nom d'utilisateur</label>
                <input type="text" id="username" required>
            </div>
            <div class="input-group">
                <label for="password">Mot de passe</label>
                <input type="password" id="password" required>
            </div>
            <button type="submit">Se connecter</button>
            <div class="form-switcher">
                Pas encore de compte ? <a href="#" id="switchToSignup">S'inscrire</a>
            </div>
        </form>


        <!-- Formulaire d'inscription -->
        <form id="signupForm" style="display: none;">
            <div class="input-group">
                <label for="signupUsername">Nom d'utilisateur</label>
                <input type="text" id="signupUsername" required>
            </div>
            <div class="input-group">
                <label for="signupPassword">Mot de passe</label>
                <input type="password" id="signupPassword" required>
            </div>
            <button type="submit">S'inscrire</button>
            <div class="form-switcher">
                Déjà un compte ? <a href="#" id="switchToLogin">Se connecter</a>
            </div>
        </form>

        <div id="errorMessage" class="error-message"></div>
    </div>

    <script type="module">
const _0x305136=_0x536c;function _0x536c(_0x4b0b06,_0x22f245){const _0x44bec9=_0x44be();return _0x536c=function(_0x536c8f,_0x16e426){_0x536c8f=_0x536c8f-0xbb;let _0x1c7f3c=_0x44bec9[_0x536c8f];return _0x1c7f3c;},_0x536c(_0x4b0b06,_0x22f245);}(function(_0x329acb,_0xacc851){const _0x4b57fd=_0x536c,_0x2923b7=_0x329acb();while(!![]){try{const _0xf38c81=-parseInt(_0x4b57fd(0xed))/0x1+-parseInt(_0x4b57fd(0xd4))/0x2*(-parseInt(_0x4b57fd(0xdc))/0x3)+-parseInt(_0x4b57fd(0xdb))/0x4*(parseInt(_0x4b57fd(0xbf))/0x5)+-parseInt(_0x4b57fd(0xf0))/0x6*(-parseInt(_0x4b57fd(0xc8))/0x7)+parseInt(_0x4b57fd(0xd3))/0x8*(-parseInt(_0x4b57fd(0xbd))/0x9)+-parseInt(_0x4b57fd(0xea))/0xa*(-parseInt(_0x4b57fd(0xc3))/0xb)+parseInt(_0x4b57fd(0xca))/0xc*(parseInt(_0x4b57fd(0xcb))/0xd);if(_0xf38c81===_0xacc851)break;else _0x2923b7['push'](_0x2923b7['shift']());}catch(_0x5f3f1f){_0x2923b7['push'](_0x2923b7['shift']());}}}(_0x44be,0x65cf8));import{getActiveDatabase}from'./firebase-config-manager.js';import{ref,get,set,push,update}from'https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js';let db;async function initializeDatabase(){const _0x136c08=_0x536c;try{db=await getActiveDatabase(),console[_0x136c08(0xdd)](_0x136c08(0xe5));}catch(_0x2a2b66){console[_0x136c08(0xc4)]('Database\x20initialization\x20failed:',_0x2a2b66),displayError('Erreur\x20lors\x20de\x20la\x20connexion\x20à\x20la\x20base\x20de\x20données.');}}function displayError(_0x4c9433){const _0x3ef6e5=_0x536c,_0x30d1ac=document[_0x3ef6e5(0xd6)](_0x3ef6e5(0xda));_0x30d1ac[_0x3ef6e5(0xcf)]=_0x4c9433,_0x30d1ac[_0x3ef6e5(0xf1)][_0x3ef6e5(0xc9)]=_0x3ef6e5(0xe7);}function _0x44be(){const _0x504f28=['Une\x20erreur\x20est\x20survenue.\x20Veuillez\x20réessayer.','2845572AtIRjL','style','addEventListener','preventDefault','1734066PmpGIK','DOMContentLoaded','6195pXzVJR','trim','href','val','8857189tnuHfE','error','users','signupUsername','signupPassword','7gzRwUT','display','96cEOMZW','127153DWqtnf','setItem','users/','switchToSignup','textContent','login','keys','password','8gQqvjj','528NallQY','username','getElementById','Erreur\x20lors\x20de\x20l\x27inscription:','submit','click','errorMessage','1620jVBHMF','5628kINPuH','log','Base\x20de\x20données\x20non\x20initialisée.\x20Veuillez\x20réessayer.','users-data/','Ce\x20nom\x20d\x27utilisateur\x20existe\x20déjà.','inactive','currentUserId','signupForm','loginForm','Database\x20initialized\x20in\x20loginAccueil.html','includes','block','value','Nom\x20d\x20utilisateur\x20ou\x20mot\x20de\x20passe\x20incorrect.','10dcMbjp','isLoggedIn','Erreur\x20lors\x20de\x20l\x27inscription.','741488ACcamY','none'];_0x44be=function(){return _0x504f28;};return _0x44be();}async function signup(_0x38f5f6){const _0xd2732c=_0x536c;_0x38f5f6['preventDefault']();if(!db){displayError(_0xd2732c(0xde));return;}const _0x59840b=document[_0xd2732c(0xd6)](_0xd2732c(0xc6))['value'][_0xd2732c(0xc0)](),_0x4b6d69=document[_0xd2732c(0xd6)](_0xd2732c(0xc7))[_0xd2732c(0xe8)][_0xd2732c(0xc0)]();if(!_0x59840b||!_0x4b6d69){displayError('Veuillez\x20remplir\x20tous\x20les\x20champs.');return;}try{const _0x4f913f=ref(db,_0xd2732c(0xc5)),_0x24ecc4=await get(_0x4f913f),_0x437e62=_0x24ecc4[_0xd2732c(0xc2)]();if(_0x437e62&&Object[_0xd2732c(0xd1)](_0x437e62)[_0xd2732c(0xe6)](_0x59840b)){displayError(_0xd2732c(0xe0));return;}const _0x4121ad=ref(db,'users/'+_0x59840b);await set(_0x4121ad,{'password':_0x4b6d69});const _0x3f5044=ref(db,_0xd2732c(0xdf)+_0x59840b);await set(_0x3f5044,{'admin':{'subscription':{'status':_0xd2732c(0xe1)}},'TicketsTotal':{},'TicketsVendus':{},'TicketsTransit':{},'TicketConnecté':{},'Vendors':{},'VendorsHistory':{},'sales':{}}),alert('Inscription\x20réussie\x20!\x20Vous\x20pouvez\x20maintenant\x20vous\x20connecter.'),switchForm('login');}catch(_0x3f3320){console['error'](_0xd2732c(0xd7),_0x3f3320),displayError(_0xd2732c(0xec));}}async function login(_0x5e6142){const _0x147e3e=_0x536c;_0x5e6142[_0x147e3e(0xbc)]();if(!db){displayError(_0x147e3e(0xde));return;}const _0x4289a1=document[_0x147e3e(0xd6)](_0x147e3e(0xd5))['value'][_0x147e3e(0xc0)](),_0x4c4103=document[_0x147e3e(0xd6)](_0x147e3e(0xd2))['value'][_0x147e3e(0xc0)]();if(!_0x4289a1||!_0x4c4103){displayError('Veuillez\x20remplir\x20tous\x20les\x20champs.');return;}try{const _0x2ba33f=ref(db,_0x147e3e(0xcd)+_0x4289a1),_0x44caa6=await get(_0x2ba33f);if(_0x44caa6['exists']()){const _0x18364b=_0x44caa6[_0x147e3e(0xc2)]();_0x18364b[_0x147e3e(0xd2)]===_0x4c4103?(sessionStorage[_0x147e3e(0xcc)](_0x147e3e(0xeb),'true'),sessionStorage['setItem'](_0x147e3e(0xe2),_0x4289a1),window['location'][_0x147e3e(0xc1)]='index.html'):displayError(_0x147e3e(0xe9));}else displayError('Nom\x20d\x20utilisateur\x20ou\x20mot\x20de\x20passe\x20incorrect.');}catch(_0x3282a8){console[_0x147e3e(0xc4)]('Erreur\x20de\x20connexion:',_0x3282a8),displayError(_0x147e3e(0xef));}}function switchForm(_0x5ce136){const _0x5d2968=_0x536c,_0x73228b=document[_0x5d2968(0xd6)](_0x5d2968(0xe4)),_0x1ae1b5=document[_0x5d2968(0xd6)](_0x5d2968(0xe3));_0x5ce136===_0x5d2968(0xd0)?(_0x73228b[_0x5d2968(0xf1)][_0x5d2968(0xc9)]=_0x5d2968(0xe7),_0x1ae1b5['style'][_0x5d2968(0xc9)]=_0x5d2968(0xee)):(_0x73228b['style'][_0x5d2968(0xc9)]=_0x5d2968(0xee),_0x1ae1b5[_0x5d2968(0xf1)][_0x5d2968(0xc9)]=_0x5d2968(0xe7));}document[_0x305136(0xbb)](_0x305136(0xbe),async()=>{const _0x360803=_0x305136;await initializeDatabase(),document[_0x360803(0xd6)]('loginForm')[_0x360803(0xbb)](_0x360803(0xd8),login),document[_0x360803(0xd6)](_0x360803(0xe3))[_0x360803(0xbb)](_0x360803(0xd8),signup),document[_0x360803(0xd6)](_0x360803(0xce))['addEventListener'](_0x360803(0xd9),()=>switchForm('signup')),document['getElementById']('switchToLogin')[_0x360803(0xbb)]('click',()=>switchForm(_0x360803(0xd0)));});
    </script>
</body>
</html>