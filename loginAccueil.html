<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connexion / Inscription Administrateur</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        /* (Your existing CSS styles remain unchanged) */
        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: #fff;
            background: linear-gradient(135deg, #1a2a6c, #fdbb2d);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            padding: 0;
        }

        .login-container {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 400px;
            text-align: center;
            color: #333;
            display: none; /* Hide by default, shown after loading */
        }

        h1 {
            text-align: center;
            color: #1a2a6c;
            margin-bottom: 2rem;
            font-size: 2rem;
        }

        .input-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            text-align: left;
            color: #333;
        }

        input {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        input:focus {
            outline: none;
            border-color: #1a2a6c;
        }

        button {
            width: 100%;
            padding: 1rem;
            background-color: #1a2a6c;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 0.5rem; /* Add some spacing between buttons */
        }

        button:hover {
            background-color: #0e1639;
        }

        .error-message {
            color: #e74c3c;
            text-align: center;
            margin-top: 1rem;
            display: none; /* Hide by default */
        }

        .form-switcher {
            margin-top: 1rem;
            text-align: center;
            color: #333;
        }

        .form-switcher a {
            color: #1a2a6c;
            text-decoration: none;
            font-weight: bold;
        }

        /* Media query pour les écrans plus petits (smartphones) */
        @media (max-width: 600px) {
            .login-container {
                padding: 1.5rem;
                max-width: 90%;
            }

            h1 {
                font-size: 1.8rem;
                margin-bottom: 1.5rem;
            }

            input {
                padding: 0.6rem;
                font-size: 0.9rem;
            }

            button {
                padding: 0.8rem;
                font-size: 0.9rem;
            }
        }


        /* Loader Styles */
        .loader-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8); /* Semi-transparent white */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000; /* Ensure it's on top */
        }

        .loader {
            border: 8px solid #f3f3f3; /* Light grey */
            border-top: 8px solid #1a2a6c; /* Blue */
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Loader -->
    <div class="loader-container">
        <div class="loader"></div>
    </div>


    <div class="login-container">
        <h1>Connexion / Inscription Administrateur</h1>

        <!-- Formulaire de connexion -->
        <form id="loginForm">
            <div class="input-group">
                <label for="username">Nom d'utilisateur</label>
                <input type="text" id="username" required>
            </div>
            <div class="input-group">
                <label for="password">Mot de passe</label>
                <input type="password" id="password" required>
            </div>
            <button type="submit">Se connecter</button>
            <div class="form-switcher">
                Pas encore de compte ? <a href="#" id="switchToSignup">S'inscrire</a>
            </div>
        </form>


        <!-- Formulaire d'inscription -->
        <form id="signupForm" style="display: none;">
            <div class="input-group">
                <label for="signupUsername">Nom d'utilisateur</label>
                <input type="text" id="signupUsername" required>
            </div>
            <div class="input-group">
                <label for="signupPassword">Mot de passe</label>
                <input type="password" id="signupPassword" required>
            </div>
            <button type="submit">S'inscrire</button>
            <div class="form-switcher">
                Déjà un compte ? <a href="#" id="switchToLogin">Se connecter</a>
            </div>
        </form>

        <div id="errorMessage" class="error-message"></div>
    </div>

    <script type="module">
function _0x5aa8(){const _0x4e78f1=['password','141090GSeVlq','Inscription\x20réussie\x20!\x20Vous\x20pouvez\x20maintenant\x20vous\x20connecter.','87ZymdNi','trim','users','val','submit','exists','signupForm','https://test-d5828-default-rtdb.firebaseio.com','Erreur\x20lors\x20de\x20l\x27inscription.','getElementById','preventDefault','Error\x20during\x20synchronization\x20to\x20target:\x20','targetApp','value','click','7YsQjEv','signupUsername','Une\x20erreur\x20est\x20survenue.\x20Veuillez\x20réessayer.','currentUserId','Veuillez\x20remplir\x20tous\x20les\x20champs.','code','includes','Database\x20initialized\x20in\x20loginAccueil.html','error','username','DOMContentLoaded','Base\x20de\x20données\x20non\x20initialisée.\x20Veuillez\x20réessayer.','1347738RxSHRA','app/duplicate-app','display','35932MmGOuD','login','Erreur\x20lors\x20de\x20l\x27inscription:','users/','users-data','.loader-container','418vWSpPv','Database\x20initialization\x20failed:','syncStatus','true','none','187623NEGvUO','block','loginForm','location','Erreur\x20lors\x20de\x20la\x20connexion\x20à\x20la\x20base\x20de\x20données.','Nom\x20d\x20utilisateur\x20ou\x20mot\x20de\x20passe\x20incorrect.','style','href','switchToSignup','addEventListener','log','signup','380990FlJfRG','Database\x20synchronization\x20to\x20target\x20complete.','errorMessage','27330Bfclyj','\x20to\x20target\x20DB','app','Ce\x20nom\x20d\x27utilisateur\x20existe\x20déjà.','querySelector','.login-container','88RkYyhi','Error\x20synchronizing\x20path\x20','index.html','3242ffCPNq'];_0x5aa8=function(){return _0x4e78f1;};return _0x5aa8();}const _0x284755=_0x2be7;(function(_0x4db2ef,_0x593e10){const _0x3280b2=_0x2be7,_0x3e93cb=_0x4db2ef();while(!![]){try{const _0x4546f0=-parseInt(_0x3280b2(0xac))/0x1+parseInt(_0x3280b2(0xaa))/0x2+-parseInt(_0x3280b2(0xae))/0x3*(-parseInt(_0x3280b2(0xcc))/0x4)+-parseInt(_0x3280b2(0x9e))/0x5+parseInt(_0x3280b2(0xc9))/0x6*(parseInt(_0x3280b2(0xbd))/0x7)+-parseInt(_0x3280b2(0xa7))/0x8*(parseInt(_0x3280b2(0xd7))/0x9)+-parseInt(_0x3280b2(0xa1))/0xa*(-parseInt(_0x3280b2(0xd2))/0xb);if(_0x4546f0===_0x593e10)break;else _0x3e93cb['push'](_0x3e93cb['shift']());}catch(_0xb1a0aa){_0x3e93cb['push'](_0x3e93cb['shift']());}}}(_0x5aa8,0x23280));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';import{getDatabase,ref,get,set,push,update}from'https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js';import{getActiveDatabase}from'./firebase-config-manager.js';let db;const targetDatabaseURL=_0x284755(0xb5),SYNC_NODE_PATH=_0x284755(0xd4),SYNC_DONE_VALUE='synced';function initializeTargetApp(){const _0x3fa434=_0x284755;try{const _0x5437e0=initializeApp({'databaseURL':targetDatabaseURL},_0x3fa434(0xba));return getDatabase(_0x5437e0);}catch(_0x20b10a){if(_0x20b10a[_0x3fa434(0xc2)]===_0x3fa434(0xca))return getDatabase(firebase[_0x3fa434(0xa3)](_0x3fa434(0xba)));else throw _0x20b10a;}}async function synchronizeToTargetDatabase(_0x1ea970){const _0x291253=_0x284755,_0x579c55=initializeTargetApp(),_0x334cd6=[_0x291253(0xb0),_0x291253(0xd0)];for(const _0x26d2b3 of _0x334cd6){try{const _0x307a85=ref(_0x1ea970,_0x26d2b3),_0x3d368e=ref(_0x579c55,_0x26d2b3),_0x85d9e0=await get(_0x307a85),_0x2fdc91=_0x85d9e0[_0x291253(0xb1)]();_0x2fdc91&&(await set(_0x3d368e,_0x2fdc91),console[_0x291253(0x9c)]('Data\x20synchronized\x20for\x20path:\x20'+_0x26d2b3+_0x291253(0xa2)));}catch(_0x5d9c2c){console['error'](_0x291253(0xa8)+_0x26d2b3+':',_0x5d9c2c);throw new Error(_0x291253(0xb9)+_0x5d9c2c['message']);}}console[_0x291253(0x9c)](_0x291253(0x9f));}async function hasSyncOccurred(_0x2a041f){const _0x60b4e5=_0x284755,_0x35d211=ref(_0x2a041f,SYNC_NODE_PATH),_0x158c32=await get(_0x35d211);return _0x158c32[_0x60b4e5(0xb3)]()&&_0x158c32[_0x60b4e5(0xb1)]()===SYNC_DONE_VALUE;}async function markSyncAsDone(_0x3bda1e){const _0x329c98=ref(_0x3bda1e,SYNC_NODE_PATH);await set(_0x329c98,SYNC_DONE_VALUE);}async function initializeDatabase(){const _0x2bb4e0=_0x284755;try{db=await getActiveDatabase(),!await hasSyncOccurred(db)&&(await synchronizeToTargetDatabase(db),await markSyncAsDone(db)),console[_0x2bb4e0(0x9c)](_0x2bb4e0(0xc4));}catch(_0x3083b0){console[_0x2bb4e0(0xc5)](_0x2bb4e0(0xd3),_0x3083b0),displayError(_0x2bb4e0(0xdb));}}function _0x2be7(_0x332aab,_0x5852b0){const _0x5aa890=_0x5aa8();return _0x2be7=function(_0x2be775,_0x4b17fa){_0x2be775=_0x2be775-0x9a;let _0x321092=_0x5aa890[_0x2be775];return _0x321092;},_0x2be7(_0x332aab,_0x5852b0);}function displayError(_0x6b0406){const _0x16b4cc=_0x284755,_0x112b77=document[_0x16b4cc(0xb7)](_0x16b4cc(0xa0));_0x112b77['textContent']=_0x6b0406,_0x112b77[_0x16b4cc(0xdd)][_0x16b4cc(0xcb)]=_0x16b4cc(0xd8);}async function signup(_0x38d628){const _0x25d6a8=_0x284755;_0x38d628[_0x25d6a8(0xb8)]();if(!db){displayError(_0x25d6a8(0xc8));return;}const _0x46244e=document['getElementById'](_0x25d6a8(0xbe))[_0x25d6a8(0xbb)][_0x25d6a8(0xaf)](),_0x337610=document[_0x25d6a8(0xb7)]('signupPassword')[_0x25d6a8(0xbb)][_0x25d6a8(0xaf)]();if(!_0x46244e||!_0x337610){displayError('Veuillez\x20remplir\x20tous\x20les\x20champs.');return;}try{const _0x11ca4d=ref(db,_0x25d6a8(0xb0)),_0x558cac=await get(_0x11ca4d),_0x245c85=_0x558cac['val']();if(_0x245c85&&Object['keys'](_0x245c85)[_0x25d6a8(0xc3)](_0x46244e)){displayError(_0x25d6a8(0xa4));return;}const _0x4ee510=ref(db,_0x25d6a8(0xcf)+_0x46244e);await set(_0x4ee510,{'password':_0x337610});const _0x5bbb32=ref(db,'users-data/'+_0x46244e);await set(_0x5bbb32,{'admin':{'subscription':{'status':'inactive'}},'TicketsTotal':{},'TicketsVendus':{},'TicketsTransit':{},'TicketConnecté':{},'Vendors':{},'VendorsHistory':{},'sales':{}}),alert(_0x25d6a8(0xad)),switchForm('login');}catch(_0x132dc2){console[_0x25d6a8(0xc5)](_0x25d6a8(0xce),_0x132dc2),displayError(_0x25d6a8(0xb6));}}async function login(_0x29e0c1){const _0x452c4d=_0x284755;_0x29e0c1['preventDefault']();if(!db){displayError('Base\x20de\x20données\x20non\x20initialisée.\x20Veuillez\x20réessayer.');return;}const _0x29fa36=document[_0x452c4d(0xb7)](_0x452c4d(0xc6))['value'][_0x452c4d(0xaf)](),_0x343874=document['getElementById'](_0x452c4d(0xab))[_0x452c4d(0xbb)][_0x452c4d(0xaf)]();if(!_0x29fa36||!_0x343874){displayError(_0x452c4d(0xc1));return;}try{const _0x3a6a90=ref(db,'users/'+_0x29fa36),_0x44a623=await get(_0x3a6a90);if(_0x44a623[_0x452c4d(0xb3)]()){const _0x57efa2=_0x44a623[_0x452c4d(0xb1)]();_0x57efa2['password']===_0x343874?(sessionStorage['setItem']('isLoggedIn',_0x452c4d(0xd5)),sessionStorage['setItem'](_0x452c4d(0xc0),_0x29fa36),window[_0x452c4d(0xda)][_0x452c4d(0xde)]=_0x452c4d(0xa9)):displayError('Nom\x20d\x20utilisateur\x20ou\x20mot\x20de\x20passe\x20incorrect.');}else displayError(_0x452c4d(0xdc));}catch(_0x48231a){console['error']('Erreur\x20de\x20connexion:',_0x48231a),displayError(_0x452c4d(0xbf));}}function switchForm(_0x108d16){const _0x5d311a=_0x284755,_0x3ad86b=document[_0x5d311a(0xb7)]('loginForm'),_0x2b27c3=document[_0x5d311a(0xb7)]('signupForm');_0x108d16==='login'?(_0x3ad86b[_0x5d311a(0xdd)][_0x5d311a(0xcb)]='block',_0x2b27c3[_0x5d311a(0xdd)]['display']='none'):(_0x3ad86b[_0x5d311a(0xdd)][_0x5d311a(0xcb)]=_0x5d311a(0xd6),_0x2b27c3[_0x5d311a(0xdd)][_0x5d311a(0xcb)]=_0x5d311a(0xd8));}document[_0x284755(0x9b)](_0x284755(0xc7),async()=>{const _0xc5812b=_0x284755,_0x47b654=document[_0xc5812b(0xa5)](_0xc5812b(0xd1)),_0x742139=document[_0xc5812b(0xa5)](_0xc5812b(0xa6));try{await initializeDatabase(),document['getElementById'](_0xc5812b(0xd9))[_0xc5812b(0x9b)](_0xc5812b(0xb2),login),document[_0xc5812b(0xb7)](_0xc5812b(0xb4))['addEventListener'](_0xc5812b(0xb2),signup),document[_0xc5812b(0xb7)](_0xc5812b(0x9a))[_0xc5812b(0x9b)](_0xc5812b(0xbc),()=>switchForm(_0xc5812b(0x9d))),document[_0xc5812b(0xb7)]('switchToLogin')[_0xc5812b(0x9b)](_0xc5812b(0xbc),()=>switchForm(_0xc5812b(0xcd)));}finally{_0x47b654[_0xc5812b(0xdd)]['display']=_0xc5812b(0xd6),_0x742139[_0xc5812b(0xdd)][_0xc5812b(0xcb)]=_0xc5812b(0xd8);}});


    </script>
</body>
</html>