<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMIN WIFI ZONE</title>
    <link rel="stylesheet" href="styleA.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
    <script src="https://cdn.fedapay.com/checkout.js?v=1.1.7"></script>

    <style>
        /* ... (Styles CSS - Pas de modifications majeures, juste des ajustements pour le formulaire) ... */
       /* Style pour le modal de paiement */
       .payment-modal {
           display: none;
           position: fixed;
           top: 50%;
           left: 50%;
           transform: translate(-50%, -50%);
           background-color: white;
           padding: 30px;
           border-radius: 10px;
           box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
           z-index: 1000;
           max-width: 400px;
           width: 90%;
           text-align: center;
       }

       .payment-modal h2 {
           color: #333;
           margin-bottom: 20px;
       }

       .payment-modal p {
           color: #666;
           margin-bottom: 30px;
       }

       .payment-modal button {
           background-color: #fdbb2d;
           color: #1a2a6c;
           border: none;
           padding: 12px 20px;
           border-radius: 25px;
           cursor: pointer;
           transition: all 0.3s;
           font-weight: 600;
           font-size: 0.9rem;
           margin: 0 10px;
       }

       .payment-modal button:hover {
           background-color: #e6a727;
       }

       .close-modal {
           position: absolute;
           top: 10px;
           right: 10px;
           cursor: pointer;
           font-size: 1.2rem;
           color: #333;
       }

       /* Style pour l'overlay */
       .overlay {
           display: none;
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background-color: rgba(0, 0, 0, 0.5);
           z-index: 999;
       }
       #subscriptionSection {
           text-align: center;
           margin-bottom: 30px;
       }

       #subscriptionSection h2 {
           font-size: 24px;
           color: #fdbb2d;
           margin-bottom: 20px;
       }

       #subscriptionStatus {
           font-size: 18px;
           color: #fff;
           margin-bottom: 20px;
       }

       .subscription-buttons {
           display: flex;
           justify-content: center;
           gap: 20px;
       }

       .subscription-buttons button {
           background-color: #fdbb2d;
           color: #1a2a6c;
           border: none;
           padding: 12px 20px;
           border-radius: 25px;
           cursor: pointer;
           transition: all 0.3s;
           font-weight: 600;
           font-size: 0.9rem;
       }

       .subscription-buttons button:hover {
           background-color: #e6a727;
       }

       /* Style pour le message d'abonnement requis */
       .subscription-required {
           display: none;
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background-color: rgba(0, 0, 0, 0.5);
           z-index: 1000;
           justify-content: center;
           align-items: center;
           color: white;
           text-align: center;
           padding: 20px;
       }

       .subscription-required-content {
           background-color: white;
           padding: 30px;
           border-radius: 10px;
           box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
           max-width: 400px;
           width: 90%;
       }

       .subscription-required-content h2 {
           color: #333;
           margin-bottom: 20px;
       }

       .subscription-required-content p {
           color: #666;
           margin-bottom: 30px;
       }

       .subscription-required-content button {
           background-color: #fdbb2d;
           color: #1a2a6c;
           border: none;
           padding: 12px 20px;
           border-radius: 25px;
           cursor: pointer;
           transition: all 0.3s;
           font-weight: 600;
           font-size: 0.9rem;
           margin: 0 10px;
       }

       .subscription-required-content button:hover {
           background-color: #e6a727;
       }
        .loader-wrapper {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1001;
        }

        .loader {
            position: absolute;
            top: 50%;
            left: 50%;
            border: 6px solid #f3f3f3;
            border-top: 6px solid #fdbb2d;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
            transform: translate(-50%, -50%);
        }

        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .page-loader-wrapper {
            display: flex;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1002;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .page-loader {
            border: 6px solid #f3f3f3;
            border-top: 6px solid #fdbb2d;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }

        .loader-message {
            color: white;
            margin-top: 16px;
            font-size: 1rem;
            text-align: center;
            max-width: 80%;
        }

        .header {
            display: flex; /* Added to align items */
            justify-content: center; /* MODIFICATION: Center content horizontally */
            align-items: center; /* Added to vertically align items */
            flex-direction: column; /* MODIFICATION: Stack items vertically */
            text-align: center; /* MODIFICATION: Center text within header */
        }

        .header h1 {
            margin: 0; /* Reset margin for h1 inside header */
        }

        .logout-button {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
        }

        .logout-button:hover {
            background-color: #c0392b;
        }
       /* Styles pour le formulaire de portail captif */
      #portalForm {
          display: none; /*Caché par défaut*/
          flex-direction: column;
          gap: 10px;
          max-width: 600px; /* Limite la largeur du formulaire */
          margin: 20px auto;
          padding: 20px;
          background-color: rgba(255, 255, 255, 0.1); /* Léger fond pour le formulaire */
          border-radius: 8px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.2); /* Ombre légère */
      }
      #portalForm label {
          color: #fdbb2d; /* Couleur pour les labels */
      }
      #portalForm input[type="text"],
      #portalForm input[type="number"],
      #portalForm textarea,
      #portalForm select {
          width: 100%;
          padding: 10px;
          border: 1px solid #ddd;
          border-radius: 4px;
          background-color: rgba(255,255,255,0.2); /* Fond transparent */
          color: white; /* Couleur du texte */
      }

      #portalForm button {
          padding: 10px 15px;
          background-color: #fdbb2d;
          color: #1a2a6c;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          font-size: 16px;
      }

      #portalForm button:hover {
          background-color: #e6a727;
      }
      #portalForm .list-input-container {
          display: flex;
          flex-direction: column;
      }

      #portalForm .list-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

      #portalForm .list-item input {
          flex: 1; /* Permet à l'input de prendre l'espace disponible */
          margin-right: 5px; /* Marge entre l'input et le bouton */
      }
        #portalForm .list-item button {
           padding: 5px 10px;
           background-color: #e74c3c; /* Couleur différente pour le bouton de suppression */
           color: white;
           border: none;
           border-radius: 4px;
           cursor: pointer;
           font-size: 14px;
        }

        #portalForm .list-item button:hover {
           background-color: #c0392b;
        }

        #configSection {
          margin-bottom:           20px;
          text-align: center; /* Center-align the buttons */
      }
        #configSection .config-buttons {
          display: inline-block;
          margin: 0 10px;
        }

    </style>
</head>
<body>
    <div class="page-loader-wrapper" id="pageLoaderWrapper">
        <div class="page-loader"></div>
        <div class="loader-message" id="pageLoaderMessage">Initialisation...</div>
    </div>
    <div class="loader-wrapper" id="loaderWrapper">
        <div class="loader"></div>
    </div>
    <div class="container" id="contentContainer" style="display:none;">
        <header class="header">
            <h1 id="networkNameDisplay">ADMIN WIFI ZONE</h1>
            <div class="wave"></div>
        </header>


        <main>
            <div id="subscriptionSection">
                <h2>Statut de l'Abonnement</h2>
                <div id="subscriptionStatus"></div>
                <div class="subscription-button">
                    <button id="subscribeMonthly">S'abonner (Mensuel - 1000 FCFA)</button>
                    <button id="subscribeYearly">S'abonner (Annuel - 10 000 FCFA)</button>
                </div>
            </div>

            <div id="configSection">
              <button onclick="togglePortalForm()" id="togglePortalFormBtn">Configurer le portail captif</button>
              <button onclick="downloadLoginFile()" id="downloadLoginBtn" style="display: none;">Télécharger le portail captif</button>
             </div>


            <form id="portalForm" style="display: none;">
                <label for="networkName">Nom du réseau:</label>
                <input type="text" id="networkName" name="networkName" required>

                <label for="contactNumber">Numéro à contacter:</label>
                <input type="text" id="contactNumber" name="contactNumber" required>

                <label for="fedapayApiKey">Clé API FedaPay:</label>
                <input type="text" id="fedapayApiKey" name="fedapayApiKey" required>

                <label for="loginMode">Mode de connexion par défaut :</label>
                <select id="loginMode" name="loginMode">
                    <option value="separate">Nom d'utilisateur et Mot de passe</option>
                    <option value="same">Identifiant unique</option>
                    <option value="pay">Page de paiement</option> <!-- Nouvelle option -->
                </select>

                <div class="list-input-container">
                    <label>Tarifs:</label>
                    <div id="tariffsList">
                        <div class="list-item">
                            <input type="text" placeholder="Nom du tarif" data-type="tariffName">
                            <input type="number" placeholder="Prix" data-type="tariffPrice">
                            <button type="button" onclick="addListItem('tariffsList')">Ajouter</button>
                         </div>
                      </div>
                 </div>

                 <div class="list-input-container">
                      <label>Adresses de connexion:</label>
                      <div id="connectionsList">
                         <div class="list-item">
                            <input type="text" placeholder="Adresse" data-type="connection">
                            <button type="button" onclick="addListItem('connectionsList')">Ajouter</button>
                           </div>
                      </div>
                  </div>

                  <div class="list-input-container">
                      <label>Services et produits:</label>
                      <div id="productsList">
                         <div class="list-item">
                             <input type="text" placeholder="Service/Produit" data-type="product">
                             <button type="button" onclick="addListItem('productsList')">Ajouter</button>
                         </div>
                     </div>
                 </div>

                 <button type="submit">Enregistrer la configuration</button>
             </form>

            <div class="menu">
                <a href="PageVenteTicket.html" class="menu-item" id="vente">
                    <i class="fas fa-ticket-alt"></i> <!-- Font Awesome Ticket Icon -->
                    <h2>Vente de Tickets</h2>
                    <p>Procédez à la vente de nouveaux tickets Wifi.</p>
                </a>
                <a href="AdminVentePartenaires.html" class="menu-item" id="inventaire">
                    <i class="fas fa-clipboard-list"></i> <!-- Font Awesome Clipboard List Icon -->
                    <h2>Inventaire des Tickets</h2>
                    <p>Consultez l'état des ventes de vos partenaires.</p>
                </a>
                <a href="Stock.html" class="menu-item" id="stock">
                    <i class="fas fa-boxes"></i> <!-- Font Awesome Boxes Icon -->
                    <h2>Gestion des Stocks Partenaire</h2>
                    <p>Suivez les stocks de tickets de vos partenaires.</p>
                </a>
                <a href="a3.html" class="menu-item" id="administration">
                    <i class="fas fa-cog"></i> <!-- Font Awesome Settings Cog Icon -->
                    <h2>Administration des Tickets</h2>
                    <p>Gérez les tickets, activez ou désactivez-les.</p>
                </a>
                <button onclick="logout()" class="logout-button">Déconnexion</button>
            </div>

        </main>

    </div>


    <div id="paymentModal" class="payment-modal" style="display: none;">
        <span class="close-modal" onclick="closePaymentModal()">×</span>
        <h2>Paiement de l'Abonnement</h2>
        <p>Choisissez votre plan d'abonnement et procédez au paiement via FedaPay.</p>
        <!-- Les boutons de paiement seront ajoutés ici par le script -->
    </div>

    <div id="subscriptionRequiredModal" class="subscription-required" style="display: none;">
        <div class="subscription-required-content">
            <h2>Abonnement Requis</h2>
            <p>Un abonnement actif est nécessaire pour accéder à cette fonctionnalité.</p>
            <button onclick="redirectToSubscription()">S'abonner</button>
            <button onclick="hideSubscriptionRequiredModal()">Fermer</button>
        </div>
    </div>

    <div class="overlay" id="overlay" style="display: none;" onclick="closePaymentModal()"></div>

    <script type="module">
 const _0x420eec=_0x2802;(function(_0x20bf12,_0x4f31bb){const _0x4397cd=_0x2802,_0x1bd81c=_0x20bf12();while(!![]){try{const _0x4e6e4c=parseInt(_0x4397cd(0x28f))/0x1+parseInt(_0x4397cd(0x278))/0x2+parseInt(_0x4397cd(0x1cc))/0x3*(-parseInt(_0x4397cd(0x22f))/0x4)+parseInt(_0x4397cd(0x213))/0x5+parseInt(_0x4397cd(0x1f7))/0x6*(parseInt(_0x4397cd(0x263))/0x7)+-parseInt(_0x4397cd(0x200))/0x8+-parseInt(_0x4397cd(0x247))/0x9*(parseInt(_0x4397cd(0x284))/0xa);if(_0x4e6e4c===_0x4f31bb)break;else _0x1bd81c['push'](_0x1bd81c['shift']());}catch(_0x22f504){_0x1bd81c['push'](_0x1bd81c['shift']());}}}(_0x7160,0x950af));import{getActiveDatabase}from'./firebase-config-manager.js';import{ref,get,set,push,remove,update}from'https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js';let db,adminRef,connectedTicketsRef;async function initializeDatabase(){const _0x32e1d2=_0x2802;db=await getActiveDatabase(),connectedTicketsRef=ref(db,_0x32e1d2(0x227)),console[_0x32e1d2(0x255)]('Database\x20initialized\x20in\x20index.html');}async function checkLoginStatus(){const _0x27a700=_0x2802;if(sessionStorage[_0x27a700(0x27d)]('isLoggedIn')!==_0x27a700(0x1ec))redirectToLogin();else{const _0x48f51d=sessionStorage[_0x27a700(0x27d)](_0x27a700(0x1e0));if(!_0x48f51d){console[_0x27a700(0x1c6)]('Current\x20user\x20ID\x20is\x20not\x20found\x20in\x20sessionStorage.'),redirectToLogin();return;}document[_0x27a700(0x274)](_0x27a700(0x1e1))['style'][_0x27a700(0x1d5)]='block',adminRef=ref(db,_0x27a700(0x264)+_0x48f51d+_0x27a700(0x205));}}function redirectToLogin(){const _0x3df899=_0x2802;window[_0x3df899(0x26a)][_0x3df899(0x1f0)]='loginAccueil.html';}window['logout']=function(){const _0x171028=_0x2802;sessionStorage[_0x171028(0x21e)](),redirectToLogin();};const venteMenuItem=document['getElementById'](_0x420eec(0x1f2)),inventaireMenuItem=document[_0x420eec(0x274)]('inventaire'),stockMenuItem=document['getElementById'](_0x420eec(0x216)),administrationMenuItem=document[_0x420eec(0x274)](_0x420eec(0x232)),subscriptionStatus=document['getElementById'](_0x420eec(0x214)),subscribeMonthlyButton=document[_0x420eec(0x274)]('subscribeMonthly'),subscribeYearlyButton=document['getElementById'](_0x420eec(0x259)),paymentModal=document[_0x420eec(0x274)](_0x420eec(0x1f5)),overlay=document[_0x420eec(0x274)](_0x420eec(0x252)),subscriptionRequiredModal=document[_0x420eec(0x274)](_0x420eec(0x24f));function showLoader(){const _0x37e7f1=_0x420eec;document[_0x37e7f1(0x274)](_0x37e7f1(0x1c5))[_0x37e7f1(0x287)][_0x37e7f1(0x1d5)]='block';}function hideLoader(){const _0x43ce43=_0x420eec;document[_0x43ce43(0x274)]('loaderWrapper')[_0x43ce43(0x287)][_0x43ce43(0x1d5)]=_0x43ce43(0x28e);}function showPageLoader(){const _0x591fd4=_0x420eec;document[_0x591fd4(0x274)](_0x591fd4(0x25e))[_0x591fd4(0x287)][_0x591fd4(0x1d5)]=_0x591fd4(0x253);}function hidePageLoader(){const _0x27dccf=_0x420eec;document[_0x27dccf(0x274)]('pageLoaderWrapper')[_0x27dccf(0x287)]['display']=_0x27dccf(0x28e);}function showSubscriptionRequiredModal(){const _0x301313=_0x420eec;subscriptionRequiredModal[_0x301313(0x287)][_0x301313(0x1d5)]='flex';}function hideSubscriptionRequiredModal(){subscriptionRequiredModal['style']['display']='none';}function redirectToSubscription(){hideSubscriptionRequiredModal();}function checkSubscriptionStatus(){const _0x1c5142=_0x420eec,_0x168ca2=sessionStorage['getItem']('currentUserId');if(!_0x168ca2){console[_0x1c5142(0x1c6)](_0x1c5142(0x283));return;}const _0x51f3e1=ref(db,_0x1c5142(0x264)+_0x168ca2+'/admin/subscription');get(_0x51f3e1)['then'](_0x560cd9=>{const _0x518abb=_0x1c5142,_0x3c0233=_0x560cd9[_0x518abb(0x286)](),_0x41dd88=new Date();if(_0x3c0233&&_0x3c0233[_0x518abb(0x219)]===_0x518abb(0x1da)){const _0x26fce9=new Date(_0x3c0233[_0x518abb(0x289)]);_0x26fce9<_0x41dd88?(subscriptionStatus[_0x518abb(0x22c)]='Statut\x20de\x20l\x27abonnement:\x20Expiré',subscriptionStatus[_0x518abb(0x287)]['color']=_0x518abb(0x22e),subscribeMonthlyButton[_0x518abb(0x287)][_0x518abb(0x1d5)]='inline-block',subscribeYearlyButton['style'][_0x518abb(0x1d5)]=_0x518abb(0x238),set(_0x51f3e1,{..._0x3c0233,'status':_0x518abb(0x1c0)})):(subscriptionStatus[_0x518abb(0x22c)]=_0x518abb(0x1ca)+_0x26fce9[_0x518abb(0x1e2)](),subscriptionStatus['style'][_0x518abb(0x1e3)]=_0x518abb(0x23d),subscribeMonthlyButton[_0x518abb(0x287)][_0x518abb(0x1d5)]='none',subscribeYearlyButton[_0x518abb(0x287)][_0x518abb(0x1d5)]=_0x518abb(0x28e));}else subscriptionStatus['textContent']=_0x518abb(0x24e),subscriptionStatus[_0x518abb(0x287)][_0x518abb(0x1e3)]='red',subscribeMonthlyButton['style']['display']=_0x518abb(0x238),subscribeYearlyButton[_0x518abb(0x287)][_0x518abb(0x1d5)]=_0x518abb(0x238);})[_0x1c5142(0x1ef)](_0x26b028=>{const _0x4d37c1=_0x1c5142;console[_0x4d37c1(0x1c6)]('Erreur\x20lors\x20de\x20la\x20vérification\x20du\x20statut\x20d\x27abonnement:',_0x26b028);});}function checkUserAccess(){const _0x447954=_0x420eec;get(adminRef)[_0x447954(0x250)](_0x472a0c=>{const _0x53231a=_0x447954,_0x3e57ac=_0x472a0c[_0x53231a(0x286)]();(!_0x3e57ac||_0x3e57ac['status']!==_0x53231a(0x1da))&&showSubscriptionRequiredModal();});}function _0x7160(){const _0x15a791=['subscriptionStatus','addEventListener','stock','/TicketsTransit','logout','status','...','[data-type=\x22tariffName\x22]','Traitement\x20du\x20ticket\x20','cancelled','clear','/TicketsTotal/','same','reason','onload','<!--\x20PRODUCTS_LIST\x20-->','contactNumber','trim','username','TicketConnecté','loginMode','hideSubscriptionRequiredModal','className','\x22\x20placeholder=\x22','textContent','indexOf','red','511248lgsQWU','/VendorsHistory','reset','administration','downloadLoginBtn','Une\x20erreur\x20est\x20survenue\x20lors\x20du\x20traitement\x20des\x20tickets.','now','TicketsTotal','<table\x20style=\x22width:\x20100%;\x20border-collapse:\x20collapse;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Catégorie</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Prix\x20(FCFA)</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>','inline-block','PageVenteTicket.html','Vous\x20devez\x20être\x20connecté\x20pour\x20vous\x20abonner.','annuel','Erreur','green','login.html','Vérification\x20des\x20tickets\x20connectés...','download','portalForm','exists','password','Erreur\x20lors\x20de\x20la\x20mise\x20à\x20jour\x20de\x20l\x27abonnement.','[data-type=\x22tariffPrice\x22]','<input\x20type=\x22text\x22\x20value=\x22','10206FCXcVe','Service/Produit','Erreur\x20lors\x20de\x20l\x27annulation\x20de\x20l\x27abonnement:','Adresse','Current\x20user\x20ID\x20is\x20not\x20found\x20in\x20sessionStorage.','prix','Erreur\x20lors\x20du\x20traitement\x20des\x20tickets\x20connectés\x20:','Statut\x20de\x20l\x27abonnement:\x20Inactif','subscriptionRequiredModal','then','pageLoaderMessage','overlay','flex','<ul>','log','firebase-config-manager.js','querySelectorAll','Erreur\x20lors\x20de\x20l\x27annulation\x20de\x20l\x27abonnement.','subscribeYearly','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22','Vous\x20devez\x20être\x20connecté\x20pour\x20télécharger\x20le\x20portail.','monthly','Vendeur\x20automatique','pageLoaderWrapper','<!--\x20CONNECTION_LOCATIONS\x20-->','CHECKOUT_COMPLETED','text','removeChild','6030787fzcQrk','users-data/','Erreur\x20lors\x20du\x20traitement\x20du\x20ticket\x20','querySelector','Erreur\x20lors\x20du\x20chargement\x20de\x20la\x20configuration.','connections','forEach','location','User\x20ID\x20not\x20found.\x20Cannot\x20load\x20portal\x20configuration.','togglePortalForm','Configurer\x20le\x20portail\x20captif','pay','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20onclick=\x22removeListItem(this)\x22>Supprimer</button>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20placeholder=\x22Nom\x20du\x20tarif\x22\x20data-type=\x22tariffName\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20placeholder=\x22Prix\x22\x20data-type=\x22tariffPrice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20onclick=\x22removeListItem(this)\x22>Supprimer</button>','tariffs','Abonnement\x20','Stock.html','getElementById','Vous\x20devez\x20être\x20connecté\x20pour\x20configurer\x20le\x20portail.','separate','innerHTML','576264yJpqSk','appendChild','transaction','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table\x20style=\x22width:\x20100%;\x20border-collapse:\x20collapse;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Catégorie</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Prix\x20(FCFA)</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Action</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','CYBER\x20CAMPUS\x20WIFI\x20ZONE','getItem','Vérification\x20du\x20ticket\x20pour\x20','createElement','body','<!--\x20TARIFFS_TABLE\x20-->','category','User\x20ID\x20not\x20found.\x20Cannot\x20check\x20subscription\x20status.','3690QEbIcf','value','val','style','click','endDate','<!--\x20TARIFFS_TABLE_SIMPLE\x20-->','name','#productsList\x20.list-item\x20input','preventDefault','none','1079542yofXBb','Paiement\x20échoué.','push','togglePortalFormBtn','/TicketsVendus','expired','Une\x20erreur\x20est\x20survenue\x20lors\x20de\x20l\x27initialisation.','div','setFullYear','toISOString','loaderWrapper','error','tariffsList',')\x22>Payer</button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','init','Statut\x20de\x20l\x27abonnement:\x20Actif\x20jusqu\x27au\x20','AdminVentePartenaires.html','27dEIjdD','Erreur\x20lors\x20du\x20chargement\x20de\x20la\x20configuration:','\x20réussi!','Erreur\x20lors\x20de\x20la\x20mise\x20à\x20jour\x20de\x20l\x27abonnement:','Abonnement\x20annulé.','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20onclick=\x22removeListItem(this)\x22>Supprimer</button>','loginAccueil.html','connectionsList','motDePasse','display','Masquer\x20le\x20formulaire','Mode\x20de\x20connexion\x20invalide.','replace','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','active','Erreur\x20lors\x20de\x20l\x27enregistrement\x20de\x20la\x20configuration:','<!--\x20FEDAPAY_API_KEY\x20-->','/TicketsTotal','updatedData','<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22>','currentUserId','contentContainer','toLocaleDateString','color','filter','setMonth','Current\x20user\x20ID\x20is\x20not\x20provided\x20to\x20processTicket.','Ticket\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22>','user','</tbody></table>','productsList','true','Current\x20user\x20ID\x20is\x20not\x20provided\x20to\x20sellTicketAutomatically.','Traitement\x20des\x20tickets\x20uniques...','catch','href','addListItem','vente','revokeObjectURL','DIALOG_DISMISSED','paymentModal','utilisateur','6OmJorh','+229\x20XXXXXXXX','TicketsTransit','/portalConfig','#tariffsList\x20.list-item','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','User\x20ID\x20not\x20found.\x20Cannot\x20cancel\x20subscription.','fedapayApiKey','open','8268664ohLQWh','price','remove','mensuel','User\x20ID\x20not\x20found.\x20Cannot\x20initiate\x20payment.','/admin/subscription','Erreur\x20lors\x20de\x20la\x20vente\x20automatique\x20du\x20ticket\x20:','log.html','product','Aucune\x20configuration\x20de\x20portail\x20captif\x20trouvée.','\x22\x20data-type=\x22tariffName\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20value=\x22','DOMContentLoaded','pk_live_TfSz212W0xSMKK7oPEogkFmp','text/html','createObjectURL','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22>','\x27,\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20value=\x22','networkName','4918005xWIpWQ'];_0x7160=function(){return _0x15a791;};return _0x7160();}venteMenuItem[_0x420eec(0x215)](_0x420eec(0x288),_0x283e76=>{const _0x1d69a7=_0x420eec;_0x283e76['preventDefault'](),checkUserAccess(),window[_0x1d69a7(0x26a)]['href']=_0x1d69a7(0x239);}),inventaireMenuItem[_0x420eec(0x215)]('click',_0x4fe59a=>{const _0x4a763b=_0x420eec;_0x4fe59a[_0x4a763b(0x28d)](),checkUserAccess(),window[_0x4a763b(0x26a)]['href']=_0x4a763b(0x1cb);}),stockMenuItem[_0x420eec(0x215)](_0x420eec(0x288),_0x40dca7=>{const _0x5885e1=_0x420eec;_0x40dca7[_0x5885e1(0x28d)](),checkUserAccess(),window[_0x5885e1(0x26a)][_0x5885e1(0x1f0)]=_0x5885e1(0x273);}),administrationMenuItem[_0x420eec(0x215)]('click',_0x576183=>{const _0xbf019d=_0x420eec;_0x576183[_0xbf019d(0x28d)](),checkUserAccess(),window[_0xbf019d(0x26a)][_0xbf019d(0x1f0)]='a3.html';}),subscribeMonthlyButton[_0x420eec(0x215)]('click',()=>{const _0x76be24=_0x420eec;initiatePayment(_0x76be24(0x25c));}),subscribeYearlyButton[_0x420eec(0x215)](_0x420eec(0x288),()=>{initiatePayment('yearly');});function initiatePayment(_0x54866e){const _0x5a0e6b=_0x420eec,_0x28a471=_0x54866e===_0x5a0e6b(0x25c)?0x3e8:0x2710,_0x19e4aa=_0x54866e===_0x5a0e6b(0x25c)?'Abonnement\x20mensuel':'Abonnement\x20annuel',_0x334b9a=sessionStorage[_0x5a0e6b(0x27d)](_0x5a0e6b(0x1e0));if(!_0x334b9a){console[_0x5a0e6b(0x1c6)](_0x5a0e6b(0x204)),alert(_0x5a0e6b(0x23a));return;}FedaPay[_0x5a0e6b(0x1c9)]({'public_key':_0x5a0e6b(0x20c),'transaction':{'amount':_0x28a471,'description':_0x19e4aa},'customer':{'email':'admin@example.com'},'onComplete':async function(_0x5748da){const _0x57baa6=_0x5a0e6b;if(_0x5748da[_0x57baa6(0x221)]===FedaPay[_0x57baa6(0x1f4)])alert(_0x57baa6(0x290));else _0x5748da[_0x57baa6(0x221)]===FedaPay[_0x57baa6(0x260)]&&handleSuccessfulPayment(_0x54866e,_0x5748da,_0x334b9a);}})[_0x5a0e6b(0x1ff)]();}async function handleSuccessfulPayment(_0x46529a,_0x535f73,_0x5e280c){const _0x41c939=_0x420eec,_0x3b30ea=new Date(),_0x3d75d4=new Date(_0x3b30ea);_0x46529a===_0x41c939(0x25c)?_0x3d75d4[_0x41c939(0x1e5)](_0x3d75d4['getMonth']()+0x1):_0x3d75d4[_0x41c939(0x1c3)](_0x3d75d4['getFullYear']()+0x1);const _0x52d6c2={'status':_0x41c939(0x1da),'startDate':_0x3b30ea[_0x41c939(0x1c4)](),'endDate':_0x3d75d4[_0x41c939(0x1c4)](),'transactionId':_0x535f73[_0x41c939(0x27a)]['id'],'plan':_0x46529a};try{const _0x44dd64=ref(db,'users-data/'+_0x5e280c+_0x41c939(0x205));await set(_0x44dd64,_0x52d6c2),checkSubscriptionStatus(),alert(_0x41c939(0x272)+(_0x46529a===_0x41c939(0x25c)?_0x41c939(0x203):_0x41c939(0x23b))+_0x41c939(0x1ce));}catch(_0x55f4ae){console[_0x41c939(0x1c6)](_0x41c939(0x1cf),_0x55f4ae),alert(_0x41c939(0x244));}}async function cancelSubscription(){const _0x27dded=_0x420eec,_0x12f604=sessionStorage[_0x27dded(0x27d)](_0x27dded(0x1e0));if(!_0x12f604){console[_0x27dded(0x1c6)](_0x27dded(0x1fd)),alert('Vous\x20devez\x20être\x20connecté\x20pour\x20annuler\x20un\x20abonnement.');return;}try{const _0x2e7705=ref(db,'users-data/'+_0x12f604+'/admin/subscription');await set(_0x2e7705,{...(await get(_0x2e7705))[_0x27dded(0x286)](),'status':_0x27dded(0x21d)}),checkSubscriptionStatus(),alert(_0x27dded(0x1d0));}catch(_0x5cc835){console[_0x27dded(0x1c6)](_0x27dded(0x249),_0x5cc835),alert(_0x27dded(0x258));}}async function processConnectedTickets(){const _0x5c897d=_0x420eec,_0x3ef4f5=document[_0x5c897d(0x274)](_0x5c897d(0x251)),_0x5613d8=sessionStorage[_0x5c897d(0x27d)](_0x5c897d(0x1e0));if(!_0x5613d8){console[_0x5c897d(0x1c6)](_0x5c897d(0x24b));return;}try{_0x3ef4f5[_0x5c897d(0x22c)]=_0x5c897d(0x23f);const _0x1cc792=await get(connectedTicketsRef);let _0x275a07=_0x1cc792[_0x5c897d(0x286)]()||{};const _0x39a17a={};for(const _0x840b14 in _0x275a07){const _0x1475ee=_0x275a07[_0x840b14][_0x5c897d(0x226)];!_0x39a17a[_0x1475ee]&&(_0x39a17a[_0x1475ee]=_0x275a07[_0x840b14]);}_0x3ef4f5[_0x5c897d(0x22c)]=_0x5c897d(0x1ee);for(const _0x21d2e4 in _0x39a17a){await processTicket(_0x39a17a[_0x21d2e4],_0x5613d8);}_0x3ef4f5[_0x5c897d(0x22c)]='Nettoyage\x20des\x20tickets\x20traités...',await remove(connectedTicketsRef);}catch(_0x5c1b60){console[_0x5c897d(0x1c6)](_0x5c897d(0x24d),_0x5c1b60),showNotification(_0x5c897d(0x23c),_0x5c897d(0x234));}}async function processTicket(_0x4d3d46,_0x48466d){const _0x4f7673=_0x420eec,_0x496fde=document[_0x4f7673(0x274)]('pageLoaderMessage');if(!_0x48466d){console['error'](_0x4f7673(0x1e6));return;}try{_0x496fde[_0x4f7673(0x22c)]=_0x4f7673(0x27e)+_0x4d3d46[_0x4f7673(0x226)]+_0x4f7673(0x21a);const _0x37b193=ref(db,_0x4f7673(0x264)+_0x48466d+_0x4f7673(0x230)),_0x5cabbe=await get(_0x37b193),_0x17b8e7=_0x5cabbe['val']()||{};let _0x1e9ba8=![];for(const _0x1ed8c7 in _0x17b8e7){const _0x3c320f=_0x17b8e7[_0x1ed8c7];for(const _0x31f928 in _0x3c320f){if(_0x3c320f[_0x31f928][_0x4f7673(0x1e9)]===_0x4d3d46[_0x4f7673(0x226)]){_0x1e9ba8=!![];break;}}if(_0x1e9ba8)break;}if(!_0x1e9ba8){_0x496fde[_0x4f7673(0x22c)]=_0x4f7673(0x21c)+_0x4d3d46[_0x4f7673(0x226)]+'...';const _0x34c1cb=ref(db,'users-data/'+_0x48466d+_0x4f7673(0x1dd)),_0x390b9f=ref(db,_0x4f7673(0x264)+_0x48466d+_0x4f7673(0x217)),_0x28233b=await get(_0x34c1cb),_0x5b5614=await get(_0x390b9f),_0xd98e71=_0x28233b['val']()||{},_0xc71afe=_0x5b5614[_0x4f7673(0x286)]()||{};let _0x3d64bd=null,_0x42d764=null,_0x3f9724=null;for(const _0x2e1865 in _0xd98e71){const _0x4683ba=(_0xd98e71[_0x2e1865][_0x4f7673(0x1f6)]||[])[_0x4f7673(0x22d)](_0x4d3d46[_0x4f7673(0x226)]);if(_0x4683ba>-0x1){_0x3d64bd={'category':_0x2e1865,'user':_0xd98e71[_0x2e1865]['utilisateur'][_0x4683ba],'password':_0xd98e71[_0x2e1865][_0x4f7673(0x1d4)][_0x4683ba],'price':_0xd98e71[_0x2e1865][_0x4f7673(0x24c)][_0x4683ba],'updatedData':{..._0xd98e71[_0x2e1865],'utilisateur':_0xd98e71[_0x2e1865]['utilisateur']['filter']((_0x8eed51,_0x220b37)=>_0x220b37!==_0x4683ba),'motDePasse':_0xd98e71[_0x2e1865][_0x4f7673(0x1d4)]['filter']((_0x1ca145,_0x3fa2f5)=>_0x3fa2f5!==_0x4683ba),'prix':_0xd98e71[_0x2e1865]['prix'][_0x4f7673(0x1e4)]((_0x560098,_0x39bad1)=>_0x39bad1!==_0x4683ba)}},_0x42d764=ref(db,'users-data/'+_0x48466d+_0x4f7673(0x21f)+_0x2e1865),_0x3f9724=_0x4f7673(0x236);break;}}if(!_0x3d64bd)for(const _0x994c1c in _0xc71afe){if(_0xc71afe[_0x994c1c][_0x4f7673(0x1e9)]===_0x4d3d46[_0x4f7673(0x226)]){_0x3d64bd={'category':_0xc71afe[_0x994c1c][_0x4f7673(0x282)],'user':_0xc71afe[_0x994c1c]['user'],'password':_0xc71afe[_0x994c1c][_0x4f7673(0x243)],'price':_0xc71afe[_0x994c1c][_0x4f7673(0x201)]},_0x42d764=ref(db,'users-data/'+_0x48466d+'/TicketsTransit/'+_0x994c1c),_0x3f9724=_0x4f7673(0x1f9);break;}}_0x3d64bd&&(_0x496fde[_0x4f7673(0x22c)]='Vente\x20du\x20ticket\x20'+_0x4d3d46[_0x4f7673(0x226)]+_0x4f7673(0x21a),await sellTicketAutomatically(_0x3d64bd,_0x42d764,_0x3f9724,_0x48466d));}}catch(_0x4bab8e){console[_0x4f7673(0x1c6)]('Erreur\x20lors\x20du\x20traitement\x20du\x20ticket\x20:',_0x4bab8e),showNotification(_0x4f7673(0x23c),_0x4f7673(0x265)+_0x4d3d46['username']+'.');}}async function sellTicketAutomatically(_0x5b91e5,_0x3e0c3d,_0x3abbfb,_0x1b2fbf){const _0x3a7e1f=_0x420eec;if(!_0x1b2fbf){console[_0x3a7e1f(0x1c6)](_0x3a7e1f(0x1ed));return;}try{const _0x1ea03a=_0x3a7e1f(0x25d),_0x7410a6=ref(db,_0x3a7e1f(0x264)+_0x1b2fbf+_0x3a7e1f(0x1bf));await push(_0x7410a6,{'category':_0x5b91e5['category'],'user':_0x5b91e5[_0x3a7e1f(0x1e9)],'password':_0x5b91e5['password'],'price':_0x5b91e5[_0x3a7e1f(0x201)],'soldAt':Date[_0x3a7e1f(0x235)](),'vendorId':_0x1ea03a}),_0x3abbfb===_0x3a7e1f(0x236)?await set(_0x3e0c3d,_0x5b91e5[_0x3a7e1f(0x1de)]):await remove(_0x3e0c3d),console[_0x3a7e1f(0x255)](_0x3a7e1f(0x1e7)+_0x5b91e5[_0x3a7e1f(0x1e9)]+'\x20vendu\x20automatiquement.');}catch(_0x575819){console[_0x3a7e1f(0x1c6)](_0x3a7e1f(0x206),_0x575819),showNotification(_0x3a7e1f(0x23c),'Erreur\x20lors\x20de\x20la\x20vente\x20automatique\x20du\x20ticket.');}}window[_0x420eec(0x218)]=function(){const _0x217d51=_0x420eec;sessionStorage[_0x217d51(0x21e)](),window[_0x217d51(0x26a)][_0x217d51(0x1d8)](_0x217d51(0x1d2));},window[_0x420eec(0x26c)]=function(){const _0x2d2e43=_0x420eec,_0x54b171=document['getElementById'](_0x2d2e43(0x241)),_0xefa30a=document[_0x2d2e43(0x274)]('togglePortalFormBtn'),_0x88a5d3=document[_0x2d2e43(0x274)]('downloadLoginBtn');_0x54b171[_0x2d2e43(0x287)][_0x2d2e43(0x1d5)]===_0x2d2e43(0x28e)||_0x54b171['style'][_0x2d2e43(0x1d5)]===''?(_0x54b171['style'][_0x2d2e43(0x1d5)]=_0x2d2e43(0x253),_0x88a5d3[_0x2d2e43(0x287)][_0x2d2e43(0x1d5)]=_0x2d2e43(0x238),_0xefa30a['textContent']=_0x2d2e43(0x1d6)):(_0x54b171[_0x2d2e43(0x287)][_0x2d2e43(0x1d5)]=_0x2d2e43(0x28e),_0x88a5d3[_0x2d2e43(0x287)][_0x2d2e43(0x1d5)]=_0x2d2e43(0x28e),_0xefa30a[_0x2d2e43(0x22c)]=_0x2d2e43(0x26d));},window[_0x420eec(0x1f1)]=function(_0x518f31){const _0x1ba108=_0x420eec,_0x440b5=document['getElementById'](_0x518f31),_0x339908=document[_0x1ba108(0x27f)](_0x1ba108(0x1c2));_0x339908[_0x1ba108(0x22a)]='list-item';let _0x3fea7d='text';if(_0x518f31==='tariffsList')_0x339908['innerHTML']=_0x1ba108(0x270);else{let _0x1a5507='';if(_0x518f31==='connectionsList')_0x1a5507=_0x1ba108(0x24a);else _0x518f31===_0x1ba108(0x1eb)&&(_0x1a5507=_0x1ba108(0x248));_0x339908['innerHTML']=_0x1ba108(0x25a)+_0x3fea7d+_0x1ba108(0x22b)+_0x1a5507+'\x22\x20data-type=\x22'+_0x518f31['slice'](0x0,-0x4)+_0x1ba108(0x1d1);}_0x440b5[_0x1ba108(0x279)](_0x339908);},window['removeListItem']=function(_0x15c8b6){const _0x39e3e9=_0x420eec;_0x15c8b6['parentNode'][_0x39e3e9(0x202)]();},document[_0x420eec(0x274)](_0x420eec(0x241))[_0x420eec(0x215)]('submit',async _0x234c20=>{const _0x496b7b=_0x420eec;_0x234c20[_0x496b7b(0x28d)](),showLoader();const _0x335b7e=sessionStorage[_0x496b7b(0x27d)](_0x496b7b(0x1e0));if(!_0x335b7e){console['error']('User\x20ID\x20not\x20found.\x20Cannot\x20save\x20portal\x20configuration.'),alert(_0x496b7b(0x275)),hideLoader();return;}const _0xe21246={'networkName':document[_0x496b7b(0x274)]('networkName')[_0x496b7b(0x285)],'contactNumber':document['getElementById'](_0x496b7b(0x224))['value'],'fedapayApiKey':document['getElementById'](_0x496b7b(0x1fe))[_0x496b7b(0x285)],'loginMode':document['getElementById']('loginMode')['value'],'tariffs':[],'connections':[],'products':[]};document[_0x496b7b(0x257)](_0x496b7b(0x1fb))[_0x496b7b(0x269)](_0x479a1f=>{const _0x39fb0d=_0x496b7b,_0x5356d9=_0x479a1f[_0x39fb0d(0x266)](_0x39fb0d(0x21b)),_0x3d42b3=_0x479a1f[_0x39fb0d(0x266)](_0x39fb0d(0x245));if(_0x5356d9&&_0x3d42b3){const _0x566313=_0x5356d9[_0x39fb0d(0x285)]['trim'](),_0x4277e5=parseFloat(_0x3d42b3[_0x39fb0d(0x285)]);_0x566313&&!isNaN(_0x4277e5)&&_0xe21246[_0x39fb0d(0x271)][_0x39fb0d(0x291)]({'name':_0x566313,'price':_0x4277e5});}}),document['querySelectorAll']('#connectionsList\x20.list-item\x20input')[_0x496b7b(0x269)](_0x2a7eda=>{const _0x1e303d=_0x496b7b,_0x38f61c=_0x2a7eda[_0x1e303d(0x285)][_0x1e303d(0x225)]();_0x38f61c&&_0xe21246[_0x1e303d(0x268)][_0x1e303d(0x291)](_0x38f61c);}),document['querySelectorAll'](_0x496b7b(0x28c))['forEach'](_0x1599a2=>{const _0x3ba3ea=_0x496b7b,_0xd95758=_0x1599a2[_0x3ba3ea(0x285)][_0x3ba3ea(0x225)]();_0xd95758&&_0xe21246['products']['push'](_0xd95758);});try{const _0xdd0514=ref(db,_0x496b7b(0x264)+_0x335b7e+_0x496b7b(0x1fa));await set(_0xdd0514,_0xe21246),alert('Configuration\x20du\x20portail\x20captif\x20enregistrée\x20avec\x20succès!'),hideLoader(),document[_0x496b7b(0x274)](_0x496b7b(0x241))[_0x496b7b(0x231)](),document['getElementById'](_0x496b7b(0x241))[_0x496b7b(0x287)][_0x496b7b(0x1d5)]='none',document[_0x496b7b(0x274)](_0x496b7b(0x292))[_0x496b7b(0x22c)]=_0x496b7b(0x26d),document[_0x496b7b(0x274)](_0x496b7b(0x233))['style'][_0x496b7b(0x1d5)]=_0x496b7b(0x28e),document[_0x496b7b(0x274)]('networkNameDisplay')[_0x496b7b(0x22c)]=_0xe21246[_0x496b7b(0x212)];}catch(_0x346848){console[_0x496b7b(0x1c6)](_0x496b7b(0x1db),_0x346848),alert('Erreur\x20lors\x20de\x20l\x27enregistrement\x20de\x20la\x20configuration.'),hideLoader();}});async function downloadLoginFile(){const _0x478411=_0x420eec;showLoader();const _0x4115c4=sessionStorage[_0x478411(0x27d)](_0x478411(0x1e0));if(!_0x4115c4){console['error']('User\x20ID\x20not\x20found.\x20Cannot\x20download\x20login\x20file.'),hideLoader(),alert(_0x478411(0x25b));return;}try{const _0x3caf73=ref(db,'users-data/'+_0x4115c4+'/portalConfig'),_0x1d4ee4=await get(_0x3caf73);if(!_0x1d4ee4[_0x478411(0x242)]()){alert(_0x478411(0x209)),hideLoader();return;}const _0x22ddd2=_0x1d4ee4['val']();let _0x58d3db='',_0x46225f='';if(_0x22ddd2[_0x478411(0x228)]===_0x478411(0x276)){const _0x17b98e=await fetch(_0x478411(0x23e));_0x58d3db=await _0x17b98e['text'](),_0x46225f=_0x478411(0x23e);}else{if(_0x22ddd2[_0x478411(0x228)]===_0x478411(0x220)){const _0x121630=await fetch(_0x478411(0x207));_0x58d3db=await _0x121630[_0x478411(0x261)](),_0x46225f=_0x478411(0x207);}else{if(_0x22ddd2[_0x478411(0x228)]===_0x478411(0x26e)){const _0x4532a2=await fetch('pay.html');_0x58d3db=await _0x4532a2[_0x478411(0x261)](),_0x46225f='pay.html';}else{alert(_0x478411(0x1d7)),hideLoader();return;}}}_0x58d3db=_0x58d3db[_0x478411(0x1d8)]('<!--\x20ADMIN_USER_ID\x20-->',_0x4115c4);function _0x2ef702(_0x294ced){const _0x408b1b=_0x478411;let _0x1b28b4=_0x408b1b(0x27b);return _0x294ced[_0x408b1b(0x269)](_0x54e14f=>{const _0x7a644c=_0x408b1b;_0x1b28b4+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22>'+_0x54e14f[_0x7a644c(0x28b)]+_0x7a644c(0x20f)+_0x54e14f[_0x7a644c(0x201)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22><button\x20onclick=\x22initPayment(\x27'+_0x54e14f[_0x7a644c(0x28b)]+_0x7a644c(0x210)+_0x54e14f[_0x7a644c(0x201)]+_0x7a644c(0x1c8);}),_0x1b28b4+=_0x408b1b(0x1d9),_0x1b28b4;}function _0x17da0b(_0x3a80cf){const _0x5e48f9=_0x478411;let _0x141ef7=_0x5e48f9(0x237);return _0x3a80cf[_0x5e48f9(0x269)](_0x79664d=>{const _0x10c293=_0x5e48f9;_0x141ef7+=_0x10c293(0x1df)+_0x79664d[_0x10c293(0x28b)]+_0x10c293(0x1e8)+_0x79664d[_0x10c293(0x201)]+_0x10c293(0x1fc);}),_0x141ef7+=_0x5e48f9(0x1ea),_0x141ef7;}function _0x4f809d(_0x22368a){const _0x430363=_0x478411;let _0x4c5d97=_0x430363(0x254);return _0x22368a[_0x430363(0x269)](_0x21f3f0=>{_0x4c5d97+='<li>'+_0x21f3f0+'</li>';}),_0x4c5d97+='</ul>',_0x4c5d97;}_0x58d3db=_0x58d3db[_0x478411(0x1d8)](_0x478411(0x281),_0x2ef702(_0x22ddd2[_0x478411(0x271)]||[])),_0x58d3db=_0x58d3db[_0x478411(0x1d8)](_0x478411(0x28a),_0x17da0b(_0x22ddd2[_0x478411(0x271)]||[])),_0x58d3db=_0x58d3db[_0x478411(0x1d8)](_0x478411(0x25f),_0x4f809d(_0x22ddd2[_0x478411(0x268)]||[])),_0x58d3db=_0x58d3db[_0x478411(0x1d8)](_0x478411(0x223),_0x4f809d(_0x22ddd2['products']||[])),_0x58d3db=_0x58d3db[_0x478411(0x1d8)]('<!--\x20CONTACT_NUMBER\x20-->',_0x22ddd2['contactNumber']||_0x478411(0x1f8)),_0x58d3db=_0x58d3db[_0x478411(0x1d8)]('<!--\x20NETWORK_NAME\x20-->',_0x22ddd2['networkName']||_0x478411(0x27c)),_0x58d3db=_0x58d3db[_0x478411(0x1d8)](_0x478411(0x1dc),_0x22ddd2['fedapayApiKey']||'');const _0x3c402d=new Blob([_0x58d3db],{'type':_0x478411(0x20d)}),_0x329c16=URL[_0x478411(0x20e)](_0x3c402d),_0x2eec92=document[_0x478411(0x27f)]('a');_0x2eec92[_0x478411(0x1f0)]=_0x329c16,_0x2eec92[_0x478411(0x240)]=_0x46225f,document['body'][_0x478411(0x279)](_0x2eec92),_0x2eec92[_0x478411(0x288)](),document[_0x478411(0x280)][_0x478411(0x262)](_0x2eec92),URL[_0x478411(0x1f3)](_0x329c16);const _0x12a5ac=document[_0x478411(0x27f)]('a');_0x12a5ac[_0x478411(0x1f0)]=_0x478411(0x256),_0x12a5ac[_0x478411(0x240)]='firebase-config-manager.js',document['body']['appendChild'](_0x12a5ac),_0x12a5ac[_0x478411(0x288)](),document[_0x478411(0x280)][_0x478411(0x262)](_0x12a5ac),hideLoader();}catch(_0x27999d){console['error']('Erreur\x20lors\x20du\x20téléchargement\x20du\x20portail\x20captif:',_0x27999d),alert('Erreur\x20lors\x20du\x20téléchargement\x20du\x20portail\x20captif.'),hideLoader();}}window['downloadLoginFile']=downloadLoginFile;function _0x2802(_0x442100,_0x10627c){const _0x716029=_0x7160();return _0x2802=function(_0x280295,_0x20e077){_0x280295=_0x280295-0x1bf;let _0x33f004=_0x716029[_0x280295];return _0x33f004;},_0x2802(_0x442100,_0x10627c);}async function loadPortalConfig(){const _0x4af4b6=_0x420eec;showLoader();const _0x252e74=sessionStorage[_0x4af4b6(0x27d)]('currentUserId');if(!_0x252e74){console['error'](_0x4af4b6(0x26b)),hideLoader();return;}try{const _0x1db69f=ref(db,_0x4af4b6(0x264)+_0x252e74+_0x4af4b6(0x1fa)),_0x48edc0=await get(_0x1db69f);if(_0x48edc0[_0x4af4b6(0x242)]()){const _0x3c3892=_0x48edc0[_0x4af4b6(0x286)]();document[_0x4af4b6(0x274)]('networkName')['value']=_0x3c3892[_0x4af4b6(0x212)]||'',document['getElementById'](_0x4af4b6(0x224))[_0x4af4b6(0x285)]=_0x3c3892[_0x4af4b6(0x224)]||'',document['getElementById'](_0x4af4b6(0x1fe))[_0x4af4b6(0x285)]=_0x3c3892['fedapayApiKey']||'',document[_0x4af4b6(0x274)](_0x4af4b6(0x228))[_0x4af4b6(0x285)]=_0x3c3892[_0x4af4b6(0x228)]||'separate',document[_0x4af4b6(0x274)]('networkNameDisplay')['textContent']=_0x3c3892[_0x4af4b6(0x212)]||'ADMIN\x20WIFI\x20ZONE';function _0x48e2a2(_0x3bfdf9,_0x3f395c,_0x2cecd2){const _0x558592=_0x4af4b6,_0x44c18a=document[_0x558592(0x274)](_0x3bfdf9);_0x44c18a['innerHTML']='',_0x3f395c['forEach'](_0x5f3454=>{const _0x4569ea=_0x558592,_0x34ee98=document[_0x4569ea(0x27f)](_0x4569ea(0x1c2));_0x34ee98[_0x4569ea(0x22a)]='list-item',_0x3bfdf9===_0x4569ea(0x1c7)?_0x34ee98[_0x4569ea(0x277)]=_0x4569ea(0x211)+_0x5f3454[_0x4569ea(0x28b)]+_0x4569ea(0x20a)+_0x5f3454[_0x4569ea(0x201)]+'\x22\x20data-type=\x22tariffPrice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20onclick=\x22removeListItem(this)\x22>Supprimer</button>':_0x34ee98[_0x4569ea(0x277)]=_0x4569ea(0x246)+_0x5f3454+'\x22\x20data-type=\x22'+_0x2cecd2+_0x4569ea(0x26f),_0x44c18a[_0x4569ea(0x279)](_0x34ee98);}),addListItem(_0x3bfdf9);}_0x48e2a2(_0x4af4b6(0x1c7),_0x3c3892[_0x4af4b6(0x271)]||[],null),_0x48e2a2(_0x4af4b6(0x1d3),_0x3c3892['connections']||[],'connection'),_0x48e2a2('productsList',_0x3c3892['products']||[],_0x4af4b6(0x208));}else console[_0x4af4b6(0x255)]('Aucune\x20configuration\x20trouvée.'),addListItem(_0x4af4b6(0x1c7)),addListItem(_0x4af4b6(0x1d3)),addListItem(_0x4af4b6(0x1eb));}catch(_0x1eaeae){console[_0x4af4b6(0x1c6)](_0x4af4b6(0x1cd),_0x1eaeae),alert(_0x4af4b6(0x267));}finally{hideLoader();}}document[_0x420eec(0x215)](_0x420eec(0x20b),async()=>{const _0x50e65e=_0x420eec;showPageLoader(),await initializeDatabase(),await checkLoginStatus(),loadPortalConfig(),processConnectedTickets()['then'](()=>checkSubscriptionStatus())['then'](()=>{hidePageLoader();})[_0x50e65e(0x1ef)](_0x13e8eb=>{const _0x91578a=_0x50e65e;console[_0x91578a(0x1c6)]('Erreur\x20lors\x20du\x20traitement\x20des\x20tickets\x20:',_0x13e8eb),hidePageLoader(),showNotification(_0x91578a(0x23c),_0x91578a(0x1c1));});}),window['redirectToSubscription']=redirectToSubscription,window[_0x420eec(0x229)]=redirectToSubscription;function closePaymentModal(){const _0xe7661a=_0x420eec;paymentModal[_0xe7661a(0x287)][_0xe7661a(0x1d5)]='none',overlay['style']['display']=_0xe7661a(0x28e);}window[_0x420eec(0x222)]=()=>{};
    </script>

</body>
</html>