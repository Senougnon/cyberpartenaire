<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMIN WIFI ZONE</title>
    <link rel="stylesheet" href="styleA.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
    <script src="https://cdn.fedapay.com/checkout.js?v=1.1.7"></script>

    <style>
        /* ... (Styles CSS - Pas de modifications majeures, juste des ajustements pour le formulaire) ... */
       /* Style pour le modal de paiement */
       .payment-modal {
           display: none;
           position: fixed;
           top: 50%;
           left: 50%;
           transform: translate(-50%, -50%);
           background-color: white;
           padding: 30px;
           border-radius: 10px;
           box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
           z-index: 1000;
           max-width: 400px;
           width: 90%;
           text-align: center;
       }

       .payment-modal h2 {
           color: #333;
           margin-bottom: 20px;
       }

       .payment-modal p {
           color: #666;
           margin-bottom: 30px;
       }

       .payment-modal button {
           background-color: #fdbb2d;
           color: #1a2a6c;
           border: none;
           padding: 12px 20px;
           border-radius: 25px;
           cursor: pointer;
           transition: all 0.3s;
           font-weight: 600;
           font-size: 0.9rem;
           margin: 0 10px;
       }

       .payment-modal button:hover {
           background-color: #e6a727;
       }

       .close-modal {
           position: absolute;
           top: 10px;
           right: 10px;
           cursor: pointer;
           font-size: 1.2rem;
           color: #333;
       }

       /* Style pour l'overlay */
       .overlay {
           display: none;
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background-color: rgba(0, 0, 0, 0.5);
           z-index: 999;
       }
       #subscriptionSection {
           text-align: center;
           margin-bottom: 30px;
       }

       #subscriptionSection h2 {
           font-size: 24px;
           color: #fdbb2d;
           margin-bottom: 20px;
       }

       #subscriptionStatus {
           font-size: 18px;
           color: #fff;
           margin-bottom: 20px;
       }

       .subscription-buttons {
           display: flex;
           justify-content: center;
           gap: 20px;
       }

       .subscription-buttons button {
           background-color: #fdbb2d;
           color: #1a2a6c;
           border: none;
           padding: 12px 20px;
           border-radius: 25px;
           cursor: pointer;
           transition: all 0.3s;
           font-weight: 600;
           font-size: 0.9rem;
       }

       .subscription-buttons button:hover {
           background-color: #e6a727;
       }

       /* Style pour le message d'abonnement requis */
       .subscription-required {
           display: none;
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background-color: rgba(0, 0, 0, 0.5);
           z-index: 1000;
           justify-content: center;
           align-items: center;
           color: white;
           text-align: center;
           padding: 20px;
       }

       .subscription-required-content {
           background-color: white;
           padding: 30px;
           border-radius: 10px;
           box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
           max-width: 400px;
           width: 90%;
       }

       .subscription-required-content h2 {
           color: #333;
           margin-bottom: 20px;
       }

       .subscription-required-content p {
           color: #666;
           margin-bottom: 30px;
       }

       .subscription-required-content button {
           background-color: #fdbb2d;
           color: #1a2a6c;
           border: none;
           padding: 12px 20px;
           border-radius: 25px;
           cursor: pointer;
           transition: all 0.3s;
           font-weight: 600;
           font-size: 0.9rem;
           margin: 0 10px;
       }

       .subscription-required-content button:hover {
           background-color: #e6a727;
       }
        .loader-wrapper {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1001;
        }

        .loader {
            position: absolute;
            top: 50%;
            left: 50%;
            border: 6px solid #f3f3f3;
            border-top: 6px solid #fdbb2d;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
            transform: translate(-50%, -50%);
        }

        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .page-loader-wrapper {
            display: flex;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1002;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .page-loader {
            border: 6px solid #f3f3f3;
            border-top: 6px solid #fdbb2d;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }

        .loader-message {
            color: white;
            margin-top: 16px;
            font-size: 1rem;
            text-align: center;
            max-width: 80%;
        }

        .header {
            display: flex; /* Added to align items */
            justify-content: center; /* MODIFICATION: Center content horizontally */
            align-items: center; /* Added to vertically align items */
            flex-direction: column; /* MODIFICATION: Stack items vertically */
            text-align: center; /* MODIFICATION: Center text within header */
        }

        .header h1 {
            margin: 0; /* Reset margin for h1 inside header */
        }

        .logout-button {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
        }

        .logout-button:hover {
            background-color: #c0392b;
        }
       /* Styles pour le formulaire de portail captif */
      #portalForm {
          display: none; /*Caché par défaut*/
          flex-direction: column;
          gap: 10px;
          max-width: 600px; /* Limite la largeur du formulaire */
          margin: 20px auto;
          padding: 20px;
          background-color: rgba(255, 255, 255, 0.1); /* Léger fond pour le formulaire */
          border-radius: 8px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.2); /* Ombre légère */
      }
      #portalForm label {
          color: #fdbb2d; /* Couleur pour les labels */
      }
      #portalForm input[type="text"],
      #portalForm input[type="number"],
      #portalForm textarea,
      #portalForm select {
          width: 100%;
          padding: 10px;
          border: 1px solid #ddd;
          border-radius: 4px;
          background-color: rgba(255,255,255,0.2); /* Fond transparent */
          color: white; /* Couleur du texte */
      }

      #portalForm button {
          padding: 10px 15px;
          background-color: #fdbb2d;
          color: #1a2a6c;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          font-size: 16px;
      }

      #portalForm button:hover {
          background-color: #e6a727;
      }
      #portalForm .list-input-container {
          display: flex;
          flex-direction: column;
      }

      #portalForm .list-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

      #portalForm .list-item input {
          flex: 1; /* Permet à l'input de prendre l'espace disponible */
          margin-right: 5px; /* Marge entre l'input et le bouton */
      }
        #portalForm .list-item button {
           padding: 5px 10px;
           background-color: #e74c3c; /* Couleur différente pour le bouton de suppression */
           color: white;
           border: none;
           border-radius: 4px;
           cursor: pointer;
           font-size: 14px;
        }

        #portalForm .list-item button:hover {
           background-color: #c0392b;
        }

        #configSection {
          margin-bottom:           20px;
          text-align: center; /* Center-align the buttons */
      }
        #configSection .config-buttons {
          display: inline-block;
          margin: 0 10px;
        }

    </style>
</head>
<body>
    <div class="page-loader-wrapper" id="pageLoaderWrapper">
        <div class="page-loader"></div>
        <div class="loader-message" id="pageLoaderMessage">Initialisation...</div>
    </div>
    <div class="loader-wrapper" id="loaderWrapper">
        <div class="loader"></div>
    </div>
    <div class="container" id="contentContainer" style="display:none;">
        <header class="header">
            <h1 id="networkNameDisplay">ADMIN WIFI ZONE</h1>
            <div class="wave"></div>
        </header>


        <main>
            <div id="subscriptionSection">
                <h2>Statut de l'Abonnement</h2>
                <div id="subscriptionStatus"></div>
                <div class="subscription-button">
                    <button id="subscribeMonthly">S'abonner (Mensuel - 1000 FCFA)</button>
                    <button id="subscribeYearly">S'abonner (Annuel - 10 000 FCFA)</button>
                </div>
            </div>

            <div id="configSection">
              <button onclick="togglePortalForm()" id="togglePortalFormBtn">Configurer le portail captif</button>
              <button onclick="downloadLoginFile()" id="downloadLoginBtn" style="display: none;">Télécharger le portail captif</button>
             </div>


            <form id="portalForm" style="display: none;">
                <label for="networkName">Nom du réseau:</label>
                <input type="text" id="networkName" name="networkName" required>

                <label for="contactNumber">Numéro à contacter:</label>
                <input type="text" id="contactNumber" name="contactNumber" required>

                <label for="fedapayApiKey">Clé API FedaPay:</label>
                <input type="text" id="fedapayApiKey" name="fedapayApiKey" required>

                <label for="loginMode">Mode de connexion par défaut :</label>
                <select id="loginMode" name="loginMode">
                    <option value="separate">Nom d'utilisateur et Mot de passe</option>
                    <option value="same">Identifiant unique</option>
                    <option value="pay">Page de paiement</option> <!-- Nouvelle option -->
                </select>

                <div class="list-input-container">
                    <label>Tarifs:</label>
                    <div id="tariffsList">
                        <div class="list-item">
                            <input type="text" placeholder="Nom du tarif" data-type="tariffName">
                            <input type="number" placeholder="Prix" data-type="tariffPrice">
                            <button type="button" onclick="addListItem('tariffsList')">Ajouter</button>
                         </div>
                      </div>
                 </div>

                 <div class="list-input-container">
                      <label>Adresses de connexion:</label>
                      <div id="connectionsList">
                         <div class="list-item">
                            <input type="text" placeholder="Adresse" data-type="connection">
                            <button type="button" onclick="addListItem('connectionsList')">Ajouter</button>
                           </div>
                      </div>
                  </div>

                  <div class="list-input-container">
                      <label>Services et produits:</label>
                      <div id="productsList">
                         <div class="list-item">
                             <input type="text" placeholder="Service/Produit" data-type="product">
                             <button type="button" onclick="addListItem('productsList')">Ajouter</button>
                         </div>
                     </div>
                 </div>

                 <button type="submit">Enregistrer la configuration</button>
             </form>

            <div class="menu">
                <a href="PageVenteTicket.html" class="menu-item" id="vente">
                    <i class="fas fa-ticket-alt"></i> <!-- Font Awesome Ticket Icon -->
                    <h2>Vente de Tickets</h2>
                    <p>Procédez à la vente de nouveaux tickets Wifi.</p>
                </a>
                <a href="AdminVentePartenaires.html" class="menu-item" id="inventaire">
                    <i class="fas fa-clipboard-list"></i> <!-- Font Awesome Clipboard List Icon -->
                    <h2>Inventaire des Tickets</h2>
                    <p>Consultez l'état des ventes de vos partenaires.</p>
                </a>
                <a href="Stock.html" class="menu-item" id="stock">
                    <i class="fas fa-boxes"></i> <!-- Font Awesome Boxes Icon -->
                    <h2>Gestion des Stocks Partenaire</h2>
                    <p>Suivez les stocks de tickets de vos partenaires.</p>
                </a>
                <a href="a3.html" class="menu-item" id="administration">
                    <i class="fas fa-cog"></i> <!-- Font Awesome Settings Cog Icon -->
                    <h2>Administration des Tickets</h2>
                    <p>Gérez les tickets, activez ou désactivez-les.</p>
                </a>
                <button onclick="logout()" class="logout-button">Déconnexion</button>
            </div>

        </main>

    </div>


    <div id="paymentModal" class="payment-modal" style="display: none;">
        <span class="close-modal" onclick="closePaymentModal()">×</span>
        <h2>Paiement de l'Abonnement</h2>
        <p>Choisissez votre plan d'abonnement et procédez au paiement via FedaPay.</p>
        <!-- Les boutons de paiement seront ajoutés ici par le script -->
    </div>

    <div id="subscriptionRequiredModal" class="subscription-required" style="display: none;">
        <div class="subscription-required-content">
            <h2>Abonnement Requis</h2>
            <p>Un abonnement actif est nécessaire pour accéder à cette fonctionnalité.</p>
            <button onclick="redirectToSubscription()">S'abonner</button>
            <button onclick="hideSubscriptionRequiredModal()">Fermer</button>
        </div>
    </div>

    <div class="overlay" id="overlay" style="display: none;" onclick="closePaymentModal()"></div>

    <script type="module">
const _0x804e3f=_0x1fce;(function(_0x548421,_0x109d58){const _0x51dc34=_0x1fce,_0x1371cc=_0x548421();while(!![]){try{const _0x773abc=parseInt(_0x51dc34(0x121))/0x1+-parseInt(_0x51dc34(0x16b))/0x2+parseInt(_0x51dc34(0xfc))/0x3+parseInt(_0x51dc34(0x174))/0x4+parseInt(_0x51dc34(0x139))/0x5+-parseInt(_0x51dc34(0x152))/0x6+-parseInt(_0x51dc34(0x109))/0x7*(parseInt(_0x51dc34(0xe4))/0x8);if(_0x773abc===_0x109d58)break;else _0x1371cc['push'](_0x1371cc['shift']());}catch(_0x4bcc34){_0x1371cc['push'](_0x1371cc['shift']());}}}(_0x1449,0x43b98));import{getActiveDatabase}from'./firebase-config-manager.js';import{ref,get,set,push,remove,update}from'https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js';let db,adminRef;async function initializeDatabase(){const _0x47a90b=_0x1fce;db=await getActiveDatabase(),console[_0x47a90b(0xe5)](_0x47a90b(0xe8));}async function checkLoginStatus(){const _0xc22776=_0x1fce;if(sessionStorage[_0xc22776(0x125)](_0xc22776(0x17d))!=='true')redirectToLogin();else{const _0x4ef91e=sessionStorage['getItem'](_0xc22776(0x168));if(!_0x4ef91e){console['error'](_0xc22776(0x14d)),redirectToLogin();return;}document['getElementById']('contentContainer')[_0xc22776(0xec)][_0xc22776(0x1ae)]='block',adminRef=ref(db,_0xc22776(0x167)+_0x4ef91e+_0xc22776(0x170));}}function redirectToLogin(){const _0x3e485e=_0x1fce;window[_0x3e485e(0x10b)][_0x3e485e(0x19b)]=_0x3e485e(0x1a9);}window[_0x804e3f(0x1b4)]=function(){const _0xdcf013=_0x804e3f;sessionStorage[_0xdcf013(0xeb)](),redirectToLogin();};const venteMenuItem=document[_0x804e3f(0x17c)]('vente'),inventaireMenuItem=document[_0x804e3f(0x17c)]('inventaire'),stockMenuItem=document[_0x804e3f(0x17c)](_0x804e3f(0x132)),administrationMenuItem=document[_0x804e3f(0x17c)](_0x804e3f(0x127)),subscriptionStatus=document[_0x804e3f(0x17c)]('subscriptionStatus'),subscribeMonthlyButton=document['getElementById'](_0x804e3f(0x1aa)),subscribeYearlyButton=document[_0x804e3f(0x17c)](_0x804e3f(0x13e)),paymentModal=document[_0x804e3f(0x17c)](_0x804e3f(0x190)),overlay=document[_0x804e3f(0x17c)](_0x804e3f(0x149)),subscriptionRequiredModal=document[_0x804e3f(0x17c)](_0x804e3f(0x15e));function _0x1449(){const _0x1b0f6f=['tariffs','preventDefault','Vous\x20devez\x20être\x20connecté\x20pour\x20télécharger\x20le\x20portail.','loginMode','[data-type=\x22tariffPrice\x22]','Erreur\x20lors\x20du\x20traitement\x20des\x20tickets\x20connectés\x20:','Nettoyage\x20des\x20tickets\x20traités...','toISOString','stock','log.html','Abonnement\x20annulé.','Current\x20user\x20ID\x20is\x20not\x20provided\x20to\x20processTicket.','/TicketsTotal/','Erreur\x20lors\x20du\x20téléchargement\x20du\x20portail\x20captif.','pageLoaderMessage','1894050zQeAHC','<!--\x20ADMIN_USER_ID\x20-->','Admin\x20ID\x20not\x20found\x20in\x20session\x20storage.','Abonnement\x20mensuel','text/html','subscribeYearly','togglePortalForm','[data-type=\x22tariffName\x22]','replace','Aucune\x20configuration\x20de\x20portail\x20captif\x20trouvée.','CHECKOUT_COMPLETED','Vendeur\x20automatique','tariffsList','/VendorsHistory/','<input\x20type=\x22text\x22\x20value=\x22','filter','overlay','toLocaleDateString','revokeObjectURL','<ul>','Current\x20user\x20ID\x20is\x20not\x20found\x20in\x20sessionStorage.','<!--\x20NETWORK_NAME\x20-->','</ul>','loaderWrapper','<table\x20style=\x22width:\x20100%;\x20border-collapse:\x20collapse;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Catégorie</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Prix\x20(FCFA)</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>','1190670buspyL','addEventListener','<!--\x20CONNECTION_LOCATIONS\x20-->','<!--\x20CONTACT_NUMBER\x20-->','Traitement\x20du\x20ticket\x20','User\x20ID\x20not\x20found.\x20Cannot\x20check\x20subscription\x20status.','submit','portalForm','Stock.html','Erreur\x20lors\x20de\x20la\x20vérification\x20du\x20statut\x20d\x27abonnement:','downloadLoginBtn','User\x20ID\x20not\x20found.\x20Cannot\x20save\x20portal\x20configuration.','subscriptionRequiredModal','onload','connections','Current\x20user\x20ID\x20is\x20not\x20provided\x20to\x20sellTicketAutomatically.','Erreur\x20lors\x20du\x20téléchargement\x20du\x20portail\x20captif:','error','forEach','login.html','Erreur\x20lors\x20de\x20l\x27enregistrement\x20de\x20la\x20configuration.','users-data/','currentUserId','none','slice','687764yrLQWb','yearly','fedapayApiKey','Vous\x20devez\x20être\x20connecté\x20pour\x20vous\x20abonner.','Erreur\x20lors\x20de\x20la\x20mise\x20à\x20jour\x20de\x20l\x27abonnement:','/admin/subscription','addListItem','Erreur','\x22\x20data-type=\x22tariffPrice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20onclick=\x22removeListItem(this)\x22>Supprimer</button>','1714624QGJwbO','mensuel','annuel','#productsList\x20.list-item\x20input','text','Vente\x20du\x20ticket\x20','redirectToSubscription','Erreur\x20lors\x20du\x20traitement\x20du\x20ticket\x20:','getElementById','isLoggedIn','red','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20placeholder=\x22Nom\x20du\x20tarif\x22\x20data-type=\x22tariffName\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20placeholder=\x22Prix\x22\x20data-type=\x22tariffPrice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20onclick=\x22removeListItem(this)\x22>Supprimer</button>','Configurer\x20le\x20portail\x20captif','catch','Ticket\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','username','Statut\x20de\x20l\x27abonnement:\x20Actif\x20jusqu\x27au\x20','...','connectionsList','/TicketsTransit','User\x20ID\x20not\x20found.\x20Cannot\x20load\x20portal\x20configuration.','\x27,\x20','networkNameDisplay','pay','\x22\x20placeholder=\x22','User\x20ID\x20not\x20found.\x20Cannot\x20cancel\x20subscription.','pk_live_TfSz212W0xSMKK7oPEogkFmp','paymentModal','monthly','<!--\x20FEDAPAY_API_KEY\x20-->','cancelled','Vous\x20devez\x20être\x20connecté\x20pour\x20annuler\x20un\x20abonnement.','remove','user','removeChild','expired','TicketsTotal','CYBER\x20CAMPUS\x20WIFI\x20ZONE','href','now','endDate','DOMContentLoaded','User\x20ID\x20not\x20found.\x20Cannot\x20initiate\x20payment.','textContent','Masquer\x20le\x20formulaire','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22>','prix','flex','Une\x20erreur\x20est\x20survenue\x20lors\x20du\x20traitement\x20des\x20tickets.','value','click','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','loginAccueil.html','subscribeMonthly','getMonth','exists','downloadLoginFile','display','push','init','Paiement\x20échoué.','Statut\x20de\x20l\x27abonnement:\x20Expiré','getFullYear','logout','reason','appendChild','setMonth','list-item','same','/TicketConnecté','querySelectorAll','</li>','removeListItem','innerHTML','togglePortalFormBtn','products','utilisateur','parentNode','admin@example.com','color','Traitement\x20des\x20tickets\x20uniques...','Erreur\x20lors\x20de\x20la\x20vente\x20automatique\x20du\x20ticket.','\x22\x20data-type=\x22','</tbody></table>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22>','\x20réussi!','Une\x20erreur\x20est\x20survenue\x20lors\x20de\x20l\x27initialisation.','16tJpPua','log','name','className','Database\x20initialized\x20in\x20index.html','transaction','ADMIN\x20WIFI\x20ZONE','clear','style','+229\x20XXXXXXXX','body','green','category','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table\x20style=\x22width:\x20100%;\x20border-collapse:\x20collapse;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Catégorie</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Prix\x20(FCFA)</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Action</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','productsList','Erreur:\x20ID\x20administrateur\x20non\x20trouvé.\x20Veuillez\x20vous\x20reconnecter.','connection','hideSubscriptionRequiredModal','active','createObjectURL','User\x20ID\x20not\x20found.\x20Cannot\x20download\x20login\x20file.','<!--\x20PRODUCTS_LIST\x20-->','Configuration\x20du\x20portail\x20captif\x20enregistrée\x20avec\x20succès!','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20value=\x22','171867AJwrvx','password','pay.html','download','Erreur\x20lors\x20du\x20chargement\x20de\x20la\x20configuration:','networkName','trim','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22>','open','createElement','#tariffsList\x20.list-item','<!--\x20TARIFFS_TABLE\x20-->','updatedData','552601HaewAb','contactNumber','location','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22><button\x20onclick=\x22initPayment(\x27','inline-block','Aucune\x20configuration\x20trouvée.','then','Erreur\x20lors\x20du\x20chargement\x20de\x20la\x20configuration.','Mode\x20de\x20connexion\x20invalide.','Abonnement\x20','/VendorsHistory','Erreur\x20lors\x20de\x20l\x27enregistrement\x20de\x20la\x20configuration:','price','/portalConfig','<!--\x20TARIFFS_TABLE_SIMPLE\x20-->','product','DIALOG_DISMISSED','Vérification\x20du\x20ticket\x20pour\x20','Vous\x20devez\x20être\x20connecté\x20pour\x20configurer\x20le\x20portail.',')\x22>Payer</button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<li>','a3.html','firebase-config-manager.js','querySelector','112858vHeRKF','Erreur\x20lors\x20du\x20traitement\x20des\x20tickets\x20:','div','val','getItem','pageLoaderWrapper','administration','TicketsTransit','motDePasse'];_0x1449=function(){return _0x1b0f6f;};return _0x1449();}function showLoader(){const _0x30c0a0=_0x804e3f;document[_0x30c0a0(0x17c)](_0x30c0a0(0x150))[_0x30c0a0(0xec)]['display']='block';}function hideLoader(){const _0x1a8b5e=_0x804e3f;document[_0x1a8b5e(0x17c)](_0x1a8b5e(0x150))[_0x1a8b5e(0xec)][_0x1a8b5e(0x1ae)]=_0x1a8b5e(0x169);}function showPageLoader(){const _0x224274=_0x804e3f;document['getElementById'](_0x224274(0x126))[_0x224274(0xec)]['display']=_0x224274(0x1a4);}function hidePageLoader(){const _0x3022ba=_0x804e3f;document['getElementById'](_0x3022ba(0x126))[_0x3022ba(0xec)]['display']='none';}function showSubscriptionRequiredModal(){const _0x1a1df7=_0x804e3f;subscriptionRequiredModal[_0x1a1df7(0xec)][_0x1a1df7(0x1ae)]=_0x1a1df7(0x1a4);}function hideSubscriptionRequiredModal(){const _0x49d830=_0x804e3f;subscriptionRequiredModal[_0x49d830(0xec)][_0x49d830(0x1ae)]=_0x49d830(0x169);}function redirectToSubscription(){hideSubscriptionRequiredModal();}function checkSubscriptionStatus(){const _0x3ed6fb=_0x804e3f,_0x1aead4=sessionStorage[_0x3ed6fb(0x125)](_0x3ed6fb(0x168));if(!_0x1aead4){console[_0x3ed6fb(0x163)](_0x3ed6fb(0x157));return;}const _0x2e097b=ref(db,'users-data/'+_0x1aead4+_0x3ed6fb(0x170));get(_0x2e097b)['then'](_0x289af6=>{const _0x534cf3=_0x3ed6fb,_0x3a1fa5=_0x289af6[_0x534cf3(0x124)](),_0x5af127=new Date();if(_0x3a1fa5&&_0x3a1fa5['status']===_0x534cf3(0xf6)){const _0x4d36f4=new Date(_0x3a1fa5[_0x534cf3(0x19d)]);_0x4d36f4<_0x5af127?(subscriptionStatus[_0x534cf3(0x1a0)]=_0x534cf3(0x1b2),subscriptionStatus[_0x534cf3(0xec)][_0x534cf3(0xdc)]='red',subscribeMonthlyButton[_0x534cf3(0xec)][_0x534cf3(0x1ae)]=_0x534cf3(0x10d),subscribeYearlyButton[_0x534cf3(0xec)][_0x534cf3(0x1ae)]=_0x534cf3(0x10d),set(_0x2e097b,{..._0x3a1fa5,'status':_0x534cf3(0x198)})):(subscriptionStatus[_0x534cf3(0x1a0)]=_0x534cf3(0x185)+_0x4d36f4[_0x534cf3(0x14a)](),subscriptionStatus[_0x534cf3(0xec)]['color']=_0x534cf3(0xef),subscribeMonthlyButton[_0x534cf3(0xec)][_0x534cf3(0x1ae)]=_0x534cf3(0x169),subscribeYearlyButton[_0x534cf3(0xec)]['display']=_0x534cf3(0x169));}else subscriptionStatus[_0x534cf3(0x1a0)]='Statut\x20de\x20l\x27abonnement:\x20Inactif',subscriptionStatus[_0x534cf3(0xec)][_0x534cf3(0xdc)]=_0x534cf3(0x17e),subscribeMonthlyButton['style'][_0x534cf3(0x1ae)]=_0x534cf3(0x10d),subscribeYearlyButton[_0x534cf3(0xec)][_0x534cf3(0x1ae)]=_0x534cf3(0x10d);})[_0x3ed6fb(0x181)](_0x447031=>{const _0x2579b2=_0x3ed6fb;console['error'](_0x2579b2(0x15b),_0x447031);});}function checkUserAccess(){const _0x51dd8d=_0x804e3f;get(adminRef)[_0x51dd8d(0x10f)](_0x43c52e=>{const _0x1784ab=_0x51dd8d,_0x2dfddc=_0x43c52e['val']();(!_0x2dfddc||_0x2dfddc['status']!==_0x1784ab(0xf6))&&showSubscriptionRequiredModal();});}venteMenuItem['addEventListener'](_0x804e3f(0x1a7),_0x1ddc08=>{const _0x34a142=_0x804e3f;_0x1ddc08['preventDefault'](),checkUserAccess();const _0x5eb2dc=sessionStorage[_0x34a142(0x125)](_0x34a142(0x168));_0x5eb2dc?window[_0x34a142(0x10b)][_0x34a142(0x19b)]='PageVenteTicket.html?adminId='+_0x5eb2dc:(console[_0x34a142(0x163)](_0x34a142(0x13b)),alert(_0x34a142(0xf3)));}),inventaireMenuItem[_0x804e3f(0x153)](_0x804e3f(0x1a7),_0x2858e1=>{const _0x18dcad=_0x804e3f;_0x2858e1[_0x18dcad(0x12b)](),checkUserAccess(),window[_0x18dcad(0x10b)][_0x18dcad(0x19b)]='AdminVentePartenaires.html';}),stockMenuItem[_0x804e3f(0x153)](_0x804e3f(0x1a7),_0x5062a8=>{const _0x5b71e5=_0x804e3f;_0x5062a8[_0x5b71e5(0x12b)](),checkUserAccess(),window[_0x5b71e5(0x10b)][_0x5b71e5(0x19b)]=_0x5b71e5(0x15a);}),administrationMenuItem[_0x804e3f(0x153)](_0x804e3f(0x1a7),_0x4171ea=>{const _0x672d2e=_0x804e3f;_0x4171ea[_0x672d2e(0x12b)](),checkUserAccess(),window[_0x672d2e(0x10b)][_0x672d2e(0x19b)]=_0x672d2e(0x11e);}),subscribeMonthlyButton[_0x804e3f(0x153)]('click',()=>{const _0x340fef=_0x804e3f;initiatePayment(_0x340fef(0x191));}),subscribeYearlyButton[_0x804e3f(0x153)]('click',()=>{const _0xcdbfe4=_0x804e3f;initiatePayment(_0xcdbfe4(0x16c));});function _0x1fce(_0x76b0ae,_0x15c4e3){const _0x144926=_0x1449();return _0x1fce=function(_0x1fce44,_0x43a182){_0x1fce44=_0x1fce44-0xd8;let _0x5154b6=_0x144926[_0x1fce44];return _0x5154b6;},_0x1fce(_0x76b0ae,_0x15c4e3);}function initiatePayment(_0x5bd3f8){const _0x5a84dc=_0x804e3f,_0x5950f4=_0x5bd3f8===_0x5a84dc(0x191)?0x3e8:0x2710,_0x5be2a0=_0x5bd3f8===_0x5a84dc(0x191)?_0x5a84dc(0x13c):'Abonnement\x20annuel',_0x14590e=sessionStorage[_0x5a84dc(0x125)](_0x5a84dc(0x168));if(!_0x14590e){console[_0x5a84dc(0x163)](_0x5a84dc(0x19f)),alert(_0x5a84dc(0x16e));return;}FedaPay[_0x5a84dc(0x1b0)]({'public_key':_0x5a84dc(0x18f),'transaction':{'amount':_0x5950f4,'description':_0x5be2a0},'customer':{'email':_0x5a84dc(0xdb)},'onComplete':async function(_0x1aaf0e){const _0x4d309e=_0x5a84dc;if(_0x1aaf0e[_0x4d309e(0x1b5)]===FedaPay[_0x4d309e(0x119)])alert(_0x4d309e(0x1b1));else _0x1aaf0e[_0x4d309e(0x1b5)]===FedaPay[_0x4d309e(0x143)]&&handleSuccessfulPayment(_0x5bd3f8,_0x1aaf0e,_0x14590e);}})[_0x5a84dc(0x104)]();}async function handleSuccessfulPayment(_0x374f98,_0x565985,_0x27018c){const _0x16c50a=_0x804e3f,_0x55222c=new Date(),_0xffa857=new Date(_0x55222c);_0x374f98===_0x16c50a(0x191)?_0xffa857[_0x16c50a(0x1b7)](_0xffa857[_0x16c50a(0x1ab)]()+0x1):_0xffa857['setFullYear'](_0xffa857[_0x16c50a(0x1b3)]()+0x1);const _0x4c24eb={'status':_0x16c50a(0xf6),'startDate':_0x55222c[_0x16c50a(0x131)](),'endDate':_0xffa857['toISOString'](),'transactionId':_0x565985[_0x16c50a(0xe9)]['id'],'plan':_0x374f98};try{const _0x531413=ref(db,_0x16c50a(0x167)+_0x27018c+_0x16c50a(0x170));await set(_0x531413,_0x4c24eb),checkSubscriptionStatus(),alert(_0x16c50a(0x112)+(_0x374f98===_0x16c50a(0x191)?_0x16c50a(0x175):_0x16c50a(0x176))+_0x16c50a(0xe2));}catch(_0x85f51a){console[_0x16c50a(0x163)](_0x16c50a(0x16f),_0x85f51a),alert('Erreur\x20lors\x20de\x20la\x20mise\x20à\x20jour\x20de\x20l\x27abonnement.');}}async function cancelSubscription(){const _0x26d0f6=_0x804e3f,_0x39a56c=sessionStorage[_0x26d0f6(0x125)](_0x26d0f6(0x168));if(!_0x39a56c){console['error'](_0x26d0f6(0x18e)),alert(_0x26d0f6(0x194));return;}try{const _0x34d6dd=ref(db,_0x26d0f6(0x167)+_0x39a56c+'/admin/subscription');await set(_0x34d6dd,{...(await get(_0x34d6dd))[_0x26d0f6(0x124)](),'status':_0x26d0f6(0x193)}),checkSubscriptionStatus(),alert(_0x26d0f6(0x134));}catch(_0x4d2ff6){console[_0x26d0f6(0x163)]('Erreur\x20lors\x20de\x20l\x27annulation\x20de\x20l\x27abonnement:',_0x4d2ff6),alert('Erreur\x20lors\x20de\x20l\x27annulation\x20de\x20l\x27abonnement.');}}async function processConnectedTickets(){const _0x455acb=_0x804e3f,_0x2ebc70=document[_0x455acb(0x17c)]('pageLoaderMessage'),_0x478063=sessionStorage[_0x455acb(0x125)](_0x455acb(0x168));if(!_0x478063){console[_0x455acb(0x163)](_0x455acb(0x14d));return;}const _0x3770c1=ref(db,_0x455acb(0x167)+_0x478063+_0x455acb(0x1ba));try{_0x2ebc70[_0x455acb(0x1a0)]='Vérification\x20des\x20tickets\x20connectés...';const _0x1595c6=await get(_0x3770c1);let _0x59dfbf=_0x1595c6[_0x455acb(0x124)]()||{};const _0x840656={};for(const _0x1b1a4d in _0x59dfbf){const _0x543cff=_0x59dfbf[_0x1b1a4d][_0x455acb(0x184)];!_0x840656[_0x543cff]&&(_0x840656[_0x543cff]=_0x59dfbf[_0x1b1a4d]);}_0x2ebc70[_0x455acb(0x1a0)]=_0x455acb(0xdd);for(const _0x2f1264 in _0x840656){await processTicket(_0x840656[_0x2f1264],_0x478063);}_0x2ebc70[_0x455acb(0x1a0)]=_0x455acb(0x130),await remove(_0x3770c1);}catch(_0x356757){console[_0x455acb(0x163)](_0x455acb(0x12f),_0x356757),showNotification('Erreur',_0x455acb(0x1a5));}}async function processTicket(_0x7aa3e1,_0x44fc0a){const _0x3e5e75=_0x804e3f,_0x4a45d1=document['getElementById'](_0x3e5e75(0x138));if(!_0x44fc0a){console[_0x3e5e75(0x163)](_0x3e5e75(0x135));return;}try{_0x4a45d1['textContent']=_0x3e5e75(0x11a)+_0x7aa3e1['username']+_0x3e5e75(0x186);const _0x439a88=ref(db,'users-data/'+_0x44fc0a+_0x3e5e75(0x113)),_0x263afb=await get(_0x439a88),_0x2036e6=_0x263afb['val']()||{};let _0x50d454=![];for(const _0x23b67d in _0x2036e6){const _0x2f2192=_0x2036e6[_0x23b67d];for(const _0x23761b in _0x2f2192){if(_0x2f2192[_0x23761b]['user']===_0x7aa3e1[_0x3e5e75(0x184)]){_0x50d454=!![];break;}}if(_0x50d454)break;}if(!_0x50d454){_0x4a45d1[_0x3e5e75(0x1a0)]=_0x3e5e75(0x156)+_0x7aa3e1['username']+_0x3e5e75(0x186);const _0x3bf0ca=ref(db,_0x3e5e75(0x167)+_0x44fc0a+'/TicketsTotal'),_0x4d0640=ref(db,_0x3e5e75(0x167)+_0x44fc0a+_0x3e5e75(0x188)),_0x111bd1=await get(_0x3bf0ca),_0x223222=await get(_0x4d0640),_0x2e6142=_0x111bd1[_0x3e5e75(0x124)]()||{},_0x470cd3=_0x223222[_0x3e5e75(0x124)]()||{};let _0x388cdd=null,_0xd6a707=null,_0xb38d40=null;for(const _0x297be0 in _0x2e6142){const _0x2281f3=(_0x2e6142[_0x297be0]['utilisateur']||[])['indexOf'](_0x7aa3e1['username']);if(_0x2281f3>-0x1){_0x388cdd={'category':_0x297be0,'user':_0x2e6142[_0x297be0][_0x3e5e75(0xd9)][_0x2281f3],'password':_0x2e6142[_0x297be0][_0x3e5e75(0x129)][_0x2281f3],'price':_0x2e6142[_0x297be0]['prix'][_0x2281f3],'updatedData':{..._0x2e6142[_0x297be0],'utilisateur':_0x2e6142[_0x297be0][_0x3e5e75(0xd9)][_0x3e5e75(0x148)]((_0x242aec,_0x1c6e28)=>_0x1c6e28!==_0x2281f3),'motDePasse':_0x2e6142[_0x297be0][_0x3e5e75(0x129)][_0x3e5e75(0x148)]((_0x42b1a7,_0x175daa)=>_0x175daa!==_0x2281f3),'prix':_0x2e6142[_0x297be0][_0x3e5e75(0x1a3)][_0x3e5e75(0x148)]((_0x2900ed,_0x3cc828)=>_0x3cc828!==_0x2281f3)}},_0xd6a707=ref(db,_0x3e5e75(0x167)+_0x44fc0a+_0x3e5e75(0x136)+_0x297be0),_0xb38d40=_0x3e5e75(0x199);break;}}if(!_0x388cdd)for(const _0x5c6fff in _0x470cd3){if(_0x470cd3[_0x5c6fff]['user']===_0x7aa3e1[_0x3e5e75(0x184)]){_0x388cdd={'category':_0x470cd3[_0x5c6fff][_0x3e5e75(0xf0)],'user':_0x470cd3[_0x5c6fff]['user'],'password':_0x470cd3[_0x5c6fff][_0x3e5e75(0xfd)],'price':_0x470cd3[_0x5c6fff][_0x3e5e75(0x115)]},_0xd6a707=ref(db,'users-data/'+_0x44fc0a+'/TicketsTransit/'+_0x5c6fff),_0xb38d40=_0x3e5e75(0x128);break;}}_0x388cdd&&(_0x4a45d1['textContent']=_0x3e5e75(0x179)+_0x7aa3e1['username']+_0x3e5e75(0x186),await sellTicketAutomatically(_0x388cdd,_0xd6a707,_0xb38d40,_0x44fc0a));}}catch(_0x4245f4){console[_0x3e5e75(0x163)](_0x3e5e75(0x17b),_0x4245f4),showNotification(_0x3e5e75(0x172),'Erreur\x20lors\x20du\x20traitement\x20du\x20ticket\x20'+_0x7aa3e1[_0x3e5e75(0x184)]+'.');}}async function sellTicketAutomatically(_0x5886c0,_0x3d8709,_0x4c004f,_0x4079af){const _0x464fe0=_0x804e3f;if(!_0x4079af){console['error'](_0x464fe0(0x161));return;}try{const _0x2ea427=_0x464fe0(0x144),_0xa78dc3=ref(db,_0x464fe0(0x167)+_0x4079af+_0x464fe0(0x146)+_0x2ea427);await push(_0xa78dc3,{'category':_0x5886c0[_0x464fe0(0xf0)],'user':_0x5886c0[_0x464fe0(0x196)],'password':_0x5886c0[_0x464fe0(0xfd)],'price':_0x5886c0['price'],'soldAt':Date[_0x464fe0(0x19c)](),'vendorId':_0x2ea427}),_0x4c004f===_0x464fe0(0x199)?await set(_0x3d8709,_0x5886c0[_0x464fe0(0x108)]):await remove(_0x3d8709),console[_0x464fe0(0xe5)](_0x464fe0(0x182)+_0x5886c0[_0x464fe0(0x196)]+'\x20vendu\x20automatiquement\x20et\x20enregistré\x20dans\x20VendorsHistory.');}catch(_0x4ba79a){console[_0x464fe0(0x163)]('Erreur\x20lors\x20de\x20la\x20vente\x20automatique\x20du\x20ticket\x20:',_0x4ba79a),showNotification('Erreur',_0x464fe0(0xde));}}window[_0x804e3f(0x1b4)]=function(){const _0x30cf7a=_0x804e3f;sessionStorage[_0x30cf7a(0xeb)](),window[_0x30cf7a(0x10b)]['replace'](_0x30cf7a(0x1a9));},window[_0x804e3f(0x13f)]=function(){const _0x2f5bb2=_0x804e3f,_0x27b6a7=document[_0x2f5bb2(0x17c)](_0x2f5bb2(0x159)),_0x2c6343=document[_0x2f5bb2(0x17c)](_0x2f5bb2(0x1bf)),_0x5bb0f9=document[_0x2f5bb2(0x17c)](_0x2f5bb2(0x15c));_0x27b6a7[_0x2f5bb2(0xec)][_0x2f5bb2(0x1ae)]===_0x2f5bb2(0x169)||_0x27b6a7[_0x2f5bb2(0xec)][_0x2f5bb2(0x1ae)]===''?(_0x27b6a7['style'][_0x2f5bb2(0x1ae)]=_0x2f5bb2(0x1a4),_0x5bb0f9['style'][_0x2f5bb2(0x1ae)]=_0x2f5bb2(0x10d),_0x2c6343[_0x2f5bb2(0x1a0)]=_0x2f5bb2(0x1a1)):(_0x27b6a7['style'][_0x2f5bb2(0x1ae)]=_0x2f5bb2(0x169),_0x5bb0f9['style'][_0x2f5bb2(0x1ae)]=_0x2f5bb2(0x169),_0x2c6343['textContent']=_0x2f5bb2(0x180));},window[_0x804e3f(0x171)]=function(_0x4f2ae9){const _0x4da04a=_0x804e3f,_0x38dcfa=document['getElementById'](_0x4f2ae9),_0x21b7ac=document[_0x4da04a(0x105)]('div');_0x21b7ac[_0x4da04a(0xe7)]=_0x4da04a(0x1b8);let _0x22c361=_0x4da04a(0x178);if(_0x4f2ae9==='tariffsList')_0x21b7ac[_0x4da04a(0x1be)]=_0x4da04a(0x17f);else{let _0x41ddea='';if(_0x4f2ae9===_0x4da04a(0x187))_0x41ddea='Adresse';else _0x4f2ae9===_0x4da04a(0xf2)&&(_0x41ddea='Service/Produit');_0x21b7ac[_0x4da04a(0x1be)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22'+_0x22c361+_0x4da04a(0x18d)+_0x41ddea+_0x4da04a(0xdf)+_0x4f2ae9[_0x4da04a(0x16a)](0x0,-0x4)+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20onclick=\x22removeListItem(this)\x22>Supprimer</button>';}_0x38dcfa['appendChild'](_0x21b7ac);},window[_0x804e3f(0x1bd)]=function(_0xe0900d){const _0x5b8e6d=_0x804e3f;_0xe0900d[_0x5b8e6d(0xda)][_0x5b8e6d(0x195)]();},document['getElementById'](_0x804e3f(0x159))[_0x804e3f(0x153)](_0x804e3f(0x158),async _0x3598e9=>{const _0x50c889=_0x804e3f;_0x3598e9[_0x50c889(0x12b)](),showLoader();const _0x2f4df3=sessionStorage['getItem'](_0x50c889(0x168));if(!_0x2f4df3){console[_0x50c889(0x163)](_0x50c889(0x15d)),alert(_0x50c889(0x11b)),hideLoader();return;}const _0x59abb7={'networkName':document[_0x50c889(0x17c)](_0x50c889(0x101))['value'],'contactNumber':document[_0x50c889(0x17c)](_0x50c889(0x10a))[_0x50c889(0x1a6)],'fedapayApiKey':document['getElementById'](_0x50c889(0x16d))[_0x50c889(0x1a6)],'loginMode':document[_0x50c889(0x17c)](_0x50c889(0x12d))[_0x50c889(0x1a6)],'tariffs':[],'connections':[],'products':[]};document[_0x50c889(0x1bb)](_0x50c889(0x106))[_0x50c889(0x164)](_0x52951c=>{const _0x1e41c6=_0x50c889,_0x2217f8=_0x52951c[_0x1e41c6(0x120)](_0x1e41c6(0x140)),_0xfecc15=_0x52951c['querySelector'](_0x1e41c6(0x12e));if(_0x2217f8&&_0xfecc15){const _0xabe9c4=_0x2217f8[_0x1e41c6(0x1a6)]['trim'](),_0x509d46=parseFloat(_0xfecc15[_0x1e41c6(0x1a6)]);_0xabe9c4&&!isNaN(_0x509d46)&&_0x59abb7[_0x1e41c6(0x12a)][_0x1e41c6(0x1af)]({'name':_0xabe9c4,'price':_0x509d46});}}),document[_0x50c889(0x1bb)]('#connectionsList\x20.list-item\x20input')[_0x50c889(0x164)](_0x4a5f5e=>{const _0xec8ab6=_0x50c889,_0x556b10=_0x4a5f5e['value'][_0xec8ab6(0x102)]();_0x556b10&&_0x59abb7[_0xec8ab6(0x160)][_0xec8ab6(0x1af)](_0x556b10);}),document['querySelectorAll'](_0x50c889(0x177))[_0x50c889(0x164)](_0x56a5ac=>{const _0x4d832d=_0x50c889,_0x1efe24=_0x56a5ac[_0x4d832d(0x1a6)][_0x4d832d(0x102)]();_0x1efe24&&_0x59abb7[_0x4d832d(0xd8)]['push'](_0x1efe24);});try{const _0x40cefb=ref(db,_0x50c889(0x167)+_0x2f4df3+'/portalConfig');await set(_0x40cefb,_0x59abb7),alert(_0x50c889(0xfa)),hideLoader(),document[_0x50c889(0x17c)](_0x50c889(0x159))['reset'](),document[_0x50c889(0x17c)](_0x50c889(0x159))[_0x50c889(0xec)][_0x50c889(0x1ae)]='none',document[_0x50c889(0x17c)](_0x50c889(0x1bf))[_0x50c889(0x1a0)]=_0x50c889(0x180),document[_0x50c889(0x17c)](_0x50c889(0x15c))['style'][_0x50c889(0x1ae)]=_0x50c889(0x169),document['getElementById'](_0x50c889(0x18b))['textContent']=_0x59abb7[_0x50c889(0x101)];}catch(_0x593238){console[_0x50c889(0x163)](_0x50c889(0x114),_0x593238),alert(_0x50c889(0x166)),hideLoader();}});async function downloadLoginFile(){const _0xd81977=_0x804e3f;showLoader();const _0x2f99fb=sessionStorage[_0xd81977(0x125)](_0xd81977(0x168));if(!_0x2f99fb){console['error'](_0xd81977(0xf8)),hideLoader(),alert(_0xd81977(0x12c));return;}try{const _0x58e4f9=ref(db,_0xd81977(0x167)+_0x2f99fb+_0xd81977(0x116)),_0x575997=await get(_0x58e4f9);if(!_0x575997[_0xd81977(0x1ac)]()){alert(_0xd81977(0x142)),hideLoader();return;}const _0x444ba4=_0x575997['val']();let _0x3387ae='',_0x5de058='';if(_0x444ba4[_0xd81977(0x12d)]==='separate'){const _0x2efd89=await fetch(_0xd81977(0x165));_0x3387ae=await _0x2efd89['text'](),_0x5de058=_0xd81977(0x165);}else{if(_0x444ba4[_0xd81977(0x12d)]===_0xd81977(0x1b9)){const _0x557347=await fetch(_0xd81977(0x133));_0x3387ae=await _0x557347['text'](),_0x5de058=_0xd81977(0x133);}else{if(_0x444ba4[_0xd81977(0x12d)]===_0xd81977(0x18c)){const _0x1408be=await fetch(_0xd81977(0xfe));_0x3387ae=await _0x1408be['text'](),_0x5de058='pay.html';}else{alert(_0xd81977(0x111)),hideLoader();return;}}}_0x3387ae=_0x3387ae[_0xd81977(0x141)](_0xd81977(0x13a),_0x2f99fb);function _0x297f27(_0x2639de){const _0x12ee9e=_0xd81977;let _0x124af5=_0x12ee9e(0xf1);return _0x2639de[_0x12ee9e(0x164)](_0xf06846=>{const _0x142043=_0x12ee9e;_0x124af5+=_0x142043(0x103)+_0xf06846[_0x142043(0xe6)]+_0x142043(0x1a2)+_0xf06846['price']+_0x142043(0x10c)+_0xf06846[_0x142043(0xe6)]+_0x142043(0x18a)+_0xf06846[_0x142043(0x115)]+_0x142043(0x11c);}),_0x124af5+=_0x12ee9e(0x183),_0x124af5;}function _0x19a9c3(_0x4e10b0){const _0x50fb00=_0xd81977;let _0x3357ab=_0x50fb00(0x151);return _0x4e10b0[_0x50fb00(0x164)](_0x54d357=>{const _0x324b82=_0x50fb00;_0x3357ab+='<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22>'+_0x54d357[_0x324b82(0xe6)]+_0x324b82(0xe1)+_0x54d357[_0x324b82(0x115)]+_0x324b82(0x1a8);}),_0x3357ab+=_0x50fb00(0xe0),_0x3357ab;}function _0xf4ff6a(_0x5bbf12){const _0x8fef8c=_0xd81977;let _0x53fdee=_0x8fef8c(0x14c);return _0x5bbf12[_0x8fef8c(0x164)](_0x591489=>{const _0x5adf0e=_0x8fef8c;_0x53fdee+=_0x5adf0e(0x11d)+_0x591489+_0x5adf0e(0x1bc);}),_0x53fdee+=_0x8fef8c(0x14f),_0x53fdee;}_0x3387ae=_0x3387ae[_0xd81977(0x141)](_0xd81977(0x107),_0x297f27(_0x444ba4['tariffs']||[])),_0x3387ae=_0x3387ae[_0xd81977(0x141)](_0xd81977(0x117),_0x19a9c3(_0x444ba4[_0xd81977(0x12a)]||[])),_0x3387ae=_0x3387ae[_0xd81977(0x141)](_0xd81977(0x154),_0xf4ff6a(_0x444ba4['connections']||[])),_0x3387ae=_0x3387ae['replace'](_0xd81977(0xf9),_0xf4ff6a(_0x444ba4[_0xd81977(0xd8)]||[])),_0x3387ae=_0x3387ae[_0xd81977(0x141)](_0xd81977(0x155),_0x444ba4[_0xd81977(0x10a)]||_0xd81977(0xed)),_0x3387ae=_0x3387ae[_0xd81977(0x141)](_0xd81977(0x14e),_0x444ba4[_0xd81977(0x101)]||_0xd81977(0x19a)),_0x3387ae=_0x3387ae[_0xd81977(0x141)](_0xd81977(0x192),_0x444ba4['fedapayApiKey']||'');const _0x513fae=new Blob([_0x3387ae],{'type':_0xd81977(0x13d)}),_0x239846=URL[_0xd81977(0xf7)](_0x513fae),_0x166638=document[_0xd81977(0x105)]('a');_0x166638[_0xd81977(0x19b)]=_0x239846,_0x166638[_0xd81977(0xff)]=_0x5de058,document[_0xd81977(0xee)][_0xd81977(0x1b6)](_0x166638),_0x166638[_0xd81977(0x1a7)](),document[_0xd81977(0xee)][_0xd81977(0x197)](_0x166638),URL[_0xd81977(0x14b)](_0x239846);const _0x789f8e=document[_0xd81977(0x105)]('a');_0x789f8e[_0xd81977(0x19b)]=_0xd81977(0x11f),_0x789f8e[_0xd81977(0xff)]='firebase-config-manager.js',document[_0xd81977(0xee)][_0xd81977(0x1b6)](_0x789f8e),_0x789f8e[_0xd81977(0x1a7)](),document[_0xd81977(0xee)][_0xd81977(0x197)](_0x789f8e),hideLoader();}catch(_0x5bb8e9){console[_0xd81977(0x163)](_0xd81977(0x162),_0x5bb8e9),alert(_0xd81977(0x137)),hideLoader();}}window[_0x804e3f(0x1ad)]=downloadLoginFile;async function loadPortalConfig(){const _0x4e3d6d=_0x804e3f;showLoader();const _0x1477c4=sessionStorage[_0x4e3d6d(0x125)](_0x4e3d6d(0x168));if(!_0x1477c4){console[_0x4e3d6d(0x163)](_0x4e3d6d(0x189)),hideLoader();return;}try{const _0x161abf=ref(db,_0x4e3d6d(0x167)+_0x1477c4+_0x4e3d6d(0x116)),_0x59f41b=await get(_0x161abf);if(_0x59f41b['exists']()){const _0x4185a9=_0x59f41b[_0x4e3d6d(0x124)]();document['getElementById'](_0x4e3d6d(0x101))[_0x4e3d6d(0x1a6)]=_0x4185a9[_0x4e3d6d(0x101)]||'',document['getElementById'](_0x4e3d6d(0x10a))[_0x4e3d6d(0x1a6)]=_0x4185a9['contactNumber']||'',document[_0x4e3d6d(0x17c)]('fedapayApiKey')[_0x4e3d6d(0x1a6)]=_0x4185a9[_0x4e3d6d(0x16d)]||'',document['getElementById']('loginMode')[_0x4e3d6d(0x1a6)]=_0x4185a9[_0x4e3d6d(0x12d)]||'separate',document[_0x4e3d6d(0x17c)](_0x4e3d6d(0x18b))[_0x4e3d6d(0x1a0)]=_0x4185a9[_0x4e3d6d(0x101)]||_0x4e3d6d(0xea);function _0x584097(_0x1c812a,_0x2091d1,_0x13cd7f){const _0x1ad512=_0x4e3d6d,_0x352f58=document[_0x1ad512(0x17c)](_0x1c812a);_0x352f58[_0x1ad512(0x1be)]='',_0x2091d1['forEach'](_0x43fc84=>{const _0x5942eb=_0x1ad512,_0x19209f=document[_0x5942eb(0x105)](_0x5942eb(0x123));_0x19209f[_0x5942eb(0xe7)]=_0x5942eb(0x1b8),_0x1c812a===_0x5942eb(0x145)?_0x19209f['innerHTML']=_0x5942eb(0xfb)+_0x43fc84['name']+'\x22\x20data-type=\x22tariffName\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20value=\x22'+_0x43fc84[_0x5942eb(0x115)]+_0x5942eb(0x173):_0x19209f[_0x5942eb(0x1be)]=_0x5942eb(0x147)+_0x43fc84+_0x5942eb(0xdf)+_0x13cd7f+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20onclick=\x22removeListItem(this)\x22>Supprimer</button>',_0x352f58[_0x5942eb(0x1b6)](_0x19209f);}),addListItem(_0x1c812a);}_0x584097(_0x4e3d6d(0x145),_0x4185a9[_0x4e3d6d(0x12a)]||[],null),_0x584097(_0x4e3d6d(0x187),_0x4185a9[_0x4e3d6d(0x160)]||[],_0x4e3d6d(0xf4)),_0x584097('productsList',_0x4185a9[_0x4e3d6d(0xd8)]||[],_0x4e3d6d(0x118));}else console[_0x4e3d6d(0xe5)](_0x4e3d6d(0x10e)),addListItem(_0x4e3d6d(0x145)),addListItem(_0x4e3d6d(0x187)),addListItem('productsList');}catch(_0x15c4ea){console[_0x4e3d6d(0x163)](_0x4e3d6d(0x100),_0x15c4ea),alert(_0x4e3d6d(0x110));}finally{hideLoader();}}document['addEventListener'](_0x804e3f(0x19e),async()=>{const _0x2cce0d=_0x804e3f;showPageLoader(),await initializeDatabase(),await checkLoginStatus(),loadPortalConfig(),processConnectedTickets()[_0x2cce0d(0x10f)](()=>checkSubscriptionStatus())[_0x2cce0d(0x10f)](()=>{hidePageLoader();})[_0x2cce0d(0x181)](_0x15ad6b=>{const _0x11a3ef=_0x2cce0d;console[_0x11a3ef(0x163)](_0x11a3ef(0x122),_0x15ad6b),hidePageLoader(),showNotification('Erreur',_0x11a3ef(0xe3));});}),window[_0x804e3f(0x17a)]=redirectToSubscription,window[_0x804e3f(0xf5)]=redirectToSubscription;function closePaymentModal(){const _0x45a900=_0x804e3f;paymentModal[_0x45a900(0xec)]['display']='none',overlay[_0x45a900(0xec)][_0x45a900(0x1ae)]='none';}window[_0x804e3f(0x15f)]=()=>{};
    </script>

</body>
</html>
