<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMIN WIFI ZONE</title>
    <link rel="stylesheet" href="styleA.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
    <script src="https://cdn.fedapay.com/checkout.js?v=1.1.7"></script>

    <style>
        /* ... (Styles CSS - Pas de modifications majeures, juste des ajustements pour le formulaire) ... */
       /* Style pour le modal de paiement */
       .payment-modal {
           display: none;
           position: fixed;
           top: 50%;
           left: 50%;
           transform: translate(-50%, -50%);
           background-color: white;
           padding: 30px;
           border-radius: 10px;
           box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
           z-index: 1000;
           max-width: 400px;
           width: 90%;
           text-align: center;
       }

       .payment-modal h2 {
           color: #333;
           margin-bottom: 20px;
       }

       .payment-modal p {
           color: #666;
           margin-bottom: 30px;
       }

       .payment-modal button {
           background-color: #fdbb2d;
           color: #1a2a6c;
           border: none;
           padding: 12px 20px;
           border-radius: 25px;
           cursor: pointer;
           transition: all 0.3s;
           font-weight: 600;
           font-size: 0.9rem;
           margin: 0 10px;
       }

       .payment-modal button:hover {
           background-color: #e6a727;
       }

       .close-modal {
           position: absolute;
           top: 10px;
           right: 10px;
           cursor: pointer;
           font-size: 1.2rem;
           color: #333;
       }

       /* Style pour l'overlay */
       .overlay {
           display: none;
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background-color: rgba(0, 0, 0, 0.5);
           z-index: 999;
       }
       #subscriptionSection {
           text-align: center;
           margin-bottom: 30px;
       }

       #subscriptionSection h2 {
           font-size: 24px;
           color: #fdbb2d;
           margin-bottom: 20px;
       }

       #subscriptionStatus {
           font-size: 18px;
           color: #fff;
           margin-bottom: 20px;
       }

       .subscription-buttons {
           display: flex;
           justify-content: center;
           gap: 20px;
       }

       .subscription-buttons button {
           background-color: #fdbb2d;
           color: #1a2a6c;
           border: none;
           padding: 12px 20px;
           border-radius: 25px;
           cursor: pointer;
           transition: all 0.3s;
           font-weight: 600;
           font-size: 0.9rem;
       }

       .subscription-buttons button:hover {
           background-color: #e6a727;
       }

       /* Style pour le message d'abonnement requis */
       .subscription-required {
           display: none;
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background-color: rgba(0, 0, 0, 0.5);
           z-index: 1000;
           justify-content: center;
           align-items: center;
           color: white;
           text-align: center;
           padding: 20px;
       }

       .subscription-required-content {
           background-color: white;
           padding: 30px;
           border-radius: 10px;
           box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
           max-width: 400px;
           width: 90%;
       }

       .subscription-required-content h2 {
           color: #333;
           margin-bottom: 20px;
       }

       .subscription-required-content p {
           color: #666;
           margin-bottom: 30px;
           }

       .subscription-required-content button {
           background-color: #fdbb2d;
           color: #1a2a6c;
           border: none;
           padding: 12px 20px;
           border-radius: 25px;
           cursor: pointer;
           transition: all 0.3s;
           font-weight: 600;
           font-size: 0.9rem;
           margin: 0 10px;
       }

       .subscription-required-content button:hover {
           background-color: #e6a727;
       }
        .loader-wrapper {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1001;
        }

        .loader {
            position: absolute;
            top: 50%;
            left: 50%;
            border: 6px solid #f3f3f3;
            border-top: 6px solid #fdbb2d;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
            transform: translate(-50%, -50%);
        }

        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .page-loader-wrapper {
            display: flex;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1002;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .page-loader {
            border: 6px solid #f3f3f3;
            border-top: 6px solid #fdbb2d;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }

        .loader-message {
            color: white;
            margin-top: 16px;
            font-size: 1rem;
            text-align: center;
            max-width: 80%;
        }

        .header {
            display: flex; /* Added to align items */
            justify-content: center; /* MODIFICATION: Center content horizontally */
            align-items: center; /* Added to vertically align items */
            flex-direction: column; /* MODIFICATION: Stack items vertically */
            text-align: center; /* MODIFICATION: Center text within header */
        }

        .header h1 {
            margin: 0; /* Reset margin for h1 inside header */
        }

        .logout-button {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
        }

        .logout-button:hover {
            background-color: #c0392b;
        }
       /* Styles pour le formulaire de portail captif */
      #portalForm {
          display: none; /*Caché par défaut*/
          flex-direction: column;
          gap: 10px;
          max-width: 600px; /* Limite la largeur du formulaire */
          margin: 20px auto;
          padding: 20px;
          background-color: rgba(255, 255, 255, 0.1); /* Léger fond pour le formulaire */
          border-radius: 8px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.2); /* Ombre légère */
      }
      #portalForm label {
          color: #fdbb2d; /* Couleur pour les labels */
      }
      #portalForm input[type="text"],
      #portalForm input[type="number"],
      #portalForm textarea,
      #portalForm select {
          width: 100%;
          padding: 10px;
          border: 1px solid #ddd;
          border-radius: 4px;
          background-color: rgba(255,255,255,0.2); /* Fond transparent */
          color: white; /* Couleur du texte */
      }

      #portalForm button {
          padding: 10px 15px;
          background-color: #fdbb2d;
          color: #1a2a6c;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          font-size: 16px;
      }

      #portalForm button:hover {
          background-color: #e6a727;
      }
      #portalForm .list-input-container {
          display: flex;
          flex-direction: column;
      }

      #portalForm .list-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

      #portalForm .list-item input {
          flex: 1; /* Permet à l'input de prendre l'espace disponible */
          margin-right: 5px; /* Marge entre l'input et le bouton */
      }
        #portalForm .list-item button {
           padding: 5px 10px;
           background-color: #e74c3c; /* Couleur différente pour le bouton de suppression */
           color: white;
           border: none;
           border-radius: 4px;
           cursor: pointer;
           font-size: 14px;
        }

        #portalForm .list-item button:hover {
           background-color: #c0392b;
        }

        #configSection {
          margin-bottom:           20px;
          text-align: center; /* Center-align the buttons */
      }
        #configSection .config-buttons {
          display: inline-block;
          margin: 0 10px;
        }

        #systemVersionDisplay {
            position: absolute;
            top: 10px;
            right: 10px;
            color: #fdbb2d;
            font-size: 0.8rem;
        }

    </style>
</head>
<body>
    <div class="page-loader-wrapper" id="pageLoaderWrapper">
        <div class="page-loader"></div>
        <div class="loader-message" id="pageLoaderMessage">Initialisation...</div>
    </div>
    <div class="loader-wrapper" id="loaderWrapper">
        <div class="loader"></div>
    </div>
    <div class="container" id="contentContainer" style="display:none;">
        <header class="header">
            <h1 id="networkNameDisplay">ADMIN WIFI ZONE</h1>
            <div class="wave"></div>
            <div id="systemVersionDisplay">Version du système: <span id="versionNumber"></span></div>
        </header>


        <main>
            <div id="subscriptionSection">
                <h2>Statut de l'Abonnement</h2>
                <div id="subscriptionStatus"></div>
                <div class="subscription-button">
                    <button id="subscribeMonthly">S'abonner (Mensuel - 1000 FCFA)</button>
                    <button id="subscribeYearly">S'abonner (Annuel - 10 000 FCFA)</button>
                </div>
            </div>

            <div id="configSection">
              <button onclick="togglePortalForm()" id="togglePortalFormBtn">Configurer le portail captif</button>
              <button onclick="downloadLoginFile()" id="downloadLoginBtn" style="display: none;">Télécharger le portail captif</button>
             </div>


            <form id="portalForm" style="display: none;">
                <label for="networkName">Nom du réseau:</label>
                <input type="text" id="networkName" name="networkName" required>

                <label for="contactNumber">Numéro à contacter:</label>
                <input type="text" id="contactNumber" name="contactNumber" required>

                <label for="fedapayApiKey">Clé API FedaPay Portail Captif:</label>
                <input type="text" id="fedapayApiKey" name="fedapayApiKey" required>

                <label for="loginMode">Mode de connexion par défaut :</label>
                <select id="loginMode" name="loginMode">
                    <option value="separate">Nom d'utilisateur et Mot de passe</option>
                    <option value="same">Identifiant unique</option>
                    <option value="pay">Page de paiement</option>
                </select>

                <div class="list-input-container">
                    <label>Tarifs:</label>
                    <div id="tariffsList">
                        <div class="list-item">
                            <input type="text" placeholder="Nom du tarif" data-type="tariffName">
                            <input type="number" placeholder="Prix" data-type="tariffPrice">
                            <button type="button" onclick="addListItem('tariffsList')">Ajouter</button>
                         </div>
                      </div>
                 </div>

                 <div class="list-input-container">
                      <label>Adresses de connexion:</label>
                      <div id="connectionsList">
                         <div class="list-item">
                            <input type="text" placeholder="Adresse" data-type="connection">
                            <button type="button" onclick="addListItem('connectionsList')">Ajouter</button>
                           </div>
                      </div>
                  </div>

                  <div class="list-input-container">
                      <label>Services et produits:</label>
                      <div id="productsList">
                         <div class="list-item">
                             <input type="text" placeholder="Service/Produit" data-type="product">
                             <button type="button" onclick="addListItem('productsList')">Ajouter</button>
                         </div>
                     </div>
                 </div>

                 <button type="submit">Enregistrer la configuration</button>
             </form>

            <div class="menu">
                <a href="PageVenteTicket.html" class="menu-item" id="vente">
                    <i class="fas fa-ticket-alt"></i>
                    <h2>Vente de Tickets</h2>
                    <p>Procédez à la vente de nouveaux tickets Wifi.</p>
                </a>
                <a href="AdminVentePartenaires.html" class="menu-item" id="inventaire">
                    <i class="fas fa-clipboard-list"></i>
                    <h2>Inventaire des Tickets</h2>
                    <p>Consultez l'état des ventes de vos partenaires.</p>
                </a>
                <a href="Stock.html" class="menu-item" id="stock">
                    <i class="fas fa-boxes"></i>
                    <h2>Gestion des Stocks Partenaire</h2>
                    <p>Suivez les stocks de tickets de vos partenaires.</p>
                </a>
                <a href="a3.html" class="menu-item" id="administration">
                    <i class="fas fa-cog"></i>
                    <h2>Administration des Tickets</h2>
                    <p>Gérez les tickets, activez ou désactivez-les.</p>
                </a>
                <button onclick="logout()" class="logout-button">Déconnexion</button>
            </div>

        </main>

    </div>


    <div id="paymentModal" class="payment-modal" style="display: none;">
        <span class="close-modal" onclick="closePaymentModal()">×</span>
        <h2>Paiement de l'Abonnement</h2>
        <p>Choisissez votre plan d'abonnement et procédez au paiement via FedaPay.</p>
        <!-- Les boutons de paiement seront ajoutés ici par le script -->
    </div>

    <div id="subscriptionRequiredModal" class="subscription-required" style="display: none;">
        <div class="subscription-required-content">
            <h2>Abonnement Requis</h2>
            <p>Un abonnement actif est nécessaire pour accéder à cette fonctionnalité.</p>
            <button onclick="redirectToSubscription()">S'abonner</button>
            <button onclick="hideSubscriptionRequiredModal()">Fermer</button>
        </div>
    </div>

    <div class="overlay" id="overlay" style="display: none;" onclick="closePaymentModal()"></div>

    <script type="module">
const _0x20d24c=_0x4035;(function(_0x29e754,_0xad2bae){const _0x20bfe7=_0x4035,_0x431f46=_0x29e754();while(!![]){try{const _0x381928=parseInt(_0x20bfe7(0xd7))/0x1+-parseInt(_0x20bfe7(0x150))/0x2*(parseInt(_0x20bfe7(0x124))/0x3)+parseInt(_0x20bfe7(0xda))/0x4*(-parseInt(_0x20bfe7(0x107))/0x5)+-parseInt(_0x20bfe7(0xd6))/0x6*(-parseInt(_0x20bfe7(0x9d))/0x7)+-parseInt(_0x20bfe7(0x109))/0x8*(-parseInt(_0x20bfe7(0xd8))/0x9)+parseInt(_0x20bfe7(0x156))/0xa*(parseInt(_0x20bfe7(0x13f))/0xb)+-parseInt(_0x20bfe7(0x136))/0xc*(-parseInt(_0x20bfe7(0x146))/0xd);if(_0x381928===_0xad2bae)break;else _0x431f46['push'](_0x431f46['shift']());}catch(_0x3ce7f1){_0x431f46['push'](_0x431f46['shift']());}}}(_0x4bba,0xd9513));import{getActiveDatabase}from'./firebase-config-manager.js';import{ref,get,set,push,remove,update}from'https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js';let db,adminRef,fedapayApiKey,systemVersion;async function initializeDatabase(){const _0x2a6d1a=_0x4035;db=await getActiveDatabase(),console[_0x2a6d1a(0x15d)](_0x2a6d1a(0xd5));}async function checkLoginStatus(){const _0x23ec8a=_0x4035;if(sessionStorage[_0x23ec8a(0x167)]('isLoggedIn')!==_0x23ec8a(0x9a))redirectToLogin();else{const _0x15cd26=sessionStorage[_0x23ec8a(0x167)](_0x23ec8a(0xad));if(!_0x15cd26){console[_0x23ec8a(0x10a)](_0x23ec8a(0x163)),redirectToLogin();return;}document[_0x23ec8a(0x143)](_0x23ec8a(0xf2))[_0x23ec8a(0xdb)][_0x23ec8a(0x122)]='block',adminRef=ref(db,_0x23ec8a(0x129)+_0x15cd26+_0x23ec8a(0xf0));}}function redirectToLogin(){const _0x5c921e=_0x4035;window['location'][_0x5c921e(0xff)]=_0x5c921e(0x13b);}window['logout']=function(){const _0x418f3d=_0x4035;sessionStorage['clear'](),window[_0x418f3d(0xac)][_0x418f3d(0x171)]('loginAccueil.html');};const venteMenuItem=document[_0x20d24c(0x143)]('vente'),inventaireMenuItem=document[_0x20d24c(0x143)](_0x20d24c(0x10c)),stockMenuItem=document[_0x20d24c(0x143)](_0x20d24c(0xb7)),administrationMenuItem=document[_0x20d24c(0x143)](_0x20d24c(0xab)),subscriptionStatus=document[_0x20d24c(0x143)](_0x20d24c(0x11c)),subscribeMonthlyButton=document['getElementById'](_0x20d24c(0x148)),subscribeYearlyButton=document[_0x20d24c(0x143)](_0x20d24c(0x99)),paymentModal=document[_0x20d24c(0x143)](_0x20d24c(0xe5)),overlay=document[_0x20d24c(0x143)](_0x20d24c(0x16d)),subscriptionRequiredModal=document['getElementById'](_0x20d24c(0xbd));function showLoader(){const _0x27a316=_0x20d24c;document[_0x27a316(0x143)](_0x27a316(0x176))[_0x27a316(0xdb)][_0x27a316(0x122)]='block';}function hideLoader(){const _0x2936fe=_0x20d24c;document[_0x2936fe(0x143)]('loaderWrapper')['style'][_0x2936fe(0x122)]='none';}function showPageLoader(){const _0x4d5aa9=_0x20d24c;document[_0x4d5aa9(0x143)]('pageLoaderWrapper')[_0x4d5aa9(0xdb)]['display']=_0x4d5aa9(0x142);}function hidePageLoader(){const _0x3e64f1=_0x20d24c;document['getElementById'](_0x3e64f1(0xed))[_0x3e64f1(0xdb)]['display']=_0x3e64f1(0x164);}function showSubscriptionRequiredModal(){const _0x4ed99b=_0x20d24c;subscriptionRequiredModal[_0x4ed99b(0xdb)][_0x4ed99b(0x122)]=_0x4ed99b(0x142);}function hideSubscriptionRequiredModal(){const _0x1bd49e=_0x20d24c;subscriptionRequiredModal[_0x1bd49e(0xdb)][_0x1bd49e(0x122)]='none';}function redirectToSubscription(){hideSubscriptionRequiredModal();}function checkSubscriptionStatus(){const _0x260a6b=_0x20d24c,_0x2184b6=sessionStorage[_0x260a6b(0x167)](_0x260a6b(0xad));if(!_0x2184b6){console['error'](_0x260a6b(0x168));return;}const _0x180a17=ref(db,_0x260a6b(0x129)+_0x2184b6+'/admin/subscription');get(_0x180a17)['then'](_0x36fed8=>{const _0x564bec=_0x260a6b,_0x2a0962=_0x36fed8[_0x564bec(0xa7)](),_0x2d5816=new Date();if(_0x2a0962&&_0x2a0962[_0x564bec(0x91)]==='active'){const _0x20d414=new Date(_0x2a0962[_0x564bec(0x141)]);_0x20d414<_0x2d5816?(subscriptionStatus['textContent']=_0x564bec(0xe0),subscriptionStatus['style']['color']=_0x564bec(0xc4),subscribeMonthlyButton[_0x564bec(0xdb)][_0x564bec(0x122)]=_0x564bec(0xe2),subscribeYearlyButton[_0x564bec(0xdb)]['display']='inline-block',set(_0x180a17,{..._0x2a0962,'status':'expired'})):(subscriptionStatus[_0x564bec(0x154)]='Statut\x20de\x20l\x27abonnement:\x20Actif\x20jusqu\x27au\x20'+_0x20d414[_0x564bec(0x12d)](),subscriptionStatus[_0x564bec(0xdb)][_0x564bec(0x112)]='green',subscribeMonthlyButton[_0x564bec(0xdb)][_0x564bec(0x122)]=_0x564bec(0x164),subscribeYearlyButton[_0x564bec(0xdb)][_0x564bec(0x122)]=_0x564bec(0x164));}else subscriptionStatus[_0x564bec(0x154)]='Statut\x20de\x20l\x27abonnement:\x20Inactif',subscriptionStatus[_0x564bec(0xdb)][_0x564bec(0x112)]=_0x564bec(0xc4),subscribeMonthlyButton[_0x564bec(0xdb)][_0x564bec(0x122)]='inline-block',subscribeYearlyButton['style']['display']=_0x564bec(0xe2);})[_0x260a6b(0xaa)](_0x473d8a=>{console['error']('Erreur\x20lors\x20de\x20la\x20vérification\x20du\x20statut\x20d\x27abonnement:',_0x473d8a);});}function checkUserAccess(){const _0x1a9cd1=_0x20d24c;get(adminRef)[_0x1a9cd1(0xef)](_0x47a173=>{const _0x1f15ad=_0x1a9cd1,_0x4d1403=_0x47a173[_0x1f15ad(0xa7)]();(!_0x4d1403||_0x4d1403[_0x1f15ad(0x91)]!==_0x1f15ad(0xf4))&&showSubscriptionRequiredModal();});}venteMenuItem['addEventListener'](_0x20d24c(0x174),_0x27eb00=>{const _0x15a024=_0x20d24c;_0x27eb00[_0x15a024(0x94)](),checkUserAccess();const _0x13304a=sessionStorage[_0x15a024(0x167)](_0x15a024(0xad));_0x13304a?window[_0x15a024(0xac)][_0x15a024(0xff)]=_0x15a024(0x15e)+_0x13304a:(console[_0x15a024(0x10a)](_0x15a024(0x12b)),alert(_0x15a024(0x118)));}),inventaireMenuItem[_0x20d24c(0x103)](_0x20d24c(0x174),_0x552d6f=>{const _0x174b04=_0x20d24c;_0x552d6f['preventDefault'](),checkUserAccess(),window[_0x174b04(0xac)]['href']=_0x174b04(0xa1);}),stockMenuItem[_0x20d24c(0x103)](_0x20d24c(0x174),_0x20f224=>{const _0x5e14b9=_0x20d24c;_0x20f224[_0x5e14b9(0x94)](),checkUserAccess(),window['location'][_0x5e14b9(0xff)]=_0x5e14b9(0x13d);}),administrationMenuItem[_0x20d24c(0x103)](_0x20d24c(0x174),_0x348d3a=>{const _0x4ec5b0=_0x20d24c;_0x348d3a[_0x4ec5b0(0x94)](),checkUserAccess(),window['location']['href']='a3.html';}),subscribeMonthlyButton[_0x20d24c(0x103)](_0x20d24c(0x174),()=>{const _0x59ddbf=_0x20d24c;initiatePayment(_0x59ddbf(0x110));}),subscribeYearlyButton[_0x20d24c(0x103)]('click',()=>{const _0x290d39=_0x20d24c;initiatePayment(_0x290d39(0xb8));});async function initiatePayment(_0x4ea71e){const _0x3770a8=_0x20d24c,_0x5183ac=_0x4ea71e===_0x3770a8(0x110)?0x3e8:0x2710,_0x2ed546=_0x4ea71e===_0x3770a8(0x110)?_0x3770a8(0x172):_0x3770a8(0xf9),_0x20598f=sessionStorage[_0x3770a8(0x167)](_0x3770a8(0xad));if(!_0x20598f){console[_0x3770a8(0x10a)]('User\x20ID\x20not\x20found.\x20Cannot\x20initiate\x20payment.'),alert('Vous\x20devez\x20être\x20connecté\x20pour\x20vous\x20abonner.');return;}FedaPay['init']({'public_key':fedapayApiKey,'transaction':{'amount':_0x5183ac,'description':_0x2ed546},'customer':{'email':'admin@example.com'},'onComplete':async function(_0x27bee5){const _0x259e56=_0x3770a8;if(_0x27bee5[_0x259e56(0x15c)]===FedaPay[_0x259e56(0x131)])alert(_0x259e56(0x13e));else _0x27bee5['reason']===FedaPay[_0x259e56(0xb4)]&&handleSuccessfulPayment(_0x4ea71e,_0x27bee5,_0x20598f);}})[_0x3770a8(0x11e)]();}async function handleSuccessfulPayment(_0x4b94d0,_0x3611fe,_0x2ba9fa){const _0x37d61f=_0x20d24c,_0x19ea34=new Date(),_0x528993=new Date(_0x19ea34);_0x4b94d0===_0x37d61f(0x110)?_0x528993[_0x37d61f(0x166)](_0x528993[_0x37d61f(0x137)]()+0x1):_0x528993[_0x37d61f(0x134)](_0x528993[_0x37d61f(0x138)]()+0x1);const _0x2bd841={'status':_0x37d61f(0xf4),'startDate':_0x19ea34[_0x37d61f(0xc8)](),'endDate':_0x528993[_0x37d61f(0xc8)](),'transactionId':_0x3611fe[_0x37d61f(0x98)]['id'],'plan':_0x4b94d0};try{const _0x126351=ref(db,'users-data/'+_0x2ba9fa+_0x37d61f(0xf0));await set(_0x126351,_0x2bd841),checkSubscriptionStatus(),alert(_0x37d61f(0x173)+(_0x4b94d0===_0x37d61f(0x110)?_0x37d61f(0xc2):_0x37d61f(0xce))+_0x37d61f(0x175));}catch(_0x3861c7){console[_0x37d61f(0x10a)](_0x37d61f(0xeb),_0x3861c7),alert(_0x37d61f(0x14f));}}async function cancelSubscription(){const _0x545c24=_0x20d24c,_0x2395c1=sessionStorage[_0x545c24(0x167)](_0x545c24(0xad));if(!_0x2395c1){console[_0x545c24(0x10a)](_0x545c24(0xc9)),alert('Vous\x20devez\x20être\x20connecté\x20pour\x20annuler\x20un\x20abonnement.');return;}try{const _0x1d80b0=ref(db,'users-data/'+_0x2395c1+_0x545c24(0xf0));await set(_0x1d80b0,{...(await get(_0x1d80b0))[_0x545c24(0xa7)](),'status':_0x545c24(0xb6)}),checkSubscriptionStatus(),alert(_0x545c24(0xf8));}catch(_0x37146a){console[_0x545c24(0x10a)](_0x545c24(0xe4),_0x37146a),alert(_0x545c24(0xfc));}}async function processConnectedTickets(){const _0x2fc609=_0x20d24c,_0x25eaae=document[_0x2fc609(0x143)](_0x2fc609(0xbb)),_0x3b7587=sessionStorage[_0x2fc609(0x167)](_0x2fc609(0xad));if(!_0x3b7587){console['error'](_0x2fc609(0x163));return;}const _0x3c2273=ref(db,_0x2fc609(0x129)+_0x3b7587+_0x2fc609(0x144));try{_0x25eaae[_0x2fc609(0x154)]=_0x2fc609(0xe7);const _0x49c4a9=await get(_0x3c2273);let _0x5004aa=_0x49c4a9[_0x2fc609(0xa7)]()||{};const _0x51c810={};for(const _0x4fc3f3 in _0x5004aa){const _0x2bc53c=_0x5004aa[_0x4fc3f3][_0x2fc609(0xc3)];!_0x51c810[_0x2bc53c]&&(_0x51c810[_0x2bc53c]=_0x5004aa[_0x4fc3f3]);}_0x25eaae[_0x2fc609(0x154)]=_0x2fc609(0x128);for(const _0x4f5ffa in _0x51c810){await processTicket(_0x51c810[_0x4f5ffa],_0x3b7587);}_0x25eaae[_0x2fc609(0x154)]=_0x2fc609(0x95),await remove(_0x3c2273);}catch(_0x1c15df){console[_0x2fc609(0x10a)](_0x2fc609(0xb1),_0x1c15df),showNotification('Erreur',_0x2fc609(0xf6));}}async function processTicket(_0x41a3ca,_0x395637){const _0x450b73=_0x20d24c,_0x37b899=document[_0x450b73(0x143)](_0x450b73(0xbb));if(!_0x395637){console[_0x450b73(0x10a)](_0x450b73(0x104));return;}try{_0x37b899[_0x450b73(0x154)]=_0x450b73(0xdd)+_0x41a3ca[_0x450b73(0xc3)]+_0x450b73(0x15f);const _0x136387=ref(db,_0x450b73(0x129)+_0x395637+_0x450b73(0x157)),_0x82f548=await get(_0x136387),_0xd054cb=_0x82f548[_0x450b73(0xa7)]()||{};let _0x15f2d0=![];for(const _0x372e69 in _0xd054cb){const _0x3f3fcb=_0xd054cb[_0x372e69];for(const _0x2ebe5f in _0x3f3fcb){if(_0x3f3fcb[_0x2ebe5f][_0x450b73(0xea)]===_0x41a3ca[_0x450b73(0xc3)]){_0x15f2d0=!![];break;}}if(_0x15f2d0)break;}if(!_0x15f2d0){_0x37b899[_0x450b73(0x154)]=_0x450b73(0xf1)+_0x41a3ca['username']+_0x450b73(0x15f);const _0x39a91e=ref(db,_0x450b73(0x129)+_0x395637+_0x450b73(0xec)),_0x122582=ref(db,_0x450b73(0x129)+_0x395637+_0x450b73(0xfd)),_0x4ec0c3=await get(_0x39a91e),_0x4f35cc=await get(_0x122582),_0xc49f80=_0x4ec0c3[_0x450b73(0xa7)]()||{},_0x224dcb=_0x4f35cc[_0x450b73(0xa7)]()||{};let _0xa29208=null,_0x4da2f4=null,_0x442ef4=null;for(const _0x5a07e5 in _0xc49f80){const _0x1d7b3c=(_0xc49f80[_0x5a07e5][_0x450b73(0xd9)]||[])[_0x450b73(0x153)](_0x41a3ca['username']);if(_0x1d7b3c>-0x1){_0xa29208={'category':_0x5a07e5,'user':_0xc49f80[_0x5a07e5][_0x450b73(0xd9)][_0x1d7b3c],'password':_0xc49f80[_0x5a07e5][_0x450b73(0x11a)][_0x1d7b3c],'price':_0xc49f80[_0x5a07e5][_0x450b73(0x13a)][_0x1d7b3c],'updatedData':{..._0xc49f80[_0x5a07e5],'utilisateur':_0xc49f80[_0x5a07e5][_0x450b73(0xd9)][_0x450b73(0x162)]((_0x3edc3e,_0x357fb0)=>_0x357fb0!==_0x1d7b3c),'motDePasse':_0xc49f80[_0x5a07e5]['motDePasse']['filter']((_0x5e9b0a,_0x3bad0c)=>_0x3bad0c!==_0x1d7b3c),'prix':_0xc49f80[_0x5a07e5][_0x450b73(0x13a)][_0x450b73(0x162)]((_0x347e9c,_0x1f0270)=>_0x1f0270!==_0x1d7b3c)}},_0x4da2f4=ref(db,'users-data/'+_0x395637+_0x450b73(0x147)+_0x5a07e5),_0x442ef4='TicketsTotal';break;}}if(!_0xa29208)for(const _0x225263 in _0x224dcb){if(_0x224dcb[_0x225263]['user']===_0x41a3ca[_0x450b73(0xc3)]){_0xa29208={'category':_0x224dcb[_0x225263][_0x450b73(0xa2)],'user':_0x224dcb[_0x225263][_0x450b73(0xea)],'password':_0x224dcb[_0x225263][_0x450b73(0x158)],'price':_0x224dcb[_0x225263][_0x450b73(0x10f)]},_0x4da2f4=ref(db,_0x450b73(0x129)+_0x395637+'/TicketsTransit/'+_0x225263),_0x442ef4=_0x450b73(0x113);break;}}_0xa29208&&(_0x37b899['textContent']=_0x450b73(0x14a)+_0x41a3ca[_0x450b73(0xc3)]+_0x450b73(0x15f),await sellTicketAutomatically(_0xa29208,_0x4da2f4,_0x442ef4,_0x395637));}}catch(_0xa28ce6){console['error']('Erreur\x20lors\x20du\x20traitement\x20du\x20ticket\x20:',_0xa28ce6),showNotification(_0x450b73(0xb5),'Erreur\x20lors\x20du\x20traitement\x20du\x20ticket\x20'+_0x41a3ca[_0x450b73(0xc3)]+'.');}}async function sellTicketAutomatically(_0x2af2c6,_0x159037,_0x2345ab,_0x3c2266){const _0x1d8910=_0x20d24c;if(!_0x3c2266){console[_0x1d8910(0x10a)](_0x1d8910(0x10e));return;}try{const _0x408f52=_0x1d8910(0xd1),_0x137407=ref(db,'users-data/'+_0x3c2266+'/VendorsHistory/'+_0x408f52);await push(_0x137407,{'category':_0x2af2c6[_0x1d8910(0xa2)],'user':_0x2af2c6['user'],'password':_0x2af2c6['password'],'price':_0x2af2c6['price'],'soldAt':Date['now'](),'vendorId':_0x408f52}),_0x2345ab===_0x1d8910(0x14b)?await set(_0x159037,_0x2af2c6[_0x1d8910(0xa9)]):await remove(_0x159037),console[_0x1d8910(0x15d)]('Ticket\x20'+_0x2af2c6[_0x1d8910(0xea)]+_0x1d8910(0x159));}catch(_0x261be6){console[_0x1d8910(0x10a)](_0x1d8910(0x10b),_0x261be6),showNotification(_0x1d8910(0xb5),_0x1d8910(0xb2));}}function _0x4bba(){const _0xbb92a8=['reason','log','PageVenteTicket.html?adminId=','...','remove','<!--\x20FEDAPAY_API_KEY\x20-->','filter','Current\x20user\x20ID\x20is\x20not\x20found\x20in\x20sessionStorage.','none','createElement','setMonth','getItem','User\x20ID\x20not\x20found.\x20Cannot\x20check\x20subscription\x20status.','\x27,\x20','Configurer\x20le\x20portail\x20captif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22','Vous\x20devez\x20être\x20connecté\x20pour\x20télécharger\x20le\x20portail.','overlay','same','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22>','Service/Produit','replace','Abonnement\x20mensuel','Abonnement\x20','click','\x20réussi!','loaderWrapper','status','forEach','text/html','preventDefault','Nettoyage\x20des\x20tickets\x20traités...','connection','1.0.0','transaction','subscribeYearly','true','Erreur\x20lors\x20du\x20traitement\x20des\x20tickets\x20:','</tbody></table>','144676YFlCbj','log.html','User\x20ID\x20not\x20found.\x20Cannot\x20download\x20login\x20file.','value','AdminVentePartenaires.html','category','exists','/portalConfig','removeListItem','push','val','Aucune\x20configuration\x20trouvée.','updatedData','catch','administration','location','currentUserId','Aucune\x20configuration\x20de\x20portail\x20captif\x20trouvée.','#productsList\x20.list-item\x20input','Erreur\x20lors\x20de\x20l\x27enregistrement\x20de\x20la\x20configuration.','Erreur\x20lors\x20du\x20traitement\x20des\x20tickets\x20connectés\x20:','Erreur\x20lors\x20de\x20la\x20vente\x20automatique\x20du\x20ticket.','downloadLoginFile','CHECKOUT_COMPLETED','Erreur','cancelled','stock','yearly','pk_live_xxxxxxxxxxxxx','Configuration\x20du\x20portail\x20captif\x20enregistrée\x20avec\x20succès!','pageLoaderMessage','onload','subscriptionRequiredModal','Une\x20erreur\x20est\x20survenue\x20lors\x20de\x20l\x27initialisation.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','pay','[data-type=\x22tariffPrice\x22]','mensuel','username','red','Erreur\x20lors\x20du\x20chargement\x20de\x20la\x20configuration:','portalForm','<li>','toISOString','User\x20ID\x20not\x20found.\x20Cannot\x20cancel\x20subscription.','body','products','CYBER\x20CAMPUS\x20WIFI\x20ZONE','System\x20Version\x20not\x20found\x20globally,\x20using\x20default.','annuel','trim','DOMContentLoaded','Vendeur\x20automatique','list-item','parentNode','Mode\x20de\x20connexion\x20invalide.','Database\x20initialized\x20in\x20index.html','318FUjQfM','1029095mJmOMc','4466331wQbLWq','utilisateur','4JLQkyz','style','connections','Vérification\x20du\x20ticket\x20pour\x20','<!--\x20TARIFFS_TABLE\x20-->','Vous\x20devez\x20être\x20connecté\x20pour\x20configurer\x20le\x20portail.','Statut\x20de\x20l\x27abonnement:\x20Expiré','contactNumber','inline-block','createObjectURL','Erreur\x20lors\x20de\x20l\x27annulation\x20de\x20l\x27abonnement:','paymentModal','innerHTML','Vérification\x20des\x20tickets\x20connectés...','<!--\x20NETWORK_NAME\x20-->','separate','user','Erreur\x20lors\x20de\x20la\x20mise\x20à\x20jour\x20de\x20l\x27abonnement:','/TicketsTotal','pageLoaderWrapper','addListItem','then','/admin/subscription','Traitement\x20du\x20ticket\x20','contentContainer','<!--\x20ADMIN_USER_ID\x20-->','active','<table\x20style=\x22width:\x20100%;\x20border-collapse:\x20collapse;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Catégorie</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Prix\x20(FCFA)</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>','Une\x20erreur\x20est\x20survenue\x20lors\x20du\x20traitement\x20des\x20tickets.','<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22>','Abonnement\x20annulé.','Abonnement\x20annuel','\x22\x20data-type=\x22tariffName\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20value=\x22','login.html','Erreur\x20lors\x20de\x20l\x27annulation\x20de\x20l\x27abonnement.','/TicketsTransit','users/Version\x20du\x20système','href','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20onclick=\x22removeListItem(this)\x22>Supprimer</button>','\x22\x20data-type=\x22tariffPrice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20onclick=\x22removeListItem(this)\x22>Supprimer</button>','Masquer\x20le\x20formulaire','addEventListener','Current\x20user\x20ID\x20is\x20not\x20provided\x20to\x20processTicket.','fedapayApiKey','loginMode','8362215nJUkhI','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20onclick=\x22removeListItem(this)\x22>Supprimer</button>','8ycpUwc','error','Erreur\x20lors\x20de\x20la\x20vente\x20automatique\x20du\x20ticket\x20:','inventaire','tariffs','Current\x20user\x20ID\x20is\x20not\x20provided\x20to\x20sellTicketAutomatically.','price','monthly','networkName','color','TicketsTransit','User\x20ID\x20not\x20found.\x20Cannot\x20save\x20portal\x20configuration.','name','querySelectorAll','\x22\x20placeholder=\x22','Erreur:\x20ID\x20administrateur\x20non\x20trouvé.\x20Veuillez\x20vous\x20reconnecter.','networkNameDisplay','motDePasse','slice','subscriptionStatus','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22>','open','appendChild',')\x22>Payer</button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20data-type=\x22','display','productsList','65262rwPoyQ','users/API','<!--\x20PRODUCTS_LIST\x20-->','Adresse','Traitement\x20des\x20tickets\x20uniques...','users-data/','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22><button\x20onclick=\x22initPayment(\x27','Admin\x20ID\x20not\x20found\x20in\x20session\x20storage.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table\x20style=\x22width:\x20100%;\x20border-collapse:\x20collapse;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Catégorie</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Prix\x20(FCFA)</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x20text-align:\x20left;\x22>Action</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toLocaleDateString','#tariffsList\x20.list-item','<!--\x20CONTACT_NUMBER\x20-->','text','DIALOG_DISMISSED','firebase-config-manager.js','querySelector','setFullYear','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','1440804iDVIIY','getMonth','getFullYear','togglePortalFormBtn','prix','loginAccueil.html','Erreur\x20lors\x20du\x20téléchargement\x20du\x20portail\x20captif:','Stock.html','Paiement\x20échoué.','22elcYTk','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20value=\x22','endDate','flex','getElementById','/TicketConnecté','pay.html','78Msuqpt','/TicketsTotal/','subscribeMonthly','removeChild','Vente\x20du\x20ticket\x20','TicketsTotal','reset','submit','connectionsList','Erreur\x20lors\x20de\x20la\x20mise\x20à\x20jour\x20de\x20l\x27abonnement.','116XUBpEG','revokeObjectURL','tariffsList','indexOf','textContent','clear','2415730NjvDrS','/VendorsHistory','password','\x20vendu\x20automatiquement\x20et\x20enregistré\x20dans\x20VendorsHistory.','redirectToSubscription','<!--\x20TARIFFS_TABLE_SIMPLE\x20-->'];_0x4bba=function(){return _0xbb92a8;};return _0x4bba();}window['logout']=function(){const _0x2a2ca5=_0x20d24c;sessionStorage[_0x2a2ca5(0x155)](),window[_0x2a2ca5(0xac)]['replace'](_0x2a2ca5(0x13b));},window['togglePortalForm']=function(){const _0x33c9a7=_0x20d24c,_0x5defa8=document[_0x33c9a7(0x143)](_0x33c9a7(0xc6)),_0x355775=document['getElementById'](_0x33c9a7(0x139)),_0x23c7be=document[_0x33c9a7(0x143)]('downloadLoginBtn');_0x5defa8[_0x33c9a7(0xdb)]['display']==='none'||_0x5defa8[_0x33c9a7(0xdb)]['display']===''?(_0x5defa8[_0x33c9a7(0xdb)][_0x33c9a7(0x122)]=_0x33c9a7(0x142),_0x23c7be[_0x33c9a7(0xdb)][_0x33c9a7(0x122)]=_0x33c9a7(0xe2),_0x355775['textContent']=_0x33c9a7(0x102)):(_0x5defa8[_0x33c9a7(0xdb)][_0x33c9a7(0x122)]=_0x33c9a7(0x164),_0x23c7be[_0x33c9a7(0xdb)]['display']=_0x33c9a7(0x164),_0x355775[_0x33c9a7(0x154)]=_0x33c9a7(0x16a));},window[_0x20d24c(0xee)]=function(_0x589f9e){const _0x37d0d4=_0x20d24c,_0x1db4f8=document[_0x37d0d4(0x143)](_0x589f9e),_0x2dc85d=document[_0x37d0d4(0x165)]('div');_0x2dc85d['className']=_0x37d0d4(0xd2);let _0x595d79=_0x37d0d4(0x130);if(_0x589f9e==='tariffsList')_0x2dc85d[_0x37d0d4(0xe6)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20placeholder=\x22Nom\x20du\x20tarif\x22\x20data-type=\x22tariffName\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20placeholder=\x22Prix\x22\x20data-type=\x22tariffPrice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20onclick=\x22removeListItem(this)\x22>Supprimer</button>';else{let _0x10f00c='';if(_0x589f9e===_0x37d0d4(0x14e))_0x10f00c=_0x37d0d4(0x127);else _0x589f9e===_0x37d0d4(0x123)&&(_0x10f00c=_0x37d0d4(0x170));_0x2dc85d[_0x37d0d4(0xe6)]=_0x37d0d4(0x16b)+_0x595d79+_0x37d0d4(0x117)+_0x10f00c+_0x37d0d4(0x121)+_0x589f9e[_0x37d0d4(0x11b)](0x0,-0x4)+_0x37d0d4(0x100);}_0x1db4f8[_0x37d0d4(0x11f)](_0x2dc85d);},window[_0x20d24c(0xa5)]=function(_0x12c7e8){const _0x2824a7=_0x20d24c;_0x12c7e8[_0x2824a7(0xd3)][_0x2824a7(0x160)]();},document['getElementById'](_0x20d24c(0xc6))[_0x20d24c(0x103)](_0x20d24c(0x14d),async _0x93c37e=>{const _0x5de5da=_0x20d24c;_0x93c37e[_0x5de5da(0x94)](),showLoader();const _0x51d2c1=sessionStorage[_0x5de5da(0x167)](_0x5de5da(0xad));if(!_0x51d2c1){console[_0x5de5da(0x10a)](_0x5de5da(0x114)),alert(_0x5de5da(0xdf)),hideLoader();return;}const _0x2dca06={'networkName':document[_0x5de5da(0x143)](_0x5de5da(0x111))[_0x5de5da(0xa0)],'contactNumber':document['getElementById'](_0x5de5da(0xe1))[_0x5de5da(0xa0)],'fedapayApiKey':document[_0x5de5da(0x143)]('fedapayApiKey')[_0x5de5da(0xa0)],'loginMode':document['getElementById'](_0x5de5da(0x106))['value'],'tariffs':[],'connections':[],'products':[]};document[_0x5de5da(0x116)](_0x5de5da(0x12e))['forEach'](_0x483547=>{const _0x5c72e6=_0x5de5da,_0x3a1baf=_0x483547[_0x5c72e6(0x133)]('[data-type=\x22tariffName\x22]'),_0x106d5b=_0x483547['querySelector'](_0x5c72e6(0xc1));if(_0x3a1baf&&_0x106d5b){const _0x44f07d=_0x3a1baf[_0x5c72e6(0xa0)]['trim'](),_0x2d8e1c=parseFloat(_0x106d5b[_0x5c72e6(0xa0)]);_0x44f07d&&!isNaN(_0x2d8e1c)&&_0x2dca06['tariffs'][_0x5c72e6(0xa6)]({'name':_0x44f07d,'price':_0x2d8e1c});}}),document[_0x5de5da(0x116)]('#connectionsList\x20.list-item\x20input')[_0x5de5da(0x92)](_0x52343b=>{const _0x67dcd5=_0x5de5da,_0xdb4c6b=_0x52343b[_0x67dcd5(0xa0)][_0x67dcd5(0xcf)]();_0xdb4c6b&&_0x2dca06['connections']['push'](_0xdb4c6b);}),document[_0x5de5da(0x116)](_0x5de5da(0xaf))[_0x5de5da(0x92)](_0x4fa506=>{const _0x1a7a89=_0x5de5da,_0xa78c1f=_0x4fa506[_0x1a7a89(0xa0)][_0x1a7a89(0xcf)]();_0xa78c1f&&_0x2dca06[_0x1a7a89(0xcb)][_0x1a7a89(0xa6)](_0xa78c1f);});try{const _0x5afc50=ref(db,_0x5de5da(0x129)+_0x51d2c1+_0x5de5da(0xa4));await set(_0x5afc50,_0x2dca06),alert(_0x5de5da(0xba)),hideLoader(),document['getElementById'](_0x5de5da(0xc6))[_0x5de5da(0x14c)](),document[_0x5de5da(0x143)](_0x5de5da(0xc6))['style'][_0x5de5da(0x122)]=_0x5de5da(0x164),document[_0x5de5da(0x143)]('togglePortalFormBtn')[_0x5de5da(0x154)]=_0x5de5da(0x16a),document['getElementById']('downloadLoginBtn')[_0x5de5da(0xdb)][_0x5de5da(0x122)]=_0x5de5da(0x164),document[_0x5de5da(0x143)](_0x5de5da(0x119))['textContent']=_0x2dca06[_0x5de5da(0x111)];}catch(_0xf813fb){console[_0x5de5da(0x10a)]('Erreur\x20lors\x20de\x20l\x27enregistrement\x20de\x20la\x20configuration:',_0xf813fb),alert(_0x5de5da(0xb0)),hideLoader();}});async function downloadLoginFile(){const _0x28c620=_0x20d24c;showLoader();const _0x4ccab5=sessionStorage[_0x28c620(0x167)]('currentUserId');if(!_0x4ccab5){console[_0x28c620(0x10a)](_0x28c620(0x9f)),hideLoader(),alert(_0x28c620(0x16c));return;}try{const _0x3fce7d=ref(db,_0x28c620(0x129)+_0x4ccab5+_0x28c620(0xa4)),_0xfc5ff4=await get(_0x3fce7d);if(!_0xfc5ff4['exists']()){alert(_0x28c620(0xae)),hideLoader();return;}const _0x4924ce=_0xfc5ff4[_0x28c620(0xa7)]();let _0x425dd7='',_0x38631a='';if(_0x4924ce[_0x28c620(0x106)]===_0x28c620(0xe9)){const _0x4d38b0=await fetch(_0x28c620(0xfb));_0x425dd7=await _0x4d38b0[_0x28c620(0x130)](),_0x38631a=_0x28c620(0xfb);}else{if(_0x4924ce[_0x28c620(0x106)]===_0x28c620(0x16e)){const _0x105491=await fetch(_0x28c620(0x9e));_0x425dd7=await _0x105491[_0x28c620(0x130)](),_0x38631a=_0x28c620(0x9e);}else{if(_0x4924ce[_0x28c620(0x106)]===_0x28c620(0xc0)){const _0x5e8633=await fetch(_0x28c620(0x145));_0x425dd7=await _0x5e8633[_0x28c620(0x130)](),_0x38631a=_0x28c620(0x145);}else{alert(_0x28c620(0xd4)),hideLoader();return;}}}_0x425dd7=_0x425dd7['replace'](_0x28c620(0xf3),_0x4ccab5);function _0x3da6f5(_0x3f9d07){const _0x5c31fe=_0x28c620;let _0x235b18=_0x5c31fe(0x12c);return _0x3f9d07[_0x5c31fe(0x92)](_0x2cd654=>{const _0x24773e=_0x5c31fe;_0x235b18+=_0x24773e(0x11d)+_0x2cd654[_0x24773e(0x115)]+_0x24773e(0x16f)+_0x2cd654[_0x24773e(0x10f)]+_0x24773e(0x12a)+_0x2cd654[_0x24773e(0x115)]+_0x24773e(0x169)+_0x2cd654[_0x24773e(0x10f)]+_0x24773e(0x120);}),_0x235b18+=_0x5c31fe(0xbf),_0x235b18;}function _0x3123b9(_0x3c2c40){const _0x31e657=_0x28c620;let _0x1cd08b=_0x31e657(0xf5);return _0x3c2c40['forEach'](_0x2273ff=>{const _0x8995b3=_0x31e657;_0x1cd08b+=_0x8995b3(0xf7)+_0x2273ff[_0x8995b3(0x115)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x208px;\x20border-bottom:\x201px\x20solid\x20#ddd;\x22>'+_0x2273ff[_0x8995b3(0x10f)]+_0x8995b3(0x135);}),_0x1cd08b+=_0x31e657(0x9c),_0x1cd08b;}function _0x1f04ec(_0xbd193){const _0x1d4a2d=_0x28c620;let _0x5de23b='<ul>';return _0xbd193[_0x1d4a2d(0x92)](_0x431103=>{const _0x5c90b3=_0x1d4a2d;_0x5de23b+=_0x5c90b3(0xc7)+_0x431103+'</li>';}),_0x5de23b+='</ul>',_0x5de23b;}_0x425dd7=_0x425dd7['replace'](_0x28c620(0xde),_0x3da6f5(_0x4924ce[_0x28c620(0x10d)]||[])),_0x425dd7=_0x425dd7['replace'](_0x28c620(0x15b),_0x3123b9(_0x4924ce[_0x28c620(0x10d)]||[])),_0x425dd7=_0x425dd7['replace']('<!--\x20CONNECTION_LOCATIONS\x20-->',_0x1f04ec(_0x4924ce[_0x28c620(0xdc)]||[])),_0x425dd7=_0x425dd7[_0x28c620(0x171)](_0x28c620(0x126),_0x1f04ec(_0x4924ce['products']||[])),_0x425dd7=_0x425dd7['replace'](_0x28c620(0x12f),_0x4924ce[_0x28c620(0xe1)]||'+229\x20XXXXXXXX'),_0x425dd7=_0x425dd7['replace'](_0x28c620(0xe8),_0x4924ce[_0x28c620(0x111)]||_0x28c620(0xcc)),_0x425dd7=_0x425dd7[_0x28c620(0x171)](_0x28c620(0x161),_0x4924ce[_0x28c620(0x105)]||'');const _0x1fc9fd=new Blob([_0x425dd7],{'type':_0x28c620(0x93)}),_0x485d99=URL[_0x28c620(0xe3)](_0x1fc9fd),_0x1432b0=document[_0x28c620(0x165)]('a');_0x1432b0['href']=_0x485d99,_0x1432b0['download']=_0x38631a,document['body'][_0x28c620(0x11f)](_0x1432b0),_0x1432b0[_0x28c620(0x174)](),document[_0x28c620(0xca)][_0x28c620(0x149)](_0x1432b0),URL[_0x28c620(0x151)](_0x485d99);const _0x39facc=document[_0x28c620(0x165)]('a');_0x39facc[_0x28c620(0xff)]='firebase-config-manager.js',_0x39facc['download']=_0x28c620(0x132),document[_0x28c620(0xca)][_0x28c620(0x11f)](_0x39facc),_0x39facc[_0x28c620(0x174)](),document['body'][_0x28c620(0x149)](_0x39facc),hideLoader();}catch(_0x849e2b){console['error'](_0x28c620(0x13c),_0x849e2b),alert('Erreur\x20lors\x20du\x20téléchargement\x20du\x20portail\x20captif.'),hideLoader();}}window[_0x20d24c(0xb3)]=downloadLoginFile;async function loadPortalConfig(){const _0x539f49=_0x20d24c;showLoader();const _0x215789=sessionStorage[_0x539f49(0x167)](_0x539f49(0xad));try{const _0x1264fb=ref(db,_0x539f49(0x129)+_0x215789+_0x539f49(0xa4)),_0x41d3b9=ref(db,_0x539f49(0x125)),_0x1746dc=ref(db,_0x539f49(0xfe)),_0xf481fd=await get(_0x1264fb),_0x46ca04=await get(_0x41d3b9),_0x348f1a=await get(_0x1746dc);_0x46ca04['exists']()?fedapayApiKey=_0x46ca04[_0x539f49(0xa7)]():(console['log']('API\x20configuration\x20not\x20found\x20globally\x20for\x20subscription.'),fedapayApiKey=_0x539f49(0xb9));_0x348f1a[_0x539f49(0xa3)]()?systemVersion=_0x348f1a['val']():(systemVersion=_0x539f49(0x97),console[_0x539f49(0x15d)](_0x539f49(0xcd)));document[_0x539f49(0x143)]('versionNumber')[_0x539f49(0x154)]=systemVersion;if(_0xf481fd['exists']()){const _0x566a37=_0xf481fd[_0x539f49(0xa7)]();document[_0x539f49(0x143)](_0x539f49(0x111))[_0x539f49(0xa0)]=_0x566a37['networkName']||'',document[_0x539f49(0x143)](_0x539f49(0xe1))[_0x539f49(0xa0)]=_0x566a37[_0x539f49(0xe1)]||'',document[_0x539f49(0x143)](_0x539f49(0x105))[_0x539f49(0xa0)]=_0x566a37[_0x539f49(0x105)]||'',document['getElementById']('loginMode')['value']=_0x566a37[_0x539f49(0x106)]||_0x539f49(0xe9),document[_0x539f49(0x143)](_0x539f49(0x119))['textContent']=_0x566a37[_0x539f49(0x111)]||'ADMIN\x20WIFI\x20ZONE';function _0x53f72e(_0x177ea8,_0x4a83da,_0x1bb623){const _0x33a5bc=_0x539f49,_0x497fd1=document[_0x33a5bc(0x143)](_0x177ea8);_0x497fd1['innerHTML']='',_0x4a83da[_0x33a5bc(0x92)](_0x2e3411=>{const _0x395a22=_0x33a5bc,_0x36c67c=document[_0x395a22(0x165)]('div');_0x36c67c['className']=_0x395a22(0xd2),_0x177ea8==='tariffsList'?_0x36c67c[_0x395a22(0xe6)]=_0x395a22(0x140)+_0x2e3411[_0x395a22(0x115)]+_0x395a22(0xfa)+_0x2e3411[_0x395a22(0x10f)]+_0x395a22(0x101):_0x36c67c[_0x395a22(0xe6)]='<input\x20type=\x22text\x22\x20value=\x22'+_0x2e3411+_0x395a22(0x121)+_0x1bb623+_0x395a22(0x108),_0x497fd1['appendChild'](_0x36c67c);}),addListItem(_0x177ea8);}_0x53f72e('tariffsList',_0x566a37[_0x539f49(0x10d)]||[],null),_0x53f72e('connectionsList',_0x566a37[_0x539f49(0xdc)]||[],_0x539f49(0x96)),_0x53f72e(_0x539f49(0x123),_0x566a37['products']||[],'product');}else console[_0x539f49(0x15d)](_0x539f49(0xa8)),addListItem(_0x539f49(0x152)),addListItem('connectionsList'),addListItem('productsList');}catch(_0x6466ed){console['error'](_0x539f49(0xc5),_0x6466ed),alert('Erreur\x20lors\x20du\x20chargement\x20de\x20la\x20configuration.');}finally{hideLoader();}}document[_0x20d24c(0x103)](_0x20d24c(0xd0),async()=>{const _0x1057de=_0x20d24c;showPageLoader(),await initializeDatabase(),await checkLoginStatus(),await loadPortalConfig(),processConnectedTickets()['then'](()=>checkSubscriptionStatus())[_0x1057de(0xef)](()=>{hidePageLoader();})[_0x1057de(0xaa)](_0x2fe9dc=>{const _0x562a9e=_0x1057de;console[_0x562a9e(0x10a)](_0x562a9e(0x9b),_0x2fe9dc),hidePageLoader(),showNotification('Erreur',_0x562a9e(0xbe));});}),window[_0x20d24c(0x15a)]=redirectToSubscription,window['hideSubscriptionRequiredModal']=redirectToSubscription;function closePaymentModal(){const _0x5992fa=_0x20d24c;paymentModal[_0x5992fa(0xdb)][_0x5992fa(0x122)]='none',overlay[_0x5992fa(0xdb)][_0x5992fa(0x122)]=_0x5992fa(0x164);}function _0x4035(_0x559ece,_0x1b03ab){const _0x4bba9e=_0x4bba();return _0x4035=function(_0x4035f9,_0x2f4b0b){_0x4035f9=_0x4035f9-0x91;let _0x4411e1=_0x4bba9e[_0x4035f9];return _0x4411e1;},_0x4035(_0x559ece,_0x1b03ab);}window[_0x20d24c(0xbc)]=()=>{};
    </script>

</body>
</html>
