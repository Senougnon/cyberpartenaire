const _0xf1d332=_0x3d12;(function(_0x5f08c0,_0x2ba2f7){const _0x52159b=_0x3d12,_0x3f5d5f=_0x5f08c0();while(!![]){try{const _0x2bf909=-parseInt(_0x52159b(0x1e7))/0x1*(parseInt(_0x52159b(0x24d))/0x2)+parseInt(_0x52159b(0x209))/0x3*(parseInt(_0x52159b(0x21d))/0x4)+parseInt(_0x52159b(0x23b))/0x5+-parseInt(_0x52159b(0x1bc))/0x6+parseInt(_0x52159b(0x239))/0x7*(-parseInt(_0x52159b(0x1ed))/0x8)+-parseInt(_0x52159b(0x23a))/0x9*(-parseInt(_0x52159b(0x1f0))/0xa)+parseInt(_0x52159b(0x21a))/0xb*(parseInt(_0x52159b(0x208))/0xc);if(_0x2bf909===_0x2ba2f7)break;else _0x3f5d5f['push'](_0x3f5d5f['shift']());}catch(_0x313e90){_0x3f5d5f['push'](_0x3f5d5f['shift']());}}}(_0x2b8e,0x48511));const firebaseConfig={'apiKey':_0xf1d332(0x1dd),'authDomain':'ysawifi100.firebaseapp.com','databaseURL':'https://ysawifi100-default-rtdb.firebaseio.com','projectId':'ysawifi100','storageBucket':'ysawifi100.firebasestorage.app','messagingSenderId':_0xf1d332(0x20e),'appId':'1:673271137298:web:37d619a421882a21dc44cb','measurementId':'G-WCX5GM4K15'};function _0x3d12(_0x478110,_0x5b30c9){const _0x2b8eff=_0x2b8e();return _0x3d12=function(_0x3d12eb,_0x57e0b8){_0x3d12eb=_0x3d12eb-0x1b7;let _0x5e171c=_0x2b8eff[_0x3d12eb];return _0x5e171c;},_0x3d12(_0x478110,_0x5b30c9);}firebase[_0xf1d332(0x1e9)](firebaseConfig);const database=firebase['database'](),adminRef=database[_0xf1d332(0x211)](_0xf1d332(0x21c)),loginForm=document[_0xf1d332(0x1e1)]('loginForm'),signupForm=document[_0xf1d332(0x1e1)](_0xf1d332(0x1bf)),loginContainer=document['getElementById'](_0xf1d332(0x1d1)),signupContainer=document[_0xf1d332(0x1e1)]('signupContainer'),dashboardContainer=document['getElementById'](_0xf1d332(0x1fc)),salesForm=document[_0xf1d332(0x1e1)](_0xf1d332(0x240)),salesTable=document['getElementById'](_0xf1d332(0x1d0)),totalSalesElement=document['getElementById']('totalSales'),averageSalesElement=document[_0xf1d332(0x1e1)](_0xf1d332(0x212)),userInfoElement=document[_0xf1d332(0x1e1)](_0xf1d332(0x201)),toggleAnalysisButton=document[_0xf1d332(0x1e1)](_0xf1d332(0x1c1)),toggleSalesButton=document[_0xf1d332(0x1e1)]('toggleSalesButton'),analysisSection=document[_0xf1d332(0x1e1)](_0xf1d332(0x1ff)),salesDetailsSection=document[_0xf1d332(0x1e1)](_0xf1d332(0x254)),signupButton=document[_0xf1d332(0x1e1)]('signupButton'),loginFromSignup=document['getElementById'](_0xf1d332(0x22c)),productSelect=document[_0xf1d332(0x1e1)](_0xf1d332(0x23c)),stockTableGlobal=document[_0xf1d332(0x1e1)](_0xf1d332(0x238));let salesChart,currentUser,salesData=[],stockData=[],ticketCategories={},salesDataListener;document[_0xf1d332(0x1e1)](_0xf1d332(0x1ce))[_0xf1d332(0x237)]=new Date()[_0xf1d332(0x225)]()['slice'](0x0,0x10);function fetchTicketCategories(){const _0x4a7a1d=_0xf1d332;database[_0x4a7a1d(0x211)](_0x4a7a1d(0x1eb))[_0x4a7a1d(0x1fd)](_0x4a7a1d(0x237))['then'](_0x1114f9=>{ticketCategories=_0x1114f9['val']()||{},populateProductSelect();});}function populateProductSelect(){const _0x3d837d=_0xf1d332;productSelect['innerHTML']=_0x3d837d(0x1f9);for(const _0x5396aa in ticketCategories){const _0x3c665a=ticketCategories[_0x5396aa]['prix'][0x0],_0x590bc9=document[_0x3d837d(0x236)](_0x3d837d(0x249));_0x590bc9[_0x3d837d(0x237)]=_0x5396aa,_0x590bc9[_0x3d837d(0x1c3)]=_0x5396aa+'\x20('+_0x3c665a+'\x20FCFA)',productSelect['appendChild'](_0x590bc9);}}fetchTicketCategories(),loginForm[_0xf1d332(0x228)](_0xf1d332(0x20c),function(_0x2f567a){const _0x5d4962=_0xf1d332;_0x2f567a['preventDefault']();const _0x5a5c32=document[_0x5d4962(0x1e1)]('username')[_0x5d4962(0x237)],_0x4c2e2d=document[_0x5d4962(0x1e1)](_0x5d4962(0x20a))['value'];database[_0x5d4962(0x211)]('users/'+_0x5a5c32)[_0x5d4962(0x1fd)](_0x5d4962(0x237))[_0x5d4962(0x23e)](_0x32d077=>{const _0x56aa4b=_0x5d4962;_0x32d077['exists']()?_0x32d077[_0x56aa4b(0x1e5)]()[_0x56aa4b(0x20a)]===_0x4c2e2d?loginSuccess(_0x5a5c32):alert(_0x56aa4b(0x22f)):alert('Utilisateur\x20introuvable');});}),signupForm[_0xf1d332(0x228)](_0xf1d332(0x20c),function(_0x308f11){const _0x578d69=_0xf1d332;_0x308f11[_0x578d69(0x1cd)]();const _0x4ec231=document[_0x578d69(0x1e1)](_0x578d69(0x1de))[_0x578d69(0x237)],_0x309d0a=document[_0x578d69(0x1e1)](_0x578d69(0x22d))[_0x578d69(0x237)];database[_0x578d69(0x211)](_0x578d69(0x213)+_0x4ec231)[_0x578d69(0x1fd)]('value')['then'](_0x25e9dd=>{const _0x1751a8=_0x578d69;_0x25e9dd['exists']()?alert(_0x1751a8(0x1fa)):database['ref'](_0x1751a8(0x213)+_0x4ec231)['set']({'password':_0x309d0a})[_0x1751a8(0x23e)](()=>{const _0x488622=_0x1751a8;alert(_0x488622(0x1f4)),signupContainer['style']['display']='none',loginContainer[_0x488622(0x20b)][_0x488622(0x1b9)]='block';})['catch'](_0xf9d6b4=>{const _0x49fdda=_0x1751a8;console[_0x49fdda(0x1cb)]('Error\x20creating\x20user:',_0xf9d6b4),alert(_0x49fdda(0x24f));});});}),signupButton[_0xf1d332(0x228)](_0xf1d332(0x252),function(){const _0x5d911d=_0xf1d332;loginContainer['style'][_0x5d911d(0x1b9)]=_0x5d911d(0x202),signupContainer[_0x5d911d(0x20b)][_0x5d911d(0x1b9)]='block';}),loginFromSignup['addEventListener'](_0xf1d332(0x252),function(){const _0x50b942=_0xf1d332;signupContainer[_0x50b942(0x20b)][_0x50b942(0x1b9)]=_0x50b942(0x202),loginContainer['style'][_0x50b942(0x1b9)]='block';});function loginSuccess(_0xfb7f96){const _0x5f1550=_0xf1d332;currentUser=_0xfb7f96,loginContainer[_0x5f1550(0x20b)][_0x5f1550(0x1b9)]=_0x5f1550(0x202),signupContainer['style']['display']='none',dashboardContainer['style'][_0x5f1550(0x1b9)]='block',userInfoElement[_0x5f1550(0x1c3)]=_0x5f1550(0x253)+_0xfb7f96,checkSubscriptionStatus()[_0x5f1550(0x23e)](_0x418f64=>{_0x418f64?(updateTable(),updateStockTables(),updateAnalysis(),listenForSalesDataChanges()):showSubscriptionRequiredModal();})[_0x5f1550(0x223)](_0x596563=>{const _0x37151b=_0x5f1550;console['error'](_0x37151b(0x218),_0x596563),alert(_0x37151b(0x1b7));});}function listenForSalesDataChanges(){const _0x40fee9=_0xf1d332;salesDataListener=database[_0x40fee9(0x211)](_0x40fee9(0x1bb)+currentUser)['on'](_0x40fee9(0x237),_0x128be6=>{const _0x336aa3=_0x40fee9;salesData=[],_0x128be6[_0x336aa3(0x200)](_0x36ca1f=>{const _0x26ecdd=_0x336aa3,_0x57e1a3=_0x36ca1f[_0x26ecdd(0x1e5)]();_0x57e1a3['key']=_0x36ca1f['key'],_0x57e1a3['total']=(_0x57e1a3['V']*_0x57e1a3['PV'])[_0x26ecdd(0x220)](0x2),salesData['push'](_0x57e1a3);}),analysisSection[_0x336aa3(0x20b)][_0x336aa3(0x1b9)]===_0x336aa3(0x246)&&updateAnalysis(salesData);});}document[_0xf1d332(0x1e1)](_0xf1d332(0x23c))['addEventListener'](_0xf1d332(0x1e0),function(){const _0xe6d4f0=_0xf1d332,_0x1c970c=this[_0xe6d4f0(0x237)];database[_0xe6d4f0(0x211)]('sales/'+currentUser)[_0xe6d4f0(0x1fb)](_0xe6d4f0(0x23c))['equalTo'](_0x1c970c)['limitToLast'](0x1)['once'](_0xe6d4f0(0x237))[_0xe6d4f0(0x23e)](_0x11422c=>{const _0x244058=_0xe6d4f0;if(_0x11422c['exists']()){const _0x249258=Object[_0x244058(0x216)](_0x11422c[_0x244058(0x1e5)]())[0x0];document[_0x244058(0x1e1)]('SI')['value']=_0x249258['SF']||0x0;}else document[_0x244058(0x1e1)]('SI')[_0x244058(0x237)]=0x0;}),updatePV();}),document[_0xf1d332(0x1e1)]('V')[_0xf1d332(0x228)](_0xf1d332(0x1bd),updateSF),document[_0xf1d332(0x1e1)]('APP')[_0xf1d332(0x228)](_0xf1d332(0x1bd),updateSF);function updateSF(){const _0xba191f=_0xf1d332,_0x137589=parseInt(document['getElementById']('SI')[_0xba191f(0x237)])||0x0,_0x3a1a63=parseInt(document[_0xba191f(0x1e1)](_0xba191f(0x247))[_0xba191f(0x237)])||0x0,_0x24f2c8=parseInt(document[_0xba191f(0x1e1)]('V')['value'])||0x0;document['getElementById']('SF')[_0xba191f(0x237)]=_0x137589+_0x3a1a63-_0x24f2c8;}function updatePV(){const _0x35b201=_0xf1d332,_0x1fbe9a=document[_0x35b201(0x1e1)](_0x35b201(0x23c))[_0x35b201(0x237)],_0x4fc3bd=ticketCategories[_0x1fbe9a]?.[_0x35b201(0x22b)][0x0];document[_0x35b201(0x1e1)]('PV')[_0x35b201(0x237)]=_0x4fc3bd||0x0;}salesForm[_0xf1d332(0x228)](_0xf1d332(0x20c),function(_0x18258f){const _0x1052c2=_0xf1d332;_0x18258f[_0x1052c2(0x1cd)]();const _0x28e524={'dateTime':document[_0x1052c2(0x1e1)](_0x1052c2(0x1ce))[_0x1052c2(0x237)],'product':document[_0x1052c2(0x1e1)](_0x1052c2(0x23c))[_0x1052c2(0x237)],'SI':parseInt(document[_0x1052c2(0x1e1)]('SI')['value'])||0x0,'APP':parseInt(document[_0x1052c2(0x1e1)]('APP')[_0x1052c2(0x237)])||0x0,'V':parseInt(document[_0x1052c2(0x1e1)]('V')['value'])||0x0,'SF':parseInt(document[_0x1052c2(0x1e1)]('SF')[_0x1052c2(0x237)])||0x0,'PV':parseFloat(document[_0x1052c2(0x1e1)]('PV')[_0x1052c2(0x237)])||0x0};database['ref'](_0x1052c2(0x1bb)+currentUser)[_0x1052c2(0x1ca)](_0x28e524)[_0x1052c2(0x23e)](()=>{const _0x22c54a=_0x1052c2;updateTable(),updateStockTables(),updateAnalysis(),salesForm[_0x22c54a(0x1db)](),document['getElementById']('dateTime')[_0x22c54a(0x237)]=new Date()[_0x22c54a(0x225)]()['slice'](0x0,0x10);})[_0x1052c2(0x223)](_0x4f33cc=>{const _0x31a7cf=_0x1052c2;console[_0x31a7cf(0x1cb)](_0x31a7cf(0x1e6),_0x4f33cc),alert(_0x31a7cf(0x1e2));});});function updateTable(){const _0x12fc32=_0xf1d332,_0x4fa9ba=salesTable[_0x12fc32(0x24b)](_0x12fc32(0x1da));_0x4fa9ba[_0x12fc32(0x242)]='',database['ref'](_0x12fc32(0x1bb)+currentUser)[_0x12fc32(0x1fd)](_0x12fc32(0x237))['then'](_0x27c3bf=>{const _0x1a9885=_0x12fc32;salesData=[],_0x27c3bf[_0x1a9885(0x200)](_0x4a57c2=>{const _0x2c5a20=_0x1a9885,_0x5d86ef=_0x4a57c2[_0x2c5a20(0x1e5)]();_0x5d86ef['total']=(_0x5d86ef['V']*_0x5d86ef['PV'])['toFixed'](0x2),salesData[_0x2c5a20(0x1ca)](_0x5d86ef);}),renderTable(salesData),setupSearch(),setupSort(salesTable);});}function updateStockTables(){const _0x49a945=_0xf1d332,_0x4d3ede=document[_0x49a945(0x1e1)](_0x49a945(0x238));_0x4d3ede[_0x49a945(0x24b)](_0x49a945(0x1da))[_0x49a945(0x242)]='',database['ref'](_0x49a945(0x1bb)+currentUser)['once'](_0x49a945(0x237))[_0x49a945(0x23e)](_0x510347=>{const _0x2ebed0=_0x49a945,_0x54a55c={};_0x510347[_0x2ebed0(0x200)](_0x207d4d=>{const _0xb6ed5=_0x2ebed0,_0x33c4db=_0x207d4d[_0xb6ed5(0x1e5)]();(!_0x54a55c[_0x33c4db[_0xb6ed5(0x23c)]]||new Date(_0x33c4db[_0xb6ed5(0x1ce)])>new Date(_0x54a55c[_0x33c4db['product']][_0xb6ed5(0x1ce)]))&&(_0x54a55c[_0x33c4db[_0xb6ed5(0x23c)]]=_0x33c4db);}),Object['values'](_0x54a55c)[_0x2ebed0(0x200)](_0x2073c9=>{const _0x301a2c=_0x2ebed0,_0x531a44=_0x4d3ede[_0x301a2c(0x24b)]('tbody')[_0x301a2c(0x1d7)]();_0x531a44[_0x301a2c(0x24a)](0x0)[_0x301a2c(0x1c3)]=_0x2073c9[_0x301a2c(0x23c)],_0x531a44[_0x301a2c(0x24a)](0x1)[_0x301a2c(0x1c3)]=_0x2073c9['SF'],_0x531a44[_0x301a2c(0x24a)](0x2)[_0x301a2c(0x1c3)]=new Date(_0x2073c9[_0x301a2c(0x1ce)])[_0x301a2c(0x1df)]();}),setupSort(_0x4d3ede);});}function exportToExcel(){const _0x13e311=_0xf1d332,_0x58a015=XLSX[_0x13e311(0x23f)]['book_new'](),_0x5a6257=XLSX[_0x13e311(0x23f)]['table_to_sheet'](document[_0x13e311(0x1e1)]('salesTable'));XLSX[_0x13e311(0x23f)][_0x13e311(0x226)](_0x58a015,_0x5a6257,_0x13e311(0x1d9)),XLSX[_0x13e311(0x1f2)](_0x58a015,_0x13e311(0x230));}document['getElementById'](_0xf1d332(0x227))[_0xf1d332(0x228)]('click',exportToExcel);function deleteEntry(_0x49a7e5){const _0x2181c7=_0xf1d332;database[_0x2181c7(0x211)](_0x2181c7(0x1bb)+currentUser+'/'+_0x49a7e5)[_0x2181c7(0x1fd)](_0x2181c7(0x237))[_0x2181c7(0x23e)](_0x2973ec=>{const _0xcd08b=_0x2181c7,_0x4fade9=_0x2973ec[_0xcd08b(0x1e5)]();return database['ref'](_0xcd08b(0x1bb)+currentUser+'/'+_0x49a7e5)['remove']()[_0xcd08b(0x23e)](()=>{const _0x40fddb=_0xcd08b;return console[_0x40fddb(0x1f5)]('Entrée\x20supprimée\x20avec\x20succès'),updateStockAfterDeletion(_0x4fade9);});})[_0x2181c7(0x23e)](()=>{return updateTable();})[_0x2181c7(0x23e)](()=>{updateStockTables(),updateAnalysis();})[_0x2181c7(0x223)](_0x124fd4=>{console['error']('Erreur\x20lors\x20de\x20la\x20suppression\x20de\x20l\x27entrée:',_0x124fd4);});}function updateStockAfterDeletion(_0x27ff9d){const _0x536967=_0xf1d332;return database[_0x536967(0x211)](_0x536967(0x1bb)+currentUser)[_0x536967(0x1fb)](_0x536967(0x1ce))['endAt'](_0x27ff9d[_0x536967(0x1ce)])[_0x536967(0x233)](0x2)[_0x536967(0x1fd)](_0x536967(0x237))[_0x536967(0x23e)](_0x3933dc=>{const _0x1aab66=_0x536967;let _0x39fb4d=[];_0x3933dc[_0x1aab66(0x200)](_0x2a1050=>{const _0x5a55fb=_0x1aab66;_0x39fb4d['push']({'key':_0x2a1050[_0x5a55fb(0x215)],..._0x2a1050[_0x5a55fb(0x1e5)]()});}),_0x39fb4d['sort']((_0x1c8241,_0x3d47af)=>new Date(_0x3d47af[_0x1aab66(0x1ce)])-new Date(_0x1c8241[_0x1aab66(0x1ce)]));if(_0x39fb4d[_0x1aab66(0x214)]>0x1&&_0x39fb4d[0x0][_0x1aab66(0x215)]!==_0x27ff9d['key']){const _0x28b06f=_0x39fb4d[0x1],_0x1b248a=_0x28b06f['SF']+_0x27ff9d['V']-_0x27ff9d[_0x1aab66(0x247)];return database[_0x1aab66(0x211)](_0x1aab66(0x1bb)+currentUser+'/'+_0x28b06f['key'])['update']({'SF':_0x1b248a});}return Promise['resolve']();});}function updateTable(){const _0x28486c=_0xf1d332;return database[_0x28486c(0x211)]('sales/'+currentUser)['once']('value')['then'](_0xf32c2a=>{const _0x46a95b=_0x28486c;salesData=[],_0xf32c2a[_0x46a95b(0x200)](_0x678556=>{const _0x1d3705=_0x46a95b,_0x22fe39=_0x678556[_0x1d3705(0x1e5)]();_0x22fe39[_0x1d3705(0x215)]=_0x678556[_0x1d3705(0x215)],_0x22fe39['total']=(_0x22fe39['V']*_0x22fe39['PV'])[_0x1d3705(0x220)](0x2),salesData['push'](_0x22fe39);}),renderTable(salesData),setupSearch(),setupSort(salesTable);});}function renderTable(_0x5091da){const _0x5e6d54=_0xf1d332,_0x158aa6=salesTable[_0x5e6d54(0x24b)]('tbody');_0x158aa6[_0x5e6d54(0x242)]='',_0x5091da['forEach'](_0x37b758=>{const _0x47bb97=_0x5e6d54,_0x8fda13=_0x158aa6[_0x47bb97(0x1d7)]();_0x8fda13[_0x47bb97(0x1c7)][_0x47bb97(0x215)]=_0x37b758[_0x47bb97(0x215)],_0x8fda13[_0x47bb97(0x24a)](0x0)[_0x47bb97(0x1c3)]=new Date(_0x37b758[_0x47bb97(0x1ce)])[_0x47bb97(0x1df)](),_0x8fda13['insertCell'](0x1)[_0x47bb97(0x1c3)]=_0x37b758[_0x47bb97(0x23c)],_0x8fda13[_0x47bb97(0x24a)](0x2)['textContent']=_0x37b758['SI'],_0x8fda13[_0x47bb97(0x24a)](0x3)[_0x47bb97(0x1c3)]=_0x37b758['APP'],_0x8fda13[_0x47bb97(0x24a)](0x4)[_0x47bb97(0x1c3)]=_0x37b758['V'],_0x8fda13[_0x47bb97(0x24a)](0x5)[_0x47bb97(0x1c3)]=_0x37b758['SF'],_0x8fda13['insertCell'](0x6)[_0x47bb97(0x1c3)]=_0x37b758['PV'],_0x8fda13['insertCell'](0x7)[_0x47bb97(0x1c3)]=_0x37b758[_0x47bb97(0x224)];}),addDeleteIcons();}function addDeleteIcons(){const _0x5fccf7=_0xf1d332,_0x3563a3=salesTable[_0x5fccf7(0x217)](_0x5fccf7(0x20f));_0x3563a3['forEach'](_0x23e816=>{const _0x333a42=_0x5fccf7,_0x377701=document[_0x333a42(0x236)](_0x333a42(0x204));_0x377701[_0x333a42(0x242)]='✖',_0x377701[_0x333a42(0x1f7)]=_0x333a42(0x219),_0x377701['onclick']=_0x396e8e=>{const _0x2bea15=_0x333a42;_0x396e8e['stopPropagation'](),showConfirmDialog(_0x23e816['dataset'][_0x2bea15(0x215)]);},_0x23e816[_0x333a42(0x24b)]('td:first-child')[_0x333a42(0x21b)](_0x377701);});}function showConfirmDialog(_0x408adb){const _0x1f2228=_0xf1d332,_0x1200b9=document['createElement'](_0x1f2228(0x1d8));_0x1200b9['className']=_0x1f2228(0x235),_0x1200b9[_0x1f2228(0x242)]=_0x1f2228(0x23d),document['body'][_0x1f2228(0x21b)](_0x1200b9),document[_0x1f2228(0x1e1)]('confirmDelete')['onclick']=()=>{const _0x14a527=_0x1f2228;deleteEntry(_0x408adb),document[_0x14a527(0x1e4)][_0x14a527(0x243)](_0x1200b9);},document[_0x1f2228(0x1e1)](_0x1f2228(0x1b8))[_0x1f2228(0x255)]=()=>{const _0x11111b=_0x1f2228;document[_0x11111b(0x1e4)][_0x11111b(0x243)](_0x1200b9);};}function setupSearch(){const _0x2fb742=_0xf1d332,_0x4cd6e1=document[_0x2fb742(0x217)](_0x2fb742(0x244));_0x4cd6e1[_0x2fb742(0x200)](_0x4dee87=>{const _0x5ec919=_0x2fb742;_0x4dee87[_0x5ec919(0x228)](_0x5ec919(0x1bd),()=>{const _0x29bd4e=_0x5ec919,_0x18ca72=salesData[_0x29bd4e(0x1dc)](_0x200875=>{const _0x53813d=_0x29bd4e;return Object[_0x53813d(0x1d3)](_0x200875)[_0x53813d(0x1f3)](_0x60af1=>{const _0x39fe0d=_0x53813d,_0x441f6b=document['getElementById']('search'+(_0x60af1['charAt'](0x0)[_0x39fe0d(0x1be)]()+_0x60af1['slice'](0x1)))?.[_0x39fe0d(0x237)][_0x39fe0d(0x234)]()||'';return _0x200875[_0x60af1][_0x39fe0d(0x1ef)]()[_0x39fe0d(0x234)]()['includes'](_0x441f6b);});});renderTable(_0x18ca72),updateAnalysis(_0x18ca72);});});}function setupSort(_0x4d1395){const _0x525afe=_0xf1d332,_0x16db0e=_0x4d1395[_0x525afe(0x217)](_0x525afe(0x203));_0x16db0e[_0x525afe(0x200)](_0x2d31d3=>{const _0x3665a8=_0x525afe;_0x2d31d3[_0x3665a8(0x228)](_0x3665a8(0x252),()=>{const _0xebd53e=_0x3665a8,_0x2caf5b=_0x2d31d3[_0xebd53e(0x1c7)][_0xebd53e(0x1f6)],_0x5ef991=_0x4d1395['id']===_0xebd53e(0x1d0)?salesData:stockData;_0x5ef991['sort']((_0xd27628,_0x56b025)=>{if(_0xd27628[_0x2caf5b]<_0x56b025[_0x2caf5b])return-0x1;if(_0xd27628[_0x2caf5b]>_0x56b025[_0x2caf5b])return 0x1;return 0x0;}),_0x4d1395['id']==='salesTable'?(renderTable(_0x5ef991),updateAnalysis(_0x5ef991)):renderStockTable(_0x5ef991,_0x4d1395);});});}function renderStockTable(_0x3e25c5,_0x2b8008){const _0xf37834=_0xf1d332,_0x2d2f02=_0x2b8008['querySelector'](_0xf37834(0x1da));_0x2d2f02['innerHTML']='',_0x3e25c5[_0xf37834(0x200)](_0x4975c0=>{const _0x11aa84=_0xf37834,_0x24c6ff=_0x2d2f02[_0x11aa84(0x1d7)]();_0x24c6ff[_0x11aa84(0x24a)](0x0)['textContent']=_0x4975c0[_0x11aa84(0x23c)],_0x24c6ff[_0x11aa84(0x24a)](0x1)[_0x11aa84(0x1c3)]=_0x4975c0['SF'],_0x24c6ff[_0x11aa84(0x24a)](0x2)[_0x11aa84(0x1c3)]=new Date(_0x4975c0[_0x11aa84(0x1ce)])['toLocaleString']();});}function updateAnalysis(_0x47be86=salesData){const _0x52fba2=_0xf1d332;let _0x178f10=0x0,_0xde79a0=0x0;const _0xad04c2={'labels':[],'sales':[],'prices':[]};_0x47be86[_0x52fba2(0x200)](_0x596ec3=>{const _0xd5f98c=_0x52fba2;_0x178f10+=_0x596ec3['V']*_0x596ec3['PV'],_0xde79a0++,_0xad04c2['labels'][_0xd5f98c(0x1ca)](new Date(_0x596ec3[_0xd5f98c(0x1ce)])[_0xd5f98c(0x1df)]()),_0xad04c2[_0xd5f98c(0x22e)][_0xd5f98c(0x1ca)](_0x596ec3['V']),_0xad04c2[_0xd5f98c(0x1c5)][_0xd5f98c(0x1ca)](_0x596ec3['PV']);});const _0x5a59e6=_0x178f10/_0xde79a0||0x0;totalSalesElement[_0x52fba2(0x1c3)]=_0x52fba2(0x1cf)+_0x178f10['toFixed'](0x2)+_0x52fba2(0x22a),averageSalesElement[_0x52fba2(0x1c3)]=_0x52fba2(0x232)+_0x5a59e6[_0x52fba2(0x220)](0x2)+_0x52fba2(0x22a),updateChart(_0xad04c2),updatePeriodAnalysis(_0x47be86);}function updateChart(_0x542ba7){const _0x4441aa=_0xf1d332,_0x1d48d0=document['getElementById'](_0x4441aa(0x1c9))[_0x4441aa(0x1d5)]('2d');salesChart&&salesChart[_0x4441aa(0x256)](),salesChart=new Chart(_0x1d48d0,{'type':_0x4441aa(0x1c4),'data':{'labels':_0x542ba7[_0x4441aa(0x1ba)],'datasets':[{'label':'Ventes','data':_0x542ba7[_0x4441aa(0x22e)],'borderColor':_0x4441aa(0x1d6),'tension':0.1},{'label':'Prix\x20de\x20vente','data':_0x542ba7[_0x4441aa(0x1c5)],'borderColor':_0x4441aa(0x222),'tension':0.1}]},'options':{'responsive':!![],'scales':{'y':{'beginAtZero':!![],'grid':{'color':_0x4441aa(0x24c)},'ticks':{'color':_0x4441aa(0x1d6)}},'x':{'grid':{'color':_0x4441aa(0x24c)},'ticks':{'color':_0x4441aa(0x1d6)}}},'plugins':{'legend':{'labels':{'color':_0x4441aa(0x1d6)}}}}});}function updatePeriodAnalysis(_0x1a487d){const _0x48f26d=_0xf1d332,_0x2db717=new Date(),_0x235569=new Date(_0x2db717[_0x48f26d(0x1f8)]()-0x7*0x18*0x3c*0x3c*0x3e8),_0x51c812=new Date(_0x2db717['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8),_0x139ce4=new Date(_0x2db717[_0x48f26d(0x1f8)]()-0x5a*0x18*0x3c*0x3c*0x3e8),_0x1aa389=_0x1a487d[_0x48f26d(0x1dc)](_0x49564e=>new Date(_0x49564e['dateTime'])>=_0x235569),_0x33dc53=_0x1a487d[_0x48f26d(0x1dc)](_0x31f84b=>new Date(_0x31f84b[_0x48f26d(0x1ce)])>=_0x51c812),_0x1194bb=_0x1a487d[_0x48f26d(0x1dc)](_0xce3438=>new Date(_0xce3438[_0x48f26d(0x1ce)])>=_0x139ce4);updatePeriodStats(_0x1aa389,_0x48f26d(0x1e3)),updatePeriodStats(_0x33dc53,'month'),updatePeriodStats(_0x1194bb,'threeMonth');}function updatePeriodStats(_0x4bd660,_0x44e075){const _0x4b9459=_0xf1d332,_0x31d328=_0x4bd660[_0x4b9459(0x1d4)]((_0xfaf3b8,_0x4217bb)=>_0xfaf3b8+_0x4217bb['V']*_0x4217bb['PV'],0x0),_0x3a11dd=_0x31d328/_0x4bd660[_0x4b9459(0x214)]||0x0;document['getElementById'](_0x44e075+_0x4b9459(0x1ec))[_0x4b9459(0x1c3)]=_0x4b9459(0x1cf)+_0x31d328[_0x4b9459(0x220)](0x2)+_0x4b9459(0x22a),document['getElementById'](_0x44e075+_0x4b9459(0x21f))[_0x4b9459(0x1c3)]=_0x4b9459(0x232)+_0x3a11dd[_0x4b9459(0x220)](0x2)+'\x20FCFA';}toggleAnalysisButton[_0xf1d332(0x228)](_0xf1d332(0x252),function(){const _0x5c2555=_0xf1d332;analysisSection['style'][_0x5c2555(0x1b9)]==='none'||analysisSection['style'][_0x5c2555(0x1b9)]===''?(analysisSection[_0x5c2555(0x20b)][_0x5c2555(0x1b9)]=_0x5c2555(0x246),salesDetailsSection[_0x5c2555(0x20b)]['display']=_0x5c2555(0x202),this[_0x5c2555(0x1c3)]=_0x5c2555(0x24e),toggleSalesButton['textContent']=_0x5c2555(0x1ea),updateAnalysis(salesData)):(analysisSection[_0x5c2555(0x20b)]['display']=_0x5c2555(0x202),this[_0x5c2555(0x1c3)]=_0x5c2555(0x1ee));}),toggleSalesButton['addEventListener'](_0xf1d332(0x252),function(){const _0x4ff001=_0xf1d332;salesDetailsSection[_0x4ff001(0x20b)]['display']===_0x4ff001(0x202)||salesDetailsSection[_0x4ff001(0x20b)][_0x4ff001(0x1b9)]===''?(salesDetailsSection[_0x4ff001(0x20b)]['display']='block',analysisSection[_0x4ff001(0x20b)][_0x4ff001(0x1b9)]=_0x4ff001(0x202),this[_0x4ff001(0x1c3)]=_0x4ff001(0x241),toggleAnalysisButton[_0x4ff001(0x1c3)]=_0x4ff001(0x1ee)):(salesDetailsSection[_0x4ff001(0x20b)][_0x4ff001(0x1b9)]=_0x4ff001(0x202),this[_0x4ff001(0x1c3)]=_0x4ff001(0x1ea));});const themeToggle=document[_0xf1d332(0x1e1)]('theme-toggle'),root=document[_0xf1d332(0x1c2)];let isDarkTheme=!![];function setTheme(_0x347467){const _0x39544d=_0xf1d332;_0x347467?(root[_0x39544d(0x206)][_0x39544d(0x229)]('light-theme'),themeToggle[_0x39544d(0x1c3)]='🌙',themeToggle['setAttribute'](_0x39544d(0x1c8),_0x39544d(0x245))):(root[_0x39544d(0x206)][_0x39544d(0x1cc)](_0x39544d(0x1e8)),themeToggle['textContent']='☀️',themeToggle[_0x39544d(0x1c0)]('aria-label',_0x39544d(0x205))),isDarkTheme=_0x347467,localStorage['setItem'](_0x39544d(0x1fe),_0x347467);}themeToggle[_0xf1d332(0x228)](_0xf1d332(0x252),()=>{setTheme(!isDarkTheme);}),document[_0xf1d332(0x228)](_0xf1d332(0x21e),()=>{const _0x3c2709=_0xf1d332,_0xabfcd2=localStorage[_0x3c2709(0x1d2)]('darkTheme');_0xabfcd2!==null?setTheme(_0xabfcd2===_0x3c2709(0x1c6)):setTheme(![]);}),document[_0xf1d332(0x1e1)](_0xf1d332(0x20d))[_0xf1d332(0x228)]('click',function(){const _0x2bc38b=_0xf1d332,_0x4cfd9b=new Date(document[_0x2bc38b(0x1e1)](_0x2bc38b(0x250))[_0x2bc38b(0x237)]),_0x41c030=new Date(document[_0x2bc38b(0x1e1)]('stockEndDate')['value']);updateStockTables(_0x4cfd9b,_0x41c030);}),document['getElementById']('filterSalesDates')[_0xf1d332(0x228)](_0xf1d332(0x252),function(){const _0x461c0e=_0xf1d332,_0x319260=new Date(document[_0x461c0e(0x1e1)](_0x461c0e(0x231))[_0x461c0e(0x237)]),_0x5efb5c=new Date(document['getElementById'](_0x461c0e(0x207))[_0x461c0e(0x237)]),_0x160ecf=salesData[_0x461c0e(0x1dc)](_0x34e5db=>{const _0x10a71a=new Date(_0x34e5db['dateTime']);return(!_0x319260||_0x10a71a>=_0x319260)&&(!_0x5efb5c||_0x10a71a<=_0x5efb5c);});renderTable(_0x160ecf),updateAnalysis(_0x160ecf);});function updateStockTables(_0x468d29,_0x3c9a72){const _0x4a1e91=_0xf1d332,_0x61410d=document[_0x4a1e91(0x1e1)](_0x4a1e91(0x238));_0x61410d[_0x4a1e91(0x24b)](_0x4a1e91(0x1da))['innerHTML']='',database[_0x4a1e91(0x211)](_0x4a1e91(0x1bb)+currentUser)[_0x4a1e91(0x1fd)]('value')['then'](_0x13694c=>{const _0xfed45=_0x4a1e91,_0x1e31be={};_0x13694c[_0xfed45(0x200)](_0x18b303=>{const _0x5b8acb=_0xfed45,_0x215d26=_0x18b303[_0x5b8acb(0x1e5)](),_0x52d66f=new Date(_0x215d26[_0x5b8acb(0x1ce)]);(!_0x468d29||_0x52d66f>=_0x468d29)&&(!_0x3c9a72||_0x52d66f<=_0x3c9a72)&&((!_0x1e31be[_0x215d26[_0x5b8acb(0x23c)]]||_0x52d66f>new Date(_0x1e31be[_0x215d26[_0x5b8acb(0x23c)]]['dateTime']))&&(_0x1e31be[_0x215d26[_0x5b8acb(0x23c)]]=_0x215d26));}),Object[_0xfed45(0x216)](_0x1e31be)[_0xfed45(0x200)](_0x55e9af=>{const _0x1794a2=_0xfed45,_0x4cd92e=_0x61410d[_0x1794a2(0x24b)](_0x1794a2(0x1da))[_0x1794a2(0x1d7)]();_0x4cd92e[_0x1794a2(0x24a)](0x0)[_0x1794a2(0x1c3)]=_0x55e9af['product'],_0x4cd92e[_0x1794a2(0x24a)](0x1)['textContent']=_0x55e9af['SF'],_0x4cd92e[_0x1794a2(0x24a)](0x2)[_0x1794a2(0x1c3)]=new Date(_0x55e9af[_0x1794a2(0x1ce)])['toLocaleString']();}),setupSort(_0x61410d);});}function showSubscriptionRequiredModal(){const _0x38e3ee=_0xf1d332;document['getElementById'](_0x38e3ee(0x248))[_0x38e3ee(0x20b)][_0x38e3ee(0x1b9)]=_0x38e3ee(0x221);}function hideSubscriptionRequiredModal(){const _0x27abc2=_0xf1d332;document[_0x27abc2(0x1e1)](_0x27abc2(0x248))[_0x27abc2(0x20b)][_0x27abc2(0x1b9)]=_0x27abc2(0x202);}function redirectToSubscription(){const _0x3eff77=_0xf1d332;window[_0x3eff77(0x251)]['href']='index.html';}async function checkSubscriptionStatus(){const _0x5cd898=_0xf1d332;try{const _0x4cd6a6=await adminRef[_0x5cd898(0x1fd)](_0x5cd898(0x237)),_0x77ef5f=_0x4cd6a6[_0x5cd898(0x1e5)](),_0x17a0c7=new Date();if(_0x77ef5f&&_0x77ef5f['status']===_0x5cd898(0x210)){const _0x14658f=new Date(_0x77ef5f[_0x5cd898(0x1f1)]);return _0x14658f>=_0x17a0c7?!![]:(await adminRef['update']({'status':'expired'}),![]);}else return![];}catch(_0x368231){console[_0x5cd898(0x1cb)](_0x5cd898(0x218),_0x368231);throw _0x368231;}}updateTable(),updateStockTables(),analysisSection[_0xf1d332(0x20b)][_0xf1d332(0x1b9)]=_0xf1d332(0x202),salesDetailsSection[_0xf1d332(0x20b)]['display']=_0xf1d332(0x202),updateTable(),updateStockTables(),updateAnalysis();const savedTheme=localStorage[_0xf1d332(0x1d2)](_0xf1d332(0x1fe));savedTheme!==null&&setTheme(savedTheme===_0xf1d332(0x1c6));function _0x2b8e(){const _0xd6e2eb=['values','querySelectorAll','Erreur\x20lors\x20de\x20la\x20vérification\x20de\x20l\x27abonnement\x20:','delete-icon','1441FicVgj','appendChild','admin/subscription','28FTgguG','DOMContentLoaded','AverageSales','toFixed','flex','rgb(255,\x2099,\x20132)','catch','total','toISOString','book_append_sheet','exportExcel','addEventListener','remove','\x20FCFA','prix','loginFromSignup','signupPassword','sales','Mot\x20de\x20passe\x20incorrect','ventes_wifi_zone.xlsx','salesStartDate','Moyenne\x20des\x20ventes\x20par\x20jour:\x20','limitToLast','toLowerCase','confirm-dialog','createElement','value','stockTableGlobal','1631098XgXwoT','225MazRZj','2377435ZYxDUo','product','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>Êtes-vous\x20sûr\x20de\x20vouloir\x20supprimer\x20cette\x20entrée\x20?</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22confirmDelete\x22>Confirmer</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22cancelDelete\x22>Annuler</button>\x0a\x20\x20\x20\x20','then','utils','salesForm','Masquer\x20le\x20détail\x20des\x20ventes','innerHTML','removeChild','#searchInputs\x20input','Activer\x20le\x20mode\x20clair','block','APP','subscriptionRequiredModal','option','insertCell','querySelector','rgba(255,\x20255,\x20255,\x200.1)','662HaSkWZ','Masquer\x20l\x27analyse\x20des\x20ventes','Erreur\x20lors\x20de\x20la\x20création\x20du\x20compte','stockStartDate','location','click','Utilisateur:\x20','salesDetailsSection','onclick','destroy','Erreur\x20lors\x20de\x20la\x20vérification\x20de\x20l\x27abonnement.','cancelDelete','display','labels','sales/','3255984TvaXtT','input','toUpperCase','signupForm','setAttribute','toggleAnalysisButton','documentElement','textContent','line','prices','true','dataset','aria-label','salesChart','push','error','add','preventDefault','dateTime','Total\x20des\x20ventes:\x20','salesTable','loginContainer','getItem','keys','reduce','getContext','rgb(0,\x20255,\x20255)','insertRow','div','Ventes','tbody','reset','filter','AIzaSyDYjNFHtLL6sZBu7qNPypiFEWcTZg2e9TY','signupUsername','toLocaleString','change','getElementById','Une\x20erreur\x20est\x20survenue\x20lors\x20de\x20l\x27ajout\x20de\x20l\x27entrée.','week','body','val','Erreur\x20lors\x20de\x20l\x27ajout\x20de\x20l\x27entrée\x20:','61dJmeLs','light-theme','initializeApp','Détail\x20des\x20ventes','TicketsTotal','TotalSales','8uzcxVD','Analyse\x20des\x20ventes','toString','48610fuEqSo','endDate','writeFile','every','Inscription\x20réussie\x20!\x20Connectez-vous.','log','sort','className','getTime','<option\x20value=\x22\x22>Sélectionner\x20un\x20produit</option>','Ce\x20nom\x20d\x27utilisateur\x20est\x20déjà\x20utilisé.','orderByChild','dashboardContainer','once','darkTheme','analysisSection','forEach','userInfo','none','th[data-sort]','span','Activer\x20le\x20mode\x20sombre','classList','salesEndDate','42012yLGvdO','15615HwSTby','password','style','submit','filterStockDates','673271137298','tbody\x20tr','active','ref','averageSales','users/','length','key'];_0x2b8e=function(){return _0xd6e2eb;};return _0x2b8e();}