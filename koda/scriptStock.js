const _0x133ef7=_0x5873;(function(_0x5896dd,_0x58e051){const _0x591652=_0x5873,_0x1e2772=_0x5896dd();while(!![]){try{const _0x30da9c=-parseInt(_0x591652(0x22c))/0x1*(parseInt(_0x591652(0x202))/0x2)+-parseInt(_0x591652(0x21a))/0x3+-parseInt(_0x591652(0x1ba))/0x4+parseInt(_0x591652(0x1d6))/0x5+-parseInt(_0x591652(0x1ec))/0x6*(parseInt(_0x591652(0x1ff))/0x7)+parseInt(_0x591652(0x1e3))/0x8+parseInt(_0x591652(0x1a6))/0x9;if(_0x30da9c===_0x58e051)break;else _0x1e2772['push'](_0x1e2772['shift']());}catch(_0x46b1c4){_0x1e2772['push'](_0x1e2772['shift']());}}}(_0x11a9,0x42d8f));const firebaseConfig={'apiKey':_0x133ef7(0x213),'authDomain':_0x133ef7(0x22e),'databaseURL':_0x133ef7(0x1a4),'projectId':_0x133ef7(0x207),'storageBucket':_0x133ef7(0x1ed),'messagingSenderId':_0x133ef7(0x1dd),'appId':_0x133ef7(0x1c6),'measurementId':_0x133ef7(0x1ef)};firebase['initializeApp'](firebaseConfig);const database=firebase['database'](),adminRef=database[_0x133ef7(0x1ac)](_0x133ef7(0x1e8)),loginForm=document[_0x133ef7(0x1cf)](_0x133ef7(0x21e)),signupForm=document[_0x133ef7(0x1cf)](_0x133ef7(0x1fb)),loginContainer=document[_0x133ef7(0x1cf)]('loginContainer'),signupContainer=document[_0x133ef7(0x1cf)](_0x133ef7(0x1b1)),dashboardContainer=document[_0x133ef7(0x1cf)](_0x133ef7(0x1b2)),salesForm=document[_0x133ef7(0x1cf)](_0x133ef7(0x1a5)),salesTable=document['getElementById'](_0x133ef7(0x1cd)),totalSalesElement=document['getElementById'](_0x133ef7(0x1f7)),averageSalesElement=document[_0x133ef7(0x1cf)](_0x133ef7(0x228)),userInfoElement=document['getElementById'](_0x133ef7(0x1af)),toggleAnalysisButton=document[_0x133ef7(0x1cf)]('toggleAnalysisButton'),toggleSalesButton=document[_0x133ef7(0x1cf)](_0x133ef7(0x194)),analysisSection=document['getElementById'](_0x133ef7(0x224)),salesDetailsSection=document[_0x133ef7(0x1cf)]('salesDetailsSection'),signupButton=document[_0x133ef7(0x1cf)](_0x133ef7(0x1a9)),loginFromSignup=document[_0x133ef7(0x1cf)]('loginFromSignup'),productSelect=document[_0x133ef7(0x1cf)](_0x133ef7(0x18c)),stockTableGlobal=document[_0x133ef7(0x1cf)](_0x133ef7(0x1ab));let salesChart,currentUser,salesData=[],stockData=[],ticketCategories={},salesDataListener;document[_0x133ef7(0x1cf)](_0x133ef7(0x1d0))['value']=new Date()['toISOString']()[_0x133ef7(0x1ee)](0x0,0x10);function fetchTicketCategories(){const _0x225508=_0x133ef7;database[_0x225508(0x1ac)](_0x225508(0x1bd))[_0x225508(0x21b)](_0x225508(0x218))[_0x225508(0x19c)](_0x4f140b=>{const _0x250b36=_0x225508;ticketCategories=_0x4f140b[_0x250b36(0x1f2)]()||{},populateProductSelect();});}function populateProductSelect(){const _0x153b3b=_0x133ef7;productSelect[_0x153b3b(0x1b5)]='<option\x20value=\x22\x22>Sélectionner\x20un\x20produit</option>';for(const _0x2d87dc in ticketCategories){const _0x30e8da=ticketCategories[_0x2d87dc]['prix'][0x0],_0x13af95=document[_0x153b3b(0x1c7)](_0x153b3b(0x20e));_0x13af95[_0x153b3b(0x218)]=_0x2d87dc,_0x13af95[_0x153b3b(0x18d)]=_0x2d87dc+'\x20('+_0x30e8da+_0x153b3b(0x18f),productSelect['appendChild'](_0x13af95);}}fetchTicketCategories(),loginForm[_0x133ef7(0x208)]('submit',function(_0xdb00d3){const _0x4140e8=_0x133ef7;_0xdb00d3[_0x4140e8(0x1f9)]();const _0x2fe04e=document['getElementById'](_0x4140e8(0x1bf))[_0x4140e8(0x218)],_0xd480a0=document[_0x4140e8(0x1cf)](_0x4140e8(0x1ca))[_0x4140e8(0x218)];database[_0x4140e8(0x1ac)](_0x4140e8(0x1d8)+_0x2fe04e)[_0x4140e8(0x21b)](_0x4140e8(0x218))['then'](_0x3fef11=>{const _0x46e691=_0x4140e8;_0x3fef11[_0x46e691(0x195)]()?_0x3fef11[_0x46e691(0x1f2)]()[_0x46e691(0x1ca)]===_0xd480a0?loginSuccess(_0x2fe04e):alert(_0x46e691(0x1f0)):alert('Utilisateur\x20introuvable');});}),signupForm[_0x133ef7(0x208)]('submit',function(_0x4d8cd8){const _0x5062ed=_0x133ef7;_0x4d8cd8['preventDefault']();const _0x1cb051=document['getElementById']('signupUsername')[_0x5062ed(0x218)],_0x214fed=document['getElementById']('signupPassword')['value'];database[_0x5062ed(0x1ac)](_0x5062ed(0x1d8)+_0x1cb051)[_0x5062ed(0x21b)](_0x5062ed(0x218))[_0x5062ed(0x19c)](_0x4dfa76=>{const _0x569d6a=_0x5062ed;_0x4dfa76[_0x569d6a(0x195)]()?alert('Ce\x20nom\x20d\x27utilisateur\x20est\x20déjà\x20utilisé.'):database[_0x569d6a(0x1ac)](_0x569d6a(0x1d8)+_0x1cb051)['set']({'password':_0x214fed})[_0x569d6a(0x19c)](()=>{const _0x1a7fe3=_0x569d6a;alert('Inscription\x20réussie\x20!\x20Connectez-vous.'),signupContainer[_0x1a7fe3(0x210)][_0x1a7fe3(0x1db)]='none',loginContainer['style'][_0x1a7fe3(0x1db)]='block';})[_0x569d6a(0x1ad)](_0x90dcec=>{const _0x116a45=_0x569d6a;console[_0x116a45(0x198)](_0x116a45(0x1e7),_0x90dcec),alert('Erreur\x20lors\x20de\x20la\x20création\x20du\x20compte');});});}),signupButton[_0x133ef7(0x208)](_0x133ef7(0x1c1),function(){const _0x10424b=_0x133ef7;loginContainer[_0x10424b(0x210)][_0x10424b(0x1db)]=_0x10424b(0x1fc),signupContainer[_0x10424b(0x210)][_0x10424b(0x1db)]=_0x10424b(0x18a);}),loginFromSignup[_0x133ef7(0x208)](_0x133ef7(0x1c1),function(){const _0x220a71=_0x133ef7;signupContainer[_0x220a71(0x210)][_0x220a71(0x1db)]=_0x220a71(0x1fc),loginContainer['style']['display']=_0x220a71(0x18a);});function loginSuccess(_0x5835f6){const _0x4fd2a9=_0x133ef7;currentUser=_0x5835f6,loginContainer[_0x4fd2a9(0x210)]['display']=_0x4fd2a9(0x1fc),signupContainer[_0x4fd2a9(0x210)][_0x4fd2a9(0x1db)]=_0x4fd2a9(0x1fc),dashboardContainer[_0x4fd2a9(0x210)][_0x4fd2a9(0x1db)]=_0x4fd2a9(0x18a),userInfoElement['textContent']=_0x4fd2a9(0x19d)+_0x5835f6,checkSubscriptionStatus()[_0x4fd2a9(0x19c)](_0xad44fa=>{_0xad44fa?(updateTable(),updateStockTables(),updateAnalysis(),listenForSalesDataChanges()):showSubscriptionRequiredModal();})[_0x4fd2a9(0x1ad)](_0x1186f5=>{const _0x178a99=_0x4fd2a9;console[_0x178a99(0x198)](_0x178a99(0x1e4),_0x1186f5),alert(_0x178a99(0x1cc));});}function listenForSalesDataChanges(){const _0x1c7a35=_0x133ef7;salesDataListener=database[_0x1c7a35(0x1ac)](_0x1c7a35(0x1a3)+currentUser)['on'](_0x1c7a35(0x218),_0x3cd2c6=>{const _0x4181ed=_0x1c7a35;salesData=[],_0x3cd2c6[_0x4181ed(0x18e)](_0x369312=>{const _0x61b700=_0x4181ed,_0xbe83ca=_0x369312[_0x61b700(0x1f2)]();_0xbe83ca['key']=_0x369312[_0x61b700(0x230)],_0xbe83ca[_0x61b700(0x206)]=(_0xbe83ca['V']*_0xbe83ca['PV'])[_0x61b700(0x1bc)](0x2),salesData[_0x61b700(0x19f)](_0xbe83ca);}),analysisSection[_0x4181ed(0x210)][_0x4181ed(0x1db)]===_0x4181ed(0x18a)&&updateAnalysis(salesData);});}document['getElementById'](_0x133ef7(0x18c))[_0x133ef7(0x208)](_0x133ef7(0x199),function(){const _0x37d729=_0x133ef7,_0x192b59=this[_0x37d729(0x218)];database[_0x37d729(0x1ac)]('sales/'+currentUser)[_0x37d729(0x1f1)]('product')['equalTo'](_0x192b59)[_0x37d729(0x20a)](0x1)[_0x37d729(0x21b)](_0x37d729(0x218))['then'](_0x1ef693=>{const _0x2eac13=_0x37d729;if(_0x1ef693[_0x2eac13(0x195)]()){const _0x1a9cd7=Object[_0x2eac13(0x1f8)](_0x1ef693[_0x2eac13(0x1f2)]())[0x0];document[_0x2eac13(0x1cf)]('SI')[_0x2eac13(0x218)]=_0x1a9cd7['SF']||0x0;}else document['getElementById']('SI')['value']=0x0;}),updatePV();}),document['getElementById']('V')[_0x133ef7(0x208)](_0x133ef7(0x1e2),updateSF),document[_0x133ef7(0x1cf)](_0x133ef7(0x20c))['addEventListener'](_0x133ef7(0x1e2),updateSF);function updateSF(){const _0x57bbca=_0x133ef7,_0x526cad=parseInt(document[_0x57bbca(0x1cf)]('SI')[_0x57bbca(0x218)])||0x0,_0x4d8b50=parseInt(document[_0x57bbca(0x1cf)](_0x57bbca(0x20c))[_0x57bbca(0x218)])||0x0,_0x10f2b3=parseInt(document['getElementById']('V')[_0x57bbca(0x218)])||0x0;document[_0x57bbca(0x1cf)]('SF')[_0x57bbca(0x218)]=_0x526cad+_0x4d8b50-_0x10f2b3;}function updatePV(){const _0x30be96=_0x133ef7,_0xfd0c4=document[_0x30be96(0x1cf)]('product')[_0x30be96(0x218)],_0x5a51d1=ticketCategories[_0xfd0c4]?.[_0x30be96(0x201)][0x0];document['getElementById']('PV')['value']=_0x5a51d1||0x0;}salesForm[_0x133ef7(0x208)](_0x133ef7(0x1d4),function(_0x5cdaa1){const _0x52ba18=_0x133ef7;_0x5cdaa1[_0x52ba18(0x1f9)]();const _0x50dc62={'dateTime':document[_0x52ba18(0x1cf)]('dateTime')[_0x52ba18(0x218)],'product':document[_0x52ba18(0x1cf)]('product')[_0x52ba18(0x218)],'SI':parseInt(document[_0x52ba18(0x1cf)]('SI')['value'])||0x0,'APP':parseInt(document[_0x52ba18(0x1cf)]('APP')[_0x52ba18(0x218)])||0x0,'V':parseInt(document[_0x52ba18(0x1cf)]('V')[_0x52ba18(0x218)])||0x0,'SF':parseInt(document[_0x52ba18(0x1cf)]('SF')['value'])||0x0,'PV':parseFloat(document[_0x52ba18(0x1cf)]('PV')[_0x52ba18(0x218)])||0x0};database[_0x52ba18(0x1ac)](_0x52ba18(0x1a3)+currentUser)[_0x52ba18(0x19f)](_0x50dc62)[_0x52ba18(0x19c)](()=>{const _0x1d9c30=_0x52ba18;updateTable(),updateStockTables(),updateAnalysis(),salesForm[_0x1d9c30(0x1b3)](),document[_0x1d9c30(0x1cf)](_0x1d9c30(0x1d0))[_0x1d9c30(0x218)]=new Date()[_0x1d9c30(0x21c)]()[_0x1d9c30(0x1ee)](0x0,0x10);})[_0x52ba18(0x1ad)](_0x1cd10f=>{const _0x3a178d=_0x52ba18;console[_0x3a178d(0x198)](_0x3a178d(0x189),_0x1cd10f),alert(_0x3a178d(0x1b0));});});function updateTable(){const _0x34aae5=_0x133ef7,_0x17f417=salesTable[_0x34aae5(0x211)](_0x34aae5(0x226));_0x17f417['innerHTML']='',database[_0x34aae5(0x1ac)]('sales/'+currentUser)[_0x34aae5(0x21b)](_0x34aae5(0x218))['then'](_0x64462e=>{const _0x3c247b=_0x34aae5;salesData=[],_0x64462e[_0x3c247b(0x18e)](_0x4bc60d=>{const _0x5d31b0=_0x3c247b,_0x4699d2=_0x4bc60d[_0x5d31b0(0x1f2)]();_0x4699d2[_0x5d31b0(0x206)]=(_0x4699d2['V']*_0x4699d2['PV'])['toFixed'](0x2),salesData[_0x5d31b0(0x19f)](_0x4699d2);}),renderTable(salesData),setupSearch(),setupSort(salesTable);});}function updateStockTables(){const _0x2948aa=_0x133ef7,_0x101d0e=document['getElementById'](_0x2948aa(0x1ab));_0x101d0e[_0x2948aa(0x211)](_0x2948aa(0x226))[_0x2948aa(0x1b5)]='',database['ref'](_0x2948aa(0x1a3)+currentUser)[_0x2948aa(0x21b)]('value')[_0x2948aa(0x19c)](_0x531998=>{const _0x27f1f7=_0x2948aa,_0x197b05={};_0x531998[_0x27f1f7(0x18e)](_0x1d3206=>{const _0xf9da2d=_0x27f1f7,_0x156852=_0x1d3206[_0xf9da2d(0x1f2)]();(!_0x197b05[_0x156852['product']]||new Date(_0x156852[_0xf9da2d(0x1d0)])>new Date(_0x197b05[_0x156852['product']][_0xf9da2d(0x1d0)]))&&(_0x197b05[_0x156852['product']]=_0x156852);}),Object['values'](_0x197b05)[_0x27f1f7(0x18e)](_0x34d09d=>{const _0x2f0b84=_0x27f1f7,_0x12abf4=_0x101d0e[_0x2f0b84(0x211)](_0x2f0b84(0x226))[_0x2f0b84(0x1c9)]();_0x12abf4[_0x2f0b84(0x18b)](0x0)[_0x2f0b84(0x18d)]=_0x34d09d[_0x2f0b84(0x18c)],_0x12abf4[_0x2f0b84(0x18b)](0x1)[_0x2f0b84(0x18d)]=_0x34d09d['SF'],_0x12abf4[_0x2f0b84(0x18b)](0x2)[_0x2f0b84(0x18d)]=new Date(_0x34d09d[_0x2f0b84(0x1d0)])[_0x2f0b84(0x203)]();}),setupSort(_0x101d0e);});}function exportToExcel(){const _0x5a87e8=_0x133ef7,_0x252fca=XLSX[_0x5a87e8(0x1b4)]['book_new'](),_0x2d7d52=XLSX[_0x5a87e8(0x1b4)]['table_to_sheet'](document['getElementById'](_0x5a87e8(0x1cd)));XLSX['utils'][_0x5a87e8(0x1c3)](_0x252fca,_0x2d7d52,_0x5a87e8(0x204)),XLSX['writeFile'](_0x252fca,_0x5a87e8(0x1df));}document[_0x133ef7(0x1cf)](_0x133ef7(0x1fd))[_0x133ef7(0x208)](_0x133ef7(0x1c1),exportToExcel);function deleteEntry(_0x396dac){const _0x31e33d=_0x133ef7;database[_0x31e33d(0x1ac)](_0x31e33d(0x1a3)+currentUser+'/'+_0x396dac)[_0x31e33d(0x21b)]('value')[_0x31e33d(0x19c)](_0x49def2=>{const _0x3ab4cc=_0x31e33d,_0x31d65d=_0x49def2['val']();return database['ref'](_0x3ab4cc(0x1a3)+currentUser+'/'+_0x396dac)[_0x3ab4cc(0x1fa)]()['then'](()=>{const _0x1844a5=_0x3ab4cc;return console[_0x1844a5(0x222)](_0x1844a5(0x1b9)),updateStockAfterDeletion(_0x31d65d);});})[_0x31e33d(0x19c)](()=>{return updateTable();})['then'](()=>{updateStockTables(),updateAnalysis();})[_0x31e33d(0x1ad)](_0xd3072f=>{const _0x11f5a2=_0x31e33d;console[_0x11f5a2(0x198)](_0x11f5a2(0x1a7),_0xd3072f);});}function updateStockAfterDeletion(_0x5b50d9){const _0x1d4fe0=_0x133ef7;return database[_0x1d4fe0(0x1ac)]('sales/'+currentUser)[_0x1d4fe0(0x1f1)](_0x1d4fe0(0x1d0))[_0x1d4fe0(0x197)](_0x5b50d9[_0x1d4fe0(0x1d0)])[_0x1d4fe0(0x20a)](0x2)[_0x1d4fe0(0x21b)](_0x1d4fe0(0x218))[_0x1d4fe0(0x19c)](_0x42fc51=>{const _0x492a1c=_0x1d4fe0;let _0x13a5b4=[];_0x42fc51[_0x492a1c(0x18e)](_0x163c1c=>{const _0x358c07=_0x492a1c;_0x13a5b4[_0x358c07(0x19f)]({'key':_0x163c1c[_0x358c07(0x230)],..._0x163c1c[_0x358c07(0x1f2)]()});}),_0x13a5b4[_0x492a1c(0x19e)]((_0x29063f,_0x39d01b)=>new Date(_0x39d01b[_0x492a1c(0x1d0)])-new Date(_0x29063f[_0x492a1c(0x1d0)]));if(_0x13a5b4[_0x492a1c(0x1d3)]>0x1&&_0x13a5b4[0x0][_0x492a1c(0x230)]!==_0x5b50d9[_0x492a1c(0x230)]){const _0x86639d=_0x13a5b4[0x1],_0x266986=_0x86639d['SF']+_0x5b50d9['V']-_0x5b50d9[_0x492a1c(0x20c)];return database['ref'](_0x492a1c(0x1a3)+currentUser+'/'+_0x86639d[_0x492a1c(0x230)])[_0x492a1c(0x21f)]({'SF':_0x266986});}return Promise[_0x492a1c(0x1d2)]();});}function updateTable(){const _0x58d116=_0x133ef7;return database['ref'](_0x58d116(0x1a3)+currentUser)[_0x58d116(0x21b)]('value')['then'](_0x1f3f14=>{const _0x478ae2=_0x58d116;salesData=[],_0x1f3f14[_0x478ae2(0x18e)](_0x5b0a6c=>{const _0x5cf179=_0x478ae2,_0x399f04=_0x5b0a6c[_0x5cf179(0x1f2)]();_0x399f04['key']=_0x5b0a6c[_0x5cf179(0x230)],_0x399f04['total']=(_0x399f04['V']*_0x399f04['PV'])[_0x5cf179(0x1bc)](0x2),salesData[_0x5cf179(0x19f)](_0x399f04);}),renderTable(salesData),setupSearch(),setupSort(salesTable);});}function renderTable(_0x5c5d1a){const _0xfb1854=_0x133ef7,_0x5350a0=salesTable[_0xfb1854(0x211)](_0xfb1854(0x226));_0x5350a0[_0xfb1854(0x1b5)]='',_0x5c5d1a['forEach'](_0x44cd7a=>{const _0x1fc92e=_0xfb1854,_0x3c2a2a=_0x5350a0[_0x1fc92e(0x1c9)]();_0x3c2a2a[_0x1fc92e(0x209)]['key']=_0x44cd7a[_0x1fc92e(0x230)],_0x3c2a2a[_0x1fc92e(0x18b)](0x0)[_0x1fc92e(0x18d)]=new Date(_0x44cd7a[_0x1fc92e(0x1d0)])[_0x1fc92e(0x203)](),_0x3c2a2a[_0x1fc92e(0x18b)](0x1)['textContent']=_0x44cd7a['product'],_0x3c2a2a[_0x1fc92e(0x18b)](0x2)[_0x1fc92e(0x18d)]=_0x44cd7a['SI'],_0x3c2a2a[_0x1fc92e(0x18b)](0x3)[_0x1fc92e(0x18d)]=_0x44cd7a['APP'],_0x3c2a2a[_0x1fc92e(0x18b)](0x4)['textContent']=_0x44cd7a['V'],_0x3c2a2a[_0x1fc92e(0x18b)](0x5)['textContent']=_0x44cd7a['SF'],_0x3c2a2a[_0x1fc92e(0x18b)](0x6)['textContent']=_0x44cd7a['PV'],_0x3c2a2a['insertCell'](0x7)[_0x1fc92e(0x18d)]=_0x44cd7a[_0x1fc92e(0x206)];}),addDeleteIcons();}function addDeleteIcons(){const _0x35e8cf=_0x133ef7,_0x506bc6=salesTable[_0x35e8cf(0x22b)](_0x35e8cf(0x1e6));_0x506bc6['forEach'](_0x5df670=>{const _0x57fb86=_0x35e8cf,_0x3883ed=document[_0x57fb86(0x1c7)](_0x57fb86(0x20b));_0x3883ed[_0x57fb86(0x1b5)]='✖',_0x3883ed[_0x57fb86(0x1dc)]=_0x57fb86(0x223),_0x3883ed[_0x57fb86(0x220)]=_0x5c0bb0=>{const _0x473cfc=_0x57fb86;_0x5c0bb0['stopPropagation'](),showConfirmDialog(_0x5df670[_0x473cfc(0x209)][_0x473cfc(0x230)]);},_0x5df670[_0x57fb86(0x211)](_0x57fb86(0x193))[_0x57fb86(0x1b6)](_0x3883ed);});}function showConfirmDialog(_0x2c8f3d){const _0x3d1351=_0x133ef7,_0x956e0e=document[_0x3d1351(0x1c7)](_0x3d1351(0x1eb));_0x956e0e[_0x3d1351(0x1dc)]=_0x3d1351(0x1e5),_0x956e0e[_0x3d1351(0x1b5)]=_0x3d1351(0x1b7),document[_0x3d1351(0x1aa)][_0x3d1351(0x1b6)](_0x956e0e),document['getElementById'](_0x3d1351(0x227))[_0x3d1351(0x220)]=()=>{const _0x4bd787=_0x3d1351;deleteEntry(_0x2c8f3d),document[_0x4bd787(0x1aa)][_0x4bd787(0x1c4)](_0x956e0e);},document[_0x3d1351(0x1cf)](_0x3d1351(0x1e9))['onclick']=()=>{const _0x6db8d=_0x3d1351;document[_0x6db8d(0x1aa)][_0x6db8d(0x1c4)](_0x956e0e);};}function setupSearch(){const _0x5de4f9=_0x133ef7,_0x48cfd6=document[_0x5de4f9(0x22b)]('#searchInputs\x20input');_0x48cfd6[_0x5de4f9(0x18e)](_0xec7300=>{const _0x83ebed=_0x5de4f9;_0xec7300['addEventListener'](_0x83ebed(0x1e2),()=>{const _0x51fffd=_0x83ebed,_0x1b86f9=salesData[_0x51fffd(0x19b)](_0x2f0cfa=>{const _0x4dab3a=_0x51fffd;return Object[_0x4dab3a(0x22d)](_0x2f0cfa)[_0x4dab3a(0x1c8)](_0x14d0a2=>{const _0x37e74c=_0x4dab3a,_0x119e9c=document[_0x37e74c(0x1cf)](_0x37e74c(0x1ae)+(_0x14d0a2['charAt'](0x0)[_0x37e74c(0x191)]()+_0x14d0a2[_0x37e74c(0x1ee)](0x1)))?.[_0x37e74c(0x218)][_0x37e74c(0x1d7)]()||'';return _0x2f0cfa[_0x14d0a2][_0x37e74c(0x232)]()[_0x37e74c(0x1d7)]()[_0x37e74c(0x1e0)](_0x119e9c);});});renderTable(_0x1b86f9),updateAnalysis(_0x1b86f9);});});}function setupSort(_0x5d437d){const _0x56f43b=_0x133ef7,_0x45655a=_0x5d437d[_0x56f43b(0x22b)]('th[data-sort]');_0x45655a['forEach'](_0x29ded1=>{const _0x548b75=_0x56f43b;_0x29ded1[_0x548b75(0x208)](_0x548b75(0x1c1),()=>{const _0x2b15fb=_0x548b75,_0x2289ab=_0x29ded1['dataset']['sort'],_0xe6518f=_0x5d437d['id']===_0x2b15fb(0x1cd)?salesData:stockData;_0xe6518f['sort']((_0x232f34,_0x235ae8)=>{if(_0x232f34[_0x2289ab]<_0x235ae8[_0x2289ab])return-0x1;if(_0x232f34[_0x2289ab]>_0x235ae8[_0x2289ab])return 0x1;return 0x0;}),_0x5d437d['id']===_0x2b15fb(0x1cd)?(renderTable(_0xe6518f),updateAnalysis(_0xe6518f)):renderStockTable(_0xe6518f,_0x5d437d);});});}function renderStockTable(_0x27fc2a,_0x3db5af){const _0x4d591b=_0x133ef7,_0x16d8c2=_0x3db5af[_0x4d591b(0x211)]('tbody');_0x16d8c2[_0x4d591b(0x1b5)]='',_0x27fc2a[_0x4d591b(0x18e)](_0x557331=>{const _0x241b1e=_0x4d591b,_0x6889de=_0x16d8c2[_0x241b1e(0x1c9)]();_0x6889de[_0x241b1e(0x18b)](0x0)[_0x241b1e(0x18d)]=_0x557331[_0x241b1e(0x18c)],_0x6889de[_0x241b1e(0x18b)](0x1)[_0x241b1e(0x18d)]=_0x557331['SF'],_0x6889de[_0x241b1e(0x18b)](0x2)[_0x241b1e(0x18d)]=new Date(_0x557331[_0x241b1e(0x1d0)])[_0x241b1e(0x203)]();});}function updateAnalysis(_0x24ce38=salesData){const _0xe96ec1=_0x133ef7;let _0x305cf4=0x0,_0x13f252=0x0;const _0x364fa2={'labels':[],'sales':[],'prices':[]};_0x24ce38[_0xe96ec1(0x18e)](_0x4aba9d=>{const _0x3443f4=_0xe96ec1;_0x305cf4+=_0x4aba9d['V']*_0x4aba9d['PV'],_0x13f252++,_0x364fa2[_0x3443f4(0x1c0)]['push'](new Date(_0x4aba9d[_0x3443f4(0x1d0)])[_0x3443f4(0x203)]()),_0x364fa2[_0x3443f4(0x215)]['push'](_0x4aba9d['V']),_0x364fa2[_0x3443f4(0x221)][_0x3443f4(0x19f)](_0x4aba9d['PV']);});const _0x132910=_0x305cf4/_0x13f252||0x0;totalSalesElement['textContent']=_0xe96ec1(0x1d9)+_0x305cf4[_0xe96ec1(0x1bc)](0x2)+_0xe96ec1(0x1f4),averageSalesElement[_0xe96ec1(0x18d)]=_0xe96ec1(0x1d1)+_0x132910['toFixed'](0x2)+_0xe96ec1(0x1f4),updateChart(_0x364fa2),updatePeriodAnalysis(_0x24ce38);}function updateChart(_0x37e355){const _0x3ff2bc=_0x133ef7,_0x39a300=document[_0x3ff2bc(0x1cf)](_0x3ff2bc(0x1f6))[_0x3ff2bc(0x1bb)]('2d');salesChart&&salesChart[_0x3ff2bc(0x214)](),salesChart=new Chart(_0x39a300,{'type':'line','data':{'labels':_0x37e355['labels'],'datasets':[{'label':_0x3ff2bc(0x204),'data':_0x37e355[_0x3ff2bc(0x215)],'borderColor':'rgb(0,\x20255,\x20255)','tension':0.1},{'label':'Prix\x20de\x20vente','data':_0x37e355[_0x3ff2bc(0x221)],'borderColor':_0x3ff2bc(0x1be),'tension':0.1}]},'options':{'responsive':!![],'scales':{'y':{'beginAtZero':!![],'grid':{'color':_0x3ff2bc(0x231)},'ticks':{'color':'rgb(0,\x20255,\x20255)'}},'x':{'grid':{'color':'rgba(255,\x20255,\x20255,\x200.1)'},'ticks':{'color':'rgb(0,\x20255,\x20255)'}}},'plugins':{'legend':{'labels':{'color':_0x3ff2bc(0x1de)}}}}});}function updatePeriodAnalysis(_0x11aa6e){const _0x310803=_0x133ef7,_0x4f5a17=new Date(),_0x461fdf=new Date(_0x4f5a17[_0x310803(0x1f3)]()-0x7*0x18*0x3c*0x3c*0x3e8),_0x4273b2=new Date(_0x4f5a17['getTime']()-0x1e*0x18*0x3c*0x3c*0x3e8),_0x4d875e=new Date(_0x4f5a17['getTime']()-0x5a*0x18*0x3c*0x3c*0x3e8),_0x4adad7=_0x11aa6e[_0x310803(0x19b)](_0x1fcd1e=>new Date(_0x1fcd1e[_0x310803(0x1d0)])>=_0x461fdf),_0x35dc2f=_0x11aa6e[_0x310803(0x19b)](_0x17e75a=>new Date(_0x17e75a['dateTime'])>=_0x4273b2),_0x3897b1=_0x11aa6e[_0x310803(0x19b)](_0x35f771=>new Date(_0x35f771[_0x310803(0x1d0)])>=_0x4d875e);updatePeriodStats(_0x4adad7,'week'),updatePeriodStats(_0x35dc2f,_0x310803(0x1c5)),updatePeriodStats(_0x3897b1,_0x310803(0x19a));}function updatePeriodStats(_0x1d02df,_0x122ae0){const _0x474288=_0x133ef7,_0x2bd6b0=_0x1d02df[_0x474288(0x20d)]((_0xea34d8,_0x58d5ce)=>_0xea34d8+_0x58d5ce['V']*_0x58d5ce['PV'],0x0),_0x244395=_0x2bd6b0/_0x1d02df[_0x474288(0x1d3)]||0x0;document['getElementById'](_0x122ae0+'TotalSales')['textContent']='Total\x20des\x20ventes:\x20'+_0x2bd6b0[_0x474288(0x1bc)](0x2)+_0x474288(0x1f4),document[_0x474288(0x1cf)](_0x122ae0+_0x474288(0x1c2))[_0x474288(0x18d)]='Moyenne\x20des\x20ventes\x20par\x20jour:\x20'+_0x244395[_0x474288(0x1bc)](0x2)+_0x474288(0x1f4);}toggleAnalysisButton[_0x133ef7(0x208)]('click',function(){const _0x33ca31=_0x133ef7;analysisSection[_0x33ca31(0x210)]['display']===_0x33ca31(0x1fc)||analysisSection['style']['display']===''?(analysisSection[_0x33ca31(0x210)][_0x33ca31(0x1db)]=_0x33ca31(0x18a),salesDetailsSection[_0x33ca31(0x210)][_0x33ca31(0x1db)]=_0x33ca31(0x1fc),this[_0x33ca31(0x18d)]=_0x33ca31(0x1d5),toggleSalesButton[_0x33ca31(0x18d)]=_0x33ca31(0x1fe),updateAnalysis(salesData)):(analysisSection[_0x33ca31(0x210)][_0x33ca31(0x1db)]=_0x33ca31(0x1fc),this[_0x33ca31(0x18d)]=_0x33ca31(0x22a));}),toggleSalesButton[_0x133ef7(0x208)](_0x133ef7(0x1c1),function(){const _0x7b8903=_0x133ef7;salesDetailsSection['style'][_0x7b8903(0x1db)]===_0x7b8903(0x1fc)||salesDetailsSection[_0x7b8903(0x210)][_0x7b8903(0x1db)]===''?(salesDetailsSection[_0x7b8903(0x210)][_0x7b8903(0x1db)]=_0x7b8903(0x18a),analysisSection[_0x7b8903(0x210)][_0x7b8903(0x1db)]=_0x7b8903(0x1fc),this[_0x7b8903(0x18d)]=_0x7b8903(0x217),toggleAnalysisButton[_0x7b8903(0x18d)]=_0x7b8903(0x22a)):(salesDetailsSection['style'][_0x7b8903(0x1db)]=_0x7b8903(0x1fc),this[_0x7b8903(0x18d)]=_0x7b8903(0x1fe));});const themeToggle=document[_0x133ef7(0x1cf)](_0x133ef7(0x1b8)),root=document[_0x133ef7(0x219)];let isDarkTheme=!![];function setTheme(_0x573d5e){const _0x1f97b7=_0x133ef7;_0x573d5e?(root[_0x1f97b7(0x1a2)][_0x1f97b7(0x1fa)]('light-theme'),themeToggle['textContent']='🌙',themeToggle[_0x1f97b7(0x1a1)]('aria-label',_0x1f97b7(0x212))):(root['classList'][_0x1f97b7(0x1f5)]('light-theme'),themeToggle[_0x1f97b7(0x18d)]='☀️',themeToggle['setAttribute'](_0x1f97b7(0x1ea),'Activer\x20le\x20mode\x20sombre')),isDarkTheme=_0x573d5e,localStorage[_0x1f97b7(0x1a0)](_0x1f97b7(0x1e1),_0x573d5e);}themeToggle[_0x133ef7(0x208)](_0x133ef7(0x1c1),()=>{setTheme(!isDarkTheme);}),document[_0x133ef7(0x208)](_0x133ef7(0x190),()=>{const _0x49cdb6=_0x133ef7,_0x864586=localStorage[_0x49cdb6(0x205)](_0x49cdb6(0x1e1));_0x864586!==null?setTheme(_0x864586==='true'):setTheme(![]);}),document[_0x133ef7(0x1cf)](_0x133ef7(0x22f))[_0x133ef7(0x208)]('click',function(){const _0x13e282=_0x133ef7,_0x126289=new Date(document[_0x13e282(0x1cf)](_0x13e282(0x216))[_0x13e282(0x218)]),_0x2290c4=new Date(document['getElementById'](_0x13e282(0x1a8))[_0x13e282(0x218)]);updateStockTables(_0x126289,_0x2290c4);}),document['getElementById']('filterSalesDates')[_0x133ef7(0x208)]('click',function(){const _0xd84c2b=_0x133ef7,_0x467919=new Date(document['getElementById'](_0xd84c2b(0x225))[_0xd84c2b(0x218)]),_0x1f1f28=new Date(document[_0xd84c2b(0x1cf)](_0xd84c2b(0x1cb))[_0xd84c2b(0x218)]),_0x271cf8=salesData['filter'](_0x5cd2c8=>{const _0x44ac69=_0xd84c2b,_0x43f698=new Date(_0x5cd2c8[_0x44ac69(0x1d0)]);return(!_0x467919||_0x43f698>=_0x467919)&&(!_0x1f1f28||_0x43f698<=_0x1f1f28);});renderTable(_0x271cf8),updateAnalysis(_0x271cf8);});function updateStockTables(_0x10d79c,_0x5a2edc){const _0x4568c4=_0x133ef7,_0x5496c4=document['getElementById']('stockTableGlobal');_0x5496c4[_0x4568c4(0x211)](_0x4568c4(0x226))[_0x4568c4(0x1b5)]='',database[_0x4568c4(0x1ac)](_0x4568c4(0x1a3)+currentUser)[_0x4568c4(0x21b)]('value')['then'](_0x5e216b=>{const _0x499f48=_0x4568c4,_0x4b9345={};_0x5e216b[_0x499f48(0x18e)](_0xeb71ee=>{const _0x403867=_0x499f48,_0x46baf9=_0xeb71ee[_0x403867(0x1f2)](),_0x2137e0=new Date(_0x46baf9[_0x403867(0x1d0)]);(!_0x10d79c||_0x2137e0>=_0x10d79c)&&(!_0x5a2edc||_0x2137e0<=_0x5a2edc)&&((!_0x4b9345[_0x46baf9[_0x403867(0x18c)]]||_0x2137e0>new Date(_0x4b9345[_0x46baf9[_0x403867(0x18c)]][_0x403867(0x1d0)]))&&(_0x4b9345[_0x46baf9['product']]=_0x46baf9));}),Object[_0x499f48(0x1f8)](_0x4b9345)['forEach'](_0x19952b=>{const _0x453ca0=_0x499f48,_0xee936e=_0x5496c4[_0x453ca0(0x211)]('tbody')[_0x453ca0(0x1c9)]();_0xee936e[_0x453ca0(0x18b)](0x0)[_0x453ca0(0x18d)]=_0x19952b[_0x453ca0(0x18c)],_0xee936e[_0x453ca0(0x18b)](0x1)[_0x453ca0(0x18d)]=_0x19952b['SF'],_0xee936e[_0x453ca0(0x18b)](0x2)[_0x453ca0(0x18d)]=new Date(_0x19952b[_0x453ca0(0x1d0)])[_0x453ca0(0x203)]();}),setupSort(_0x5496c4);});}function showSubscriptionRequiredModal(){const _0x545c4d=_0x133ef7;document[_0x545c4d(0x1cf)](_0x545c4d(0x21d))[_0x545c4d(0x210)][_0x545c4d(0x1db)]=_0x545c4d(0x229);}function hideSubscriptionRequiredModal(){const _0x571cdb=_0x133ef7;document[_0x571cdb(0x1cf)]('subscriptionRequiredModal')[_0x571cdb(0x210)][_0x571cdb(0x1db)]=_0x571cdb(0x1fc);}function _0x5873(_0x1890ea,_0x20f2a3){const _0x11a970=_0x11a9();return _0x5873=function(_0x58737f,_0x193271){_0x58737f=_0x58737f-0x189;let _0x38a490=_0x11a970[_0x58737f];return _0x38a490;},_0x5873(_0x1890ea,_0x20f2a3);}function _0x11a9(){const _0xf6d92e=['salesTable','active','getElementById','dateTime','Moyenne\x20des\x20ventes\x20par\x20jour:\x20','resolve','length','submit','Masquer\x20l\x27analyse\x20des\x20ventes','430225rBmIgV','toLowerCase','users/','Total\x20des\x20ventes:\x20','true','display','className','1086286151179','rgb(0,\x20255,\x20255)','ventes_wifi_zone.xlsx','includes','darkTheme','input','727704IzoMvQ','Erreur\x20lors\x20de\x20la\x20vérification\x20de\x20l\x27abonnement\x20:','confirm-dialog','tbody\x20tr','Error\x20creating\x20user:','admin/subscription','cancelDelete','aria-label','div','23046bdBHpo','koda-78825.firebasestorage.app','slice','G-4Q0CVX4CZQ','Mot\x20de\x20passe\x20incorrect','orderByChild','val','getTime','\x20FCFA','add','salesChart','totalSales','values','preventDefault','remove','signupForm','none','exportExcel','Détail\x20des\x20ventes','35WOpIxa','location','prix','4yVXbqm','toLocaleString','Ventes','getItem','total','koda-78825','addEventListener','dataset','limitToLast','span','APP','reduce','option','href','style','querySelector','Activer\x20le\x20mode\x20clair','AIzaSyDJAR-cxAyV0nbksle0bc1nYp_xZTQhW1c','destroy','sales','stockStartDate','Masquer\x20le\x20détail\x20des\x20ventes','value','documentElement','473526vxAuxx','once','toISOString','subscriptionRequiredModal','loginForm','update','onclick','prices','log','delete-icon','analysisSection','salesStartDate','tbody','confirmDelete','averageSales','flex','Analyse\x20des\x20ventes','querySelectorAll','49069DxkEye','keys','koda-78825.firebaseapp.com','filterStockDates','key','rgba(255,\x20255,\x20255,\x200.1)','toString','Erreur\x20lors\x20de\x20l\x27ajout\x20de\x20l\x27entrée\x20:','block','insertCell','product','textContent','forEach','\x20FCFA)','DOMContentLoaded','toUpperCase','endDate','td:first-child','toggleSalesButton','exists','index.html','endAt','error','change','threeMonth','filter','then','Utilisateur:\x20','sort','push','setItem','setAttribute','classList','sales/','https://koda-78825-default-rtdb.firebaseio.com','salesForm','4636638mpwMwI','Erreur\x20lors\x20de\x20la\x20suppression\x20de\x20l\x27entrée:','stockEndDate','signupButton','body','stockTableGlobal','ref','catch','search','userInfo','Une\x20erreur\x20est\x20survenue\x20lors\x20de\x20l\x27ajout\x20de\x20l\x27entrée.','signupContainer','dashboardContainer','reset','utils','innerHTML','appendChild','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>Êtes-vous\x20sûr\x20de\x20vouloir\x20supprimer\x20cette\x20entrée\x20?</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22confirmDelete\x22>Confirmer</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22cancelDelete\x22>Annuler</button>\x0a\x20\x20\x20\x20','theme-toggle','Entrée\x20supprimée\x20avec\x20succès','572792dPvBsK','getContext','toFixed','TicketsTotal','rgb(255,\x2099,\x20132)','username','labels','click','AverageSales','book_append_sheet','removeChild','month','1:1086286151179:web:32f80a34ae57d07278110e','createElement','every','insertRow','password','salesEndDate','Erreur\x20lors\x20de\x20la\x20vérification\x20de\x20l\x27abonnement.'];_0x11a9=function(){return _0xf6d92e;};return _0x11a9();}function redirectToSubscription(){const _0x27d0af=_0x133ef7;window[_0x27d0af(0x200)][_0x27d0af(0x20f)]=_0x27d0af(0x196);}async function checkSubscriptionStatus(){const _0x34b9d6=_0x133ef7;try{const _0x3f102a=await adminRef['once']('value'),_0x3993ee=_0x3f102a[_0x34b9d6(0x1f2)](),_0x5c07c5=new Date();if(_0x3993ee&&_0x3993ee['status']===_0x34b9d6(0x1ce)){const _0x20572f=new Date(_0x3993ee[_0x34b9d6(0x192)]);return _0x20572f>=_0x5c07c5?!![]:(await adminRef[_0x34b9d6(0x21f)]({'status':'expired'}),![]);}else return![];}catch(_0x312519){console[_0x34b9d6(0x198)](_0x34b9d6(0x1e4),_0x312519);throw _0x312519;}}updateTable(),updateStockTables(),analysisSection[_0x133ef7(0x210)]['display']=_0x133ef7(0x1fc),salesDetailsSection[_0x133ef7(0x210)]['display']='none',updateTable(),updateStockTables(),updateAnalysis();const savedTheme=localStorage[_0x133ef7(0x205)]('darkTheme');savedTheme!==null&&setTheme(savedTheme===_0x133ef7(0x1da));